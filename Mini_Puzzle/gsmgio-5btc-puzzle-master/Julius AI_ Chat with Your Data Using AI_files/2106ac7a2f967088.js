;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5f615c55-5d43-abee-a331-67cf1e80f44e")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,413269,654102,167877,982551,e=>{"use strict";var t=e.i(843476),s=e.i(271645),l=e.i(52563),a=e.i(88653),r=e.i(824511),n=e.i(595468),i=e.i(778917),o=e.i(531278),d=e.i(37727),c=e.i(373884),u=e.i(471512),m=e.i(167881),x=e.i(728231),h=e.i(647163),p=e.i(846696),f=e.i(768834),g=e.i(394073);let j={socket:null,subteamId:void 0,isConnected:!1,isConnecting:!1,firstConnection:!0,getAccessTokenSilently:void 0,activeBenchmark:null},w=(0,f.create)((t,s)=>({...j,reset:()=>{s().disconnect(),t(j)},connect:async(l,a)=>{let{socket:r,subteamId:n}=s();if(t({getAccessTokenSilently:l}),r?.connected&&n===a)return;r&&(r.disconnect(),t({socket:null,isConnected:!1}));let i=await e.A(622025).then(e=>e.io);t({isConnected:!1,isConnecting:!0});let o=await l(),d=i(`${g.SOCKET_URL}/evals`,{path:"/ws",transports:["websocket","polling"],auth:{token:o,subteam_id:a},reconnectionDelay:500,reconnectionAttempts:1/0});t({socket:d,subteamId:a}),d.on("connect",()=>{d.emit("join",{subteam_id:a}),t({isConnected:!0,isConnecting:!1,firstConnection:!1})}),d.on("connect_error",async e=>{let l=e.data?.code,r=e.data?.description??e.message??"";if(401===l||r.toLowerCase().includes("token is expired"))try{let{getAccessTokenSilently:e}=s();if(e){let t=await e();d.auth={...d.auth,token:t,subteam_id:a},d.disconnected&&d.connect();return}}catch(e){console.warn("[evals] failed to refresh token on connect_error:",e)}t({isConnected:!1,isConnecting:!1,firstConnection:403===l})}),d.on("reconnect",()=>{t({isConnected:!0,isConnecting:!1})}),d.on("reconnect_attempt",async()=>{let{socket:e,getAccessTokenSilently:l}=s();e&&l&&(e.auth.token=await l()),t({isConnected:!1,isConnecting:!0})}),d.on("reconnect_failed",e=>{console.warn("[evals] reconnect failed:",e),t({isConnected:!1,isConnecting:!1})}),d.on("disconnect",()=>{t({isConnected:!1})}),d.on("error",e=>{let t=e?.title||"Unexpected error",s=e?.message||JSON.stringify(e);p.toast.error(t,{description:s})}),d.on("benchmark_started",e=>{t({activeBenchmark:{runId:e.run_id,name:e.name,totalCells:e.total_cells,completedCells:0,failedCells:0,results:[]}})}),d.on("eval_result",e=>{let{activeBenchmark:l}=s();if(l&&l.runId===e.run_id){let s=e.total_cells>0&&e.completed_cells>=e.total_cells;t({activeBenchmark:{...l,totalCells:e.total_cells,completedCells:e.completed_cells,failedCells:e.failed_cells,results:[...l.results,e],isComplete:s}})}}),d.on("benchmark_complete",e=>{let{activeBenchmark:l}=s();l&&l.runId===e.run_id&&t({activeBenchmark:{...l,isComplete:!0}})}),d.on("benchmark_cancelled",e=>{t({activeBenchmark:null})})},disconnect:()=>{let{socket:e}=s();if(e){let l=s().subteamId;try{e.emit("leave",{subteam_id:l})}catch{}e.disconnect(),t({socket:null,isConnected:!1})}},on:(e,t)=>{let{socket:l}=s();return l&&(l.off(e,t),l.on(e,t)),()=>{let{socket:l}=s();l&&l.off(e,t)}},clearActiveBenchmark:()=>{t({activeBenchmark:null})}})),b=({benchmark:e,isConnected:l,onDismiss:u})=>{let{totalCells:p,completedCells:f,failedCells:g,results:j,name:w,isComplete:b}=e,v=f-g,N=p>0?v/p*100:0,y=(0,s.useMemo)(()=>{let e=[],t=[];j.forEach((s,l)=>{s.success?e.push({status:"success",index:l}):t.push({status:"failed",index:l})});let s=[];for(let e=j.length;e<p;e++)s.push({status:"pending",index:e});return[...e,...t,...s]},[j,p]);return(0,t.jsxs)("div",{className:"bg-card border border-border rounded-lg p-4 relative",children:[(0,t.jsx)(m.Button,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 size-6",onClick:u,children:(0,t.jsx)(d.X,{className:"size-4"})}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,t.jsxs)("svg",{width:144,height:144,className:"transform -rotate-90",children:[(0,t.jsx)("circle",{cx:72,cy:72,r:60,fill:"none",stroke:"hsl(var(--muted))",strokeWidth:12}),y.map((e,s)=>{let l=360/p,a=s*l,n=a+l-2,i=a*Math.PI/180,o=n*Math.PI/180,d=72+60*Math.cos(i),c=72+60*Math.sin(i),u=72+60*Math.cos(o),m=72+60*Math.sin(o),x=`M ${d} ${c} A 60 60 0 ${+(n-a>180)} 1 ${u} ${m}`,h="hsl(var(--muted))";return"success"===e.status&&(h="#22c55e"),"failed"===e.status&&(h="hsl(var(--destructive))"),(0,t.jsx)(r.m.path,{d:x,fill:"none",stroke:h,strokeWidth:12,initial:{opacity:0},animate:{opacity:1},transition:{delay:.02*s}},s)})]}),(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,t.jsxs)("span",{className:"text-2xl font-bold tabular-nums",children:[Math.round(N),"%"]}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[v,"/",p]})]})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold truncate",children:w}),b?(0,t.jsx)("span",{className:"text-xs text-green-500 font-medium",children:"Complete"}):!l&&(0,t.jsx)(o.Loader2,{className:"size-3 animate-spin text-muted-foreground"})]}),(0,t.jsxs)("div",{className:"flex gap-6 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"size-2 rounded-full bg-muted"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"Pending"}),(0,t.jsx)("span",{className:"font-medium",children:p-f})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(n.CheckCircle2,{className:"size-3.5 text-green-500"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"Passed"}),(0,t.jsx)("span",{className:"font-medium",children:v})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(c.XCircle,{className:"size-3.5 text-destructive"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"Failed"}),(0,t.jsx)("span",{className:"font-medium",children:g})]})]}),j.length>0&&(0,t.jsx)("div",{className:"mt-3 pt-3 border-t border-border",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"text-muted-foreground shrink-0",children:"Latest:"}),(0,t.jsxs)("div",{className:"relative max-w-[400px] overflow-hidden",children:[j.length>3&&(0,t.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-16 pointer-events-none z-10",style:{background:"linear-gradient(to left, hsl(var(--card)) 0%, transparent 100%)"}}),(0,t.jsx)("div",{className:"flex gap-2 overflow-x-scroll pb-1",style:{scrollbarWidth:"none"},children:(0,t.jsx)(a.AnimatePresence,{mode:"popLayout",children:[...j].reverse().map(e=>(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(r.m.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:(0,h.cn)("px-2 py-0.5 rounded-full truncate max-w-[120px] cursor-default shrink-0",e.success?"bg-green-500/10 text-green-500":"bg-destructive/10 text-destructive"),children:e.eval_name})}),(0,t.jsxs)(x.TooltipContent,{side:"bottom",className:"max-w-[300px]",children:[(0,t.jsx)("p",{className:"font-medium",children:e.eval_name}),(0,t.jsxs)("a",{href:`/notebooks/${e.workflow_id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between gap-2 text-xs text-muted-foreground hover:text-foreground mt-1",children:[(0,t.jsx)("span",{children:e.workflow_name}),(0,t.jsx)(i.ExternalLink,{className:"size-3 shrink-0"})]})]})]},e.result_id))})})]})]})})]})]})]})};e.s(["default",0,({groupId:e})=>{let{getAccessTokenSilently:n}=(0,l.useAuth0)(),{connect:i,disconnect:o,isConnected:d,activeBenchmark:c,clearActiveBenchmark:m}=w(),x=(0,u.useCancelBenchmarkRun)();(0,s.useEffect)(()=>(e&&i(n,e),()=>{o()}),[e,i,o,n]);let h=(0,s.useCallback)(()=>{c&&!c.isComplete&&x.mutate({runId:c.runId,groupId:e}),m()},[c,x,e,m]);return c?(0,t.jsx)(a.AnimatePresence,{children:(0,t.jsx)(r.m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"w-full mb-4",children:(0,t.jsx)(b,{benchmark:c,isConnected:d,onDismiss:h})})}):null}],413269);var v=e.i(664659),N=e.i(463059);let y=(0,e.i(475254).default)("git-compare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);var k=e.i(522016),C=e.i(618566),_=e.i(625959),T=e.i(947627);let z=({benchmark:e,compareMode:l,isSelected:a,onToggleSelect:r})=>{let[n,i]=(0,s.useState)(!1),{data:o}=(0,u.useBenchmarkRun)({runId:e.id,enabled:n}),d=e.completed_cells-e.failed_cells,c=e.total_cells>0?Math.round(d/e.total_cells*100):0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(T.TableRow,{className:(0,h.cn)("cursor-pointer hover:bg-muted/50",a&&"bg-primary/10 hover:bg-primary/15"),onClick:()=>{l?r?.():i(!n)},children:[l&&(0,t.jsx)(T.TableCell,{className:"p-2",children:(0,t.jsx)(_.Checkbox,{checked:a,onCheckedChange:()=>r?.(),onClick:e=>e.stopPropagation()})}),(0,t.jsx)(T.TableCell,{className:"p-2",children:!l&&(0,t.jsx)(m.Button,{variant:"ghost",size:"icon",className:"size-6",children:n?(0,t.jsx)(v.ChevronDown,{className:"size-4"}):(0,t.jsx)(N.ChevronRight,{className:"size-4"})})}),(0,t.jsx)(T.TableCell,{className:"font-medium",children:e.name}),(0,t.jsx)(T.TableCell,{className:"text-right",children:(0,t.jsxs)("span",{className:(0,h.cn)("font-semibold",c>=80?"text-green-500":c>=50?"text-yellow-500":"text-destructive"),children:[c,"%"]})}),(0,t.jsx)(T.TableCell,{className:"text-right text-green-500",children:d}),(0,t.jsx)(T.TableCell,{className:"text-right text-destructive",children:e.failed_cells}),(0,t.jsx)(T.TableCell,{className:"text-right text-muted-foreground",children:e.total_cells}),(0,t.jsx)(T.TableCell,{className:"text-right text-muted-foreground text-sm",children:new Date(e.created_at).toLocaleDateString()})]}),!l&&n&&o&&(0,t.jsx)(T.TableRow,{children:(0,t.jsx)(T.TableCell,{colSpan:7,className:"p-0 bg-muted/30",children:(0,t.jsx)(S,{results:o.results})})})]})},M=({benchmarkA:e,benchmarkB:s,onClose:l})=>{let{data:a}=(0,u.useBenchmarkRun)({runId:e.id,enabled:!0}),{data:r}=(0,u.useBenchmarkRun)({runId:s.id,enabled:!0}),n=e.completed_cells-e.failed_cells,i=s.completed_cells-s.failed_cells,o=e.total_cells>0?Math.round(n/e.total_cells*100):0,c=s.total_cells>0?Math.round(i/s.total_cells*100):0;return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y,{className:"size-5 text-muted-foreground"}),(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Comparison"})]}),(0,t.jsx)(m.Button,{variant:"ghost",size:"icon",onClick:l,children:(0,t.jsx)(d.X,{className:"size-4"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"border border-border rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"p-3 bg-muted/30 border-b border-border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Baseline (A)"}),(0,t.jsx)("div",{className:"font-medium truncate",children:e.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsxs)("span",{className:(0,h.cn)("font-semibold",o>=80?"text-green-500":o>=50?"text-yellow-500":"text-destructive"),children:[o,"%"]}),(0,t.jsxs)("span",{className:"text-green-500",children:[n," ✓"]}),(0,t.jsxs)("span",{className:"text-destructive",children:[e.failed_cells," ✗"]})]})]})}),(0,t.jsx)("div",{className:"max-h-[600px] overflow-y-auto",children:a?.results?(0,t.jsx)(S,{results:a.results}):(0,t.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading..."})})]}),(0,t.jsxs)("div",{className:"border border-border rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"p-3 bg-muted/30 border-b border-border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Compare (B)"}),(0,t.jsx)("div",{className:"font-medium truncate",children:s.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsxs)("span",{className:(0,h.cn)("font-semibold",c>=80?"text-green-500":c>=50?"text-yellow-500":"text-destructive"),children:[c,"%"]}),(0,t.jsxs)("span",{className:"text-green-500",children:[i," ✓"]}),(0,t.jsxs)("span",{className:"text-destructive",children:[s.failed_cells," ✗"]})]})]})}),(0,t.jsx)("div",{className:"max-h-[600px] overflow-y-auto",children:r?.results?(0,t.jsx)(S,{results:r.results}):(0,t.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading..."})})]})]})]})},S=({results:e})=>{let l=(0,s.useMemo)(()=>{let t=new Map;e.forEach(e=>{let s=e.eval_name;t.has(s)||t.set(s,{results:[],successRate:0}),t.get(s)?.results.push(e)}),t.forEach(e=>{let t=e.results.filter(e=>e.success).length;e.successRate=e.results.length>0?t/e.results.length:0});let s=new Map;return e.forEach(e=>{let t=e.parent_id||"unknown",l=e.eval_metadata?.template_name||"Unknown Template";s.has(t)||s.set(t,{templateId:t,templateName:l,evals:new Map});let a=s.get(t);if(!a)return;let r=e.eval_name;a.evals.has(r)||a.evals.set(r,{results:[],successRate:0}),a.evals.get(r)?.results.push(e)}),s.forEach(e=>{e.evals.forEach(e=>{let t=e.results.filter(e=>e.success).length;e.successRate=e.results.length>0?t/e.results.length:0})}),{byEvalName:t,byTemplate:s}},[e]),a=(0,s.useMemo)(()=>{let e=[];return l.byEvalName.forEach((t,s)=>{t.successRate<.5&&t.results.length>1&&e.push(s)}),new Set(e)},[l]);return 0===e.length?(0,t.jsx)("div",{className:"p-4 text-sm text-muted-foreground",children:"No results yet"}):(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[a.size>0&&(0,t.jsxs)("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-destructive mb-2",children:["Consistently Failing Evals (",a.size,")"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(a).map(e=>{let s=l.byEvalName.get(e);if(!s)return null;let a=Math.round(100*s.successRate);return(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("div",{className:"px-2 py-1 bg-destructive/20 text-destructive rounded text-xs font-medium cursor-default",children:[e.length>30?`${e.slice(0,30)}...`:e,(0,t.jsxs)("span",{className:"ml-1 opacity-70",children:["(",a,"%)"]})]})}),(0,t.jsxs)(x.TooltipContent,{children:[(0,t.jsx)("p",{className:"font-medium",children:e}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.results.filter(e=>e.success).length,"/",s.results.length," passed (",a,"%)"]})]})]},e)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium mb-2",children:"Eval Success Rates"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:Array.from(l.byEvalName.entries()).sort((e,t)=>e[1].successRate-t[1].successRate).map(([e,s])=>{let l=Math.round(100*s.successRate),r=a.has(e);return(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("div",{className:(0,h.cn)("p-2 rounded border text-xs cursor-default",r?"border-destructive/30 bg-destructive/5":"border-border bg-card"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,t.jsx)("span",{className:"truncate font-medium",children:e}),(0,t.jsxs)("span",{className:(0,h.cn)("shrink-0 font-semibold",l>=80?"text-green-500":l>=50?"text-yellow-500":"text-destructive"),children:[l,"%"]})]}),(0,t.jsx)("div",{className:"h-1.5 bg-muted rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:(0,h.cn)("h-full rounded-full transition-all",l>=80?"bg-green-500":l>=50?"bg-yellow-500":"bg-destructive"),style:{width:`${l}%`}})}),(0,t.jsxs)("div",{className:"text-[10px] text-muted-foreground mt-1",children:[s.results.filter(e=>e.success).length,"/",s.results.length," runs"]})]})}),(0,t.jsxs)(x.TooltipContent,{className:"max-w-xs",children:[(0,t.jsx)("p",{className:"font-medium",children:e}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Passed ",s.results.filter(e=>e.success).length," of"," ",s.results.length," runs"]})]})]},e)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm font-medium mb-2",children:["Results by Template (",l.byTemplate.size," templates)"]}),(0,t.jsx)("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:Array.from(l.byTemplate.entries()).map(([e,s])=>{let l=Array.from(s.evals.values()).flatMap(e=>e.results),a=l.filter(e=>e.success).length,r=l.length;return(0,t.jsxs)("div",{className:"border border-border rounded-lg overflow-hidden",children:[(0,t.jsxs)(k.default,{href:`/notebooks/${e}`,target:"_blank",className:"flex items-center justify-between p-3 bg-muted/30 hover:bg-muted/50 transition-colors",children:[(0,t.jsx)("span",{className:"font-medium text-sm truncate",children:s.templateName}),(0,t.jsxs)("span",{className:(0,h.cn)("text-xs font-medium",a===r?"text-green-500":0===a?"text-destructive":"text-yellow-500"),children:[a,"/",r," passed"]})]}),(0,t.jsx)("div",{className:"divide-y divide-border",children:Array.from(s.evals.entries()).sort((e,t)=>e[1].successRate-t[1].successRate).map(([s,l])=>{let a=l.results.filter(e=>e.success).length,r=l.results.length,n=[...l.results].sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime());return(0,t.jsxs)("div",{className:"flex items-center gap-3 px-3 py-2 text-sm hover:bg-muted/20",children:[(0,t.jsx)("div",{className:"flex-1 min-w-0 pl-2 border-l-2 border-muted-foreground/20",children:(0,t.jsx)("span",{className:"truncate block text-muted-foreground",children:s})}),(0,t.jsx)("div",{className:"flex items-center gap-1.5 shrink-0",children:n.map((e,s)=>(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(k.default,{href:`/notebooks/${e.workflow_id}`,target:"_blank",onClick:e=>e.stopPropagation(),className:(0,h.cn)("size-3 rounded-full transition-transform hover:scale-125",e.success?"bg-green-500":"bg-destructive")})}),(0,t.jsxs)(x.TooltipContent,{children:[(0,t.jsxs)("p",{className:"font-medium",children:["Run #",s+1]}),(0,t.jsx)("p",{className:(0,h.cn)("text-xs",e.success?"text-green-500":"text-destructive"),children:e.success?"Passed":"Failed"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Click to open notebook"})]})]},e.id))}),(0,t.jsxs)("span",{className:(0,h.cn)("text-xs font-medium tabular-nums w-8 text-right",a===r?"text-green-500":0===a?"text-destructive":"text-yellow-500"),children:[a,"/",r]})]},`${e}-${s}`)})})]},e)})})]})]})};e.s(["default",0,()=>{let{groupId:e}=(0,C.useParams)(),{data:l=[],isLoading:a}=(0,u.useGroupBenchmarks)({groupId:e}),[r,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)([]),d=()=>{n(!1),o([])};if(a)return(0,t.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading benchmarks..."});if(0===l.length)return(0,t.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:'No benchmark runs yet. Use "Run All" to create one.'});if(r&&2===i.length){let e=l.find(e=>e.id===i[0]),s=l.find(e=>e.id===i[1]);if(e&&s)return(0,t.jsx)(M,{benchmarkA:e,benchmarkB:s,onClose:d})}return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:r&&(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Select 2 benchmarks to compare (",i.length,"/2)"]})}),(0,t.jsxs)(m.Button,{variant:r?"secondary":"outline",size:"sm",onClick:()=>r?d():n(!0),children:[(0,t.jsx)(y,{className:"size-4 mr-2"}),r?"Cancel":"Compare"]})]}),(0,t.jsxs)(T.Table,{children:[(0,t.jsx)(T.TableHeader,{children:(0,t.jsxs)(T.TableRow,{children:[r&&(0,t.jsx)(T.TableHead,{className:"w-10"}),(0,t.jsx)(T.TableHead,{className:"w-8"}),(0,t.jsx)(T.TableHead,{children:"Name"}),(0,t.jsx)(T.TableHead,{className:"text-right w-24",children:"Score"}),(0,t.jsx)(T.TableHead,{className:"text-right w-24",children:"Passed"}),(0,t.jsx)(T.TableHead,{className:"text-right w-24",children:"Failed"}),(0,t.jsx)(T.TableHead,{className:"text-right w-24",children:"Total"}),(0,t.jsx)(T.TableHead,{className:"text-right w-32",children:"Date"})]})}),(0,t.jsx)(T.TableBody,{children:l.map(e=>(0,t.jsx)(z,{benchmark:e,compareMode:r,isSelected:i.includes(e.id),onToggleSelect:()=>{var t;return t=e.id,void o(e=>e.includes(t)?e.filter(e=>e!==t):e.length>=2?[e[1],t]:[...e,t])}},e.id))})]})]})}],654102);var R=e.i(431343),D=e.i(107233),I=e.i(604570),P=e.i(268580),B=e.i(463415),A=e.i(23750),E=e.i(616525);e.s(["default",0,()=>{let e=(0,C.useSearchParams)(),l=(0,C.useRouter)(),a=(0,C.usePathname)(),{teamId:n,groupId:i}=(0,C.useParams)(),{getWorkflowUrl:d}=P.workflowService,{isCaesar:c}=(0,E.useUserContext)()??{},{mutateAsync:x,isPending:h}=(0,u.useCreateWorkflow)({teamId:n,groupId:i}),{mutateAsync:f,isPending:g}=(0,u.useExecuteBenchmark)(),{data:j=[],isLoading:b}=(0,u.useListWorkflows)({teamId:n,groupId:i,type:"templates"}),[N,y]=(0,s.useState)(""),_=w(e=>e.activeBenchmark),T=_&&!_.isComplete,z=e.get("type")||"templates",M=e.get("action");(0,s.useEffect)(()=>{"new"===M&&x({payload:{type:"parent"},from:"action=new",redirect:!0})},[M]);let S=t=>{let s=new URLSearchParams(e.toString());return s.set("type",t),a+"?"+s.toString()},$=!!(n&&i),W=(0,s.useMemo)(()=>$?(j??[]).filter(e=>e?.is_template!==!1):[],[$,j]),K=async(e=1)=>{if(!$)return;if(!W.length)return void p.toast.info("No notebooks to run yet",{description:"Add a notebook to this subteam first."});let t=W.length*e;p.toast.info(`Running ${t} notebook${1===t?"":"s"}...`,{description:e>1?`${W.length} templates \xd7 ${e} executions each`:void 0});let s=W.map(e=>e.id),l=await f({workflowIds:s,teamId:n,groupId:i,executionsPerTemplate:e});l.failed>0?(console.warn(`[Benchmark] ${l.failed} notebooks failed to schedule:`,l.errors),p.toast.warning(`${l.scheduled} scheduled, ${l.failed} failed`,{description:l.errors?.[0]})):p.toast.success(`${l.scheduled} notebook${1===l.scheduled?"":"s"} scheduled`)};return(0,t.jsx)("div",{className:"flex gap-2 w-full justify-center border-b border-input",children:(0,t.jsxs)("div",{className:"flex w-full justify-between",children:[(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{variant:"ghost",size:"xs","data-intercom-target":"templates-tab",className:"font-medium mb-1.5",asChild:!0,children:(0,t.jsx)(k.default,{href:S("templates"),children:"Notebooks"})}),"templates"===z&&(0,t.jsx)(r.m.div,{layoutId:"workflow-tabs",className:"h-[2px] w-full bg-primary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{variant:"ghost","data-intercom-target":"history-tab",className:"font-medium mb-1.5",size:"xs",asChild:!0,children:(0,t.jsx)(k.default,{href:S("schedule"),children:"Scheduled"})}),"schedule"===z&&(0,t.jsx)(r.m.div,{layoutId:"workflow-tabs",className:"h-[2px] w-full bg-primary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{variant:"ghost","data-intercom-target":"templates-tab",className:"font-medium mb-1.5",size:"xs",asChild:!0,children:(0,t.jsx)(k.default,{href:S("shared"),children:"Shared with me"})}),"shared"===z&&(0,t.jsx)(r.m.div,{layoutId:"workflow-tabs",className:"h-[2px] w-full bg-primary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{variant:"ghost","data-intercom-target":"history-tab",className:"font-medium mb-1.5",size:"xs",asChild:!0,children:(0,t.jsx)(k.default,{href:S("runs"),children:"History"})}),"runs"===z&&(0,t.jsx)(r.m.div,{layoutId:"workflow-tabs",className:"h-[2px] w-full bg-primary"})]}),c&&$&&(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Button,{variant:"ghost","data-intercom-target":"benchmarks-tab",className:"font-medium mb-1.5",size:"xs",asChild:!0,children:(0,t.jsx)(k.default,{href:S("benchmarks"),children:"Benchmarks"})}),"benchmarks"===z&&(0,t.jsx)(r.m.div,{layoutId:"workflow-tabs",className:"h-[2px] w-full bg-primary"})]})]}),"templates"===z&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(m.Button,{className:"gap-1 h-8 text-muted-foreground",size:"xs",variant:"ghost","data-intercom-target":"explore-button",asChild:!0,onClick:()=>{I.default.capture("notebooks_explore_button_clicked")},children:(0,t.jsx)(k.default,{href:"/notebooks/explore",children:"Explore Templates"})}),c&&$&&(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)(m.Button,{className:"gap-1 h-8 rounded-r-none border-r-0",size:"sm",variant:"outline",disabled:g||b||h||T,onClick:()=>K(1),children:[g||T?(0,t.jsx)(o.Loader2,{className:"size-4 animate-spin"}):(0,t.jsx)(R.Play,{className:"size-4"}),"Run All"]}),(0,t.jsxs)(B.DropdownMenu,{children:[(0,t.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(m.Button,{className:"h-8 px-2 rounded-l-none",size:"sm",variant:"outline",disabled:g||b||h||T,children:(0,t.jsx)(v.ChevronDown,{className:"size-4"})})}),(0,t.jsxs)(B.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(B.DropdownMenuItem,{onClick:()=>K(1),children:"Run 1× each"}),(0,t.jsx)(B.DropdownMenuItem,{onClick:()=>K(5),children:"Run 5× each"}),(0,t.jsx)(B.DropdownMenuItem,{onClick:()=>K(10),children:"Run 10× each"}),(0,t.jsx)(B.DropdownMenuItem,{onClick:()=>K(20),children:"Run 20× each"}),(0,t.jsx)(B.DropdownMenuSeparator,{}),(0,t.jsxs)("div",{className:"px-2 py-1.5",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1.5",children:"Custom"}),(0,t.jsxs)("form",{className:"flex gap-1.5",onSubmit:e=>{e.preventDefault();let t=parseInt(N,10);t>0&&t<=100?(K(t),y("")):p.toast.error("Please enter a number between 1 and 100")},children:[(0,t.jsx)(A.Input,{type:"number",min:1,max:100,placeholder:"e.g. 50",className:"h-7 w-20 text-xs",value:N,onChange:e=>y(e.target.value)}),(0,t.jsx)(m.Button,{type:"submit",size:"sm",className:"h-7 text-xs",children:"Run"})]})]})]})]})]}),(0,t.jsxs)(m.Button,{className:"gap-1 h-8",size:"sm",disabled:h,onClick:async()=>{let e=d((await x({from:"workflows:create-button",payload:{type:"parent"}})).id,n,i);l.push(e)},children:[h?(0,t.jsx)(o.Loader2,{className:"size-4 animate-spin"}):(0,t.jsx)(D.Plus,{className:"size-4"}),"New"]})]})]})})}],167877);var $=e.i(736382),W=e.i(912598),K=e.i(152990),L=e.i(682830),F=e.i(822315),U=e.i(472856),Q=e.i(895751),H=e.i(63209),Y=e.i(655900),O=e.i(352558),G=e.i(503116),V=e.i(286536),X=e.i(555436),q=e.i(602246),J=e.i(55383),Z=e.i(671428),ee=e.i(759714),et=e.i(630374),es=e.i(314847),el=e.i(866684);let ea=({children:e,workflow:s,teamId:l})=>(0,t.jsxs)(et.Dialog,{children:[(0,t.jsx)(et.DialogTrigger,{asChild:!0,children:e}),(0,t.jsxs)(et.DialogContent,{className:"flex flex-col h-[90vh] max-w-3xl p-0 gap-0 border-t",showCloseButton:!1,children:[(0,t.jsx)(et.DialogTitle,{className:"hidden",children:"Notebook Preview"}),(0,t.jsx)(et.DialogDescription,{className:"hidden",children:"A preview of the notebook"}),(0,t.jsx)(et.DialogClose,{className:"absolute right-4 top-6 z-10 text-muted-foreground",asChild:!0,children:(0,t.jsx)(m.Button,{variant:"outline",className:"size-6 p-0",children:(0,t.jsx)(d.X,{className:"size-3.5"})})}),(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(m.Button,{variant:"outline",className:"absolute right-4 top-14 z-10 text-muted-foreground size-6 p-0",asChild:!0,children:(0,t.jsx)(k.default,{href:P.workflowService.getWorkflowUrl(s.id,l),children:(0,t.jsx)(ee.Expand,{className:"size-3.5"})})})}),(0,t.jsx)(x.TooltipContent,{children:"View full notebook"})]}),(0,t.jsx)(el.default,{workflowId:s.id,teamId:l,children:(0,t.jsx)(es.default,{})})]})]});var er=e.i(728442);let en=(0,s.memo)(({row:e})=>{let l=(0,W.useQueryClient)(),a=(0,C.useRouter)(),{teamId:r}=(0,C.useParams)(),n=!!(0,$.useIsMutating)({mutationKey:["workflow/delete",e.original.id]}),i=(0,s.useCallback)(e=>{l.setQueryData((0,q.getWorkflowQueryKey)(e.original.id),e.original),I.default.capture("workflow:open",{content_id:e.original.id,new_workflows:!0}),a.push(P.workflowService.getWorkflowUrl(e.original.id,r))},[l,a,r]);return(0,t.jsx)("tr",{className:(0,h.cn)("group/row text-sm cursor-pointer  hover:bg-message border-b",n&&"pointer-events-none opacity-25"),onClick:t=>{if(n)return t.preventDefault();i(e)},children:e.getVisibleCells().map(e=>(0,t.jsx)("td",{className:(0,h.cn)("pt-2 first:pl-2 last:pr-2 h-[65px] px-0 first:rounded-l-xl last:rounded-r-xl"),children:(0,t.jsx)("div",{className:(0,h.cn)("p-3 flex flex-1 overflow-hidden h-full duration-200"),children:(0,K.flexRender)(e.column.columnDef.cell,e.getContext())})},e.id))},e.id)},(e,t)=>e.row.id===t.row.id&&e.row.original===t.row.original&&e.row.getIsSelected()===t.row.getIsSelected());var ei=e.i(174886),eo=e.i(786108),eo=eo,ed=e.i(284765),ec=e.i(255248),eu=e.i(727612),em=e.i(720274),ex=e.i(789145),eh=e.i(620949),ep=e.i(351538);let ef=({row:e,teamId:s,groupId:l})=>{let{mutateAsync:a,isPending:r}=(0,u.useDuplicateWorkflow)({teamId:s,groupId:l}),{data:n}=(0,eh.useUserInformation)(),i=n?.id,d=e.original.creator?.id===i,{mutateAsync:c,isPending:h}=(0,ex.useDeleteWorkflow)({workflowId:e.original.id}),{data:p}=(0,u.useWorkflowCrons)({teamId:s,groupId:l}),f=p?.find(t=>t?.content_id===e.original.id),j=h||r;return(0,t.jsx)("div",{className:"flex flex-row gap-3 items-center",children:(0,t.jsx)("div",{className:"flex flex-row justify-end w-full items-center text-foreground",children:(0,t.jsxs)(B.DropdownMenu,{children:[(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(m.Button,{variant:"ghost",size:"sm",className:"gap-2 hover:bg-slate-300/25",disabled:j,onClick:e=>{e.stopPropagation()},children:(0,t.jsx)(eo.default,{size:14})})})}),(0,t.jsx)(x.TooltipContent,{children:"More actions"})]}),(0,t.jsxs)(B.DropdownMenuContent,{className:"flex flex-col",children:[(0,t.jsx)(ep.default,{workflowId:e.original.id,children:(0,t.jsxs)(m.Button,{variant:"ghost",className:"w-full flex-shrink-0 relative flex text-xs select-none justify-start gap-2 items-center rounded-lg px-3 h-8 outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",size:"sm",onClick:e=>{e.stopPropagation()},children:[(0,t.jsx)(ed.Settings2,{className:"size-4"}),"Edit details"]})}),(0,t.jsxs)(B.DropdownMenuItem,{"data-event":"my_files_download",className:"gap-2",onClick:t=>{t.stopPropagation(),I.default.capture("workflows:duplicate_template",{workflowId:e.original.id}),a({workflowId:e.original.id,type:"parent"})},children:[(0,t.jsx)(ei.Copy,{className:"size-4 flex-shrink-0"}),"Duplicate"]}),(f||d)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(em.default,{workflow:e.original,shareTo:{people:!0,public:!0,team:!0,explore:!0,teamGroup:g.FEATURE_FLAGS.TEAM_GROUPS},children:(0,t.jsxs)(m.Button,{onClick:e=>{e.stopPropagation(),I.default.capture("workflow_share_button_clicked")},variant:"ghost",className:"w-full flex-shrink-0 relative flex text-xs select-none justify-start gap-2 items-center rounded-lg px-3 h-8 outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",size:"sm",children:[(0,t.jsx)(ec.Share,{className:"size-4 flex-shrink-0"}),"Share"]})}),d&&(0,t.jsxs)(B.DropdownMenuItem,{"data-event":"my_files_delete",disabled:h,className:"gap-2",onClick:t=>{t.stopPropagation(),I.default.capture("workflows:delete_template",{workflowId:e.original.id}),c()},children:[h?(0,t.jsx)(o.Loader2,{size:12,className:"size-4 animate-spin"}):(0,t.jsx)(eu.Trash2,{className:"size-4 font-bold"}),"Delete"]})]})]})]})})})};var eg=e.i(798031),eg=eg,eo=eo,ej=e.i(952571),ew=e.i(335653),ew=ew,eb=e.i(788699),ev=e.i(982926),eN=e.i(384347);let ey=e=>Array.from({length:e},(e,t)=>({id:`skeleton-workflow-${t.toString()}`,public_id:"",is_public_at:"",is_searchable:!1,is_searchable_at:"",is_template:null,last_viewed_at:"",creator:{id:"",email:""},plan:{id:"",steps:[],name:"loading notebook"},parent:{id:"",plan:{name:""}},updated_at:"loading",created_at:"loading"})),ek=({row:e})=>{let s=(0,W.useQueryClient)(),l=(0,C.useRouter)(),a=(0,C.usePathname)(),r=!!(0,$.useIsMutating)({mutationKey:["workflow/delete",e.original.id]});return(0,t.jsx)("tr",{className:(0,h.cn)("group/row text-sm cursor-pointer hover:bg-message",r&&"pointer-events-none opacity-25"),onClick:t=>{r?t.preventDefault():t.metaKey||t.ctrlKey||t.shiftKey||1===t.button||t.target.closest('button, a, input, select, textarea, [role="button"]')||(s.setQueryData((0,q.getWorkflowQueryKey)(e.original.id),e.original),I.default.capture("workflow:open",{content_id:e.original.id,new_workflows:!0,type:"child"}),l.push(`${a}/${e.original.id}`))},children:e.getVisibleCells().map(e=>(0,t.jsx)("td",{className:(0,h.cn)("px-2 py-1.5 overflow-hidden first:rounded-l-xl last:rounded-r-xl "),style:{maxWidth:`${e.column.getSize()}px`},children:(0,K.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)},eC=({parentRow:e})=>{let l=e?.original,a=l?.id??"",{teamId:r,groupId:i}=(0,C.useParams)(),{data:d,isLoading:c,isSuccess:p,refetch:f}=(0,ev.useWorkflowRuns)({workflowId:a,teamId:r,groupId:i,enabled:!!a}),{mutateAsync:j,isPending:w}=(0,u.useCreateWorkflow)({teamId:r,groupId:i}),{data:b}=(0,eh.useUserInformation)(),v=b?.id===l?.creator?.id,{mutateAsync:N}=(0,u.useDuplicateWorkflow)({teamId:r,groupId:i}),y=(0,s.useMemo)(()=>{let e=l?.plan?.steps?.some(e=>e?.role==="evaluation"||e?.type==="eval-prompt")??!1,s=[{accessorKey:"plan.name",id:"name",minSize:0,maxSize:400,cell:({getValue:e,row:s})=>{let l=e()||"Untitled notebook",a=s.original;return(0,t.jsx)("div",{className:"flex items-center gap-5 overflow-hidden",children:(0,t.jsx)("div",{className:"flex flex-col truncate w-full gap-1",children:(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(k.default,{className:"max-w-[350px] truncate text-foreground hover:underline",href:P.workflowService.getWorkflowUrl(a.id,r,i),children:l})}),(0,t.jsx)(x.TooltipContent,{className:"text-wrap break-all max-w-full text-xs",children:l})]})})})},header:e=>(0,t.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,t.jsx)("span",{children:"Runs"}),(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(ej.Info,{className:"size-3"})}),(0,t.jsxs)(x.TooltipContent,{children:["Runs are a way for you to rerun the same ",(0,t.jsx)("br",{})," notebook with different data or explorations."]})]})]})},{accessorKey:"creator.email",id:"editor",header:()=>(0,t.jsx)("span",{children:"Owner"}),cell:({row:e})=>(0,t.jsx)("div",{className:"flex flex-row items-center gap-3",children:(0,t.jsx)("span",{className:"text-sm",children:e.original.creator.email})})},{accessorKey:"created_at",id:"created_at",sortingFn:(e,t)=>F.default.utc(e.original.created_at).diff(F.default.utc(t.original.created_at)),cell:({getValue:e})=>{let s=e(),l=F.default.utc(s).local(),a=l.fromNow(),r=l.format("MMMM D, YYYY h:mm A");return(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{children:a}),(0,t.jsx)(x.TooltipContent,{children:r})]})},header:()=>"Created"},{accessorKey:"updated_at",id:"updated_at",sortingFn:(e,t)=>F.default.utc(e.original.updated_at).diff(F.default.utc(t.original.updated_at)),cell:function({row:e,getValue:s}){let l=s(),a=F.default.utc(l).local(),r=a.fromNow(),n=a.format("MMMM D, YYYY h:mm A"),{mutateAsync:i,isPending:d}=(0,ex.useDeleteWorkflow)({workflowId:e.original.id});return(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{children:r}),(0,t.jsx)(x.TooltipContent,{children:n})]}),(0,t.jsx)("div",{className:"flex items-center p-0",children:(0,t.jsxs)(B.DropdownMenu,{children:[(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(m.Button,{variant:"ghost",className:"p-0 size-9 gap-2 opacity-0 group-hover/row:opacity-100",disabled:d,onClick:e=>{e.stopPropagation()},children:(0,t.jsx)(eo.default,{size:16})})})}),(0,t.jsx)(x.TooltipContent,{children:"More actions"})]}),(0,t.jsxs)(B.DropdownMenuContent,{className:"flex flex-col",children:[e.original&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.DropdownMenuItem,{asChild:!0,children:(0,t.jsx)(ep.default,{subRuns:!0,workflowId:e.original.id,children:(0,t.jsxs)(m.Button,{variant:"ghost",className:"w-full flex-shrink-0 relative flex text-xs select-none justify-start gap-2 items-center rounded-lg px-3 h-8 outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",size:"sm",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(eb.Pencil,{className:"size-3"}),"Edit Details"]})})}),(0,t.jsxs)(B.DropdownMenuItem,{"data-event":"my_files_download",className:"gap-2",onClick:async t=>{t.stopPropagation(),I.default.capture("workflows:duplicate",{workflowId:e.original.id,type:"child"}),await N({workflowId:e.original.id,type:"child"}),await f()},children:[(0,t.jsx)(ei.Copy,{className:"size-4 flex-shrink-0"}),"Duplicate"]})]}),v&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(em.default,{workflow:e.original,shareTo:{people:!0,public:!0,team:!0,explore:!0,teamGroup:g.FEATURE_FLAGS.TEAM_GROUPS},children:(0,t.jsxs)(m.Button,{onClick:e=>{e.stopPropagation(),I.default.capture("workflow_share_button_clicked")},variant:"ghost",className:"w-full flex-shrink-0 relative flex text-xs select-none justify-start gap-2 items-center rounded-lg px-3 h-8 outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",size:"sm",children:[(0,t.jsx)(ec.Share,{className:"size-4 flex-shrink-0"}),"Share"]})})}),(0,t.jsxs)(B.DropdownMenuItem,{"data-event":"my_files_delete",disabled:d,className:"gap-2",onClick:e=>{e.stopPropagation(),i({templateRun:!0})},children:[d?(0,t.jsx)(o.Loader2,{size:12,className:"size-4 animate-spin"}):(0,t.jsx)(eu.Trash2,{className:"size-4 font-bold"}),"Delete"]})]})]})})]})},header:()=>"Last Updated"}];return(e&&s.splice(2,0,{id:"evaluation_results",header:()=>(0,t.jsx)("span",{children:"Evaluations"}),cell:({row:e})=>{let s=e.original.eval_results,l=s?.success_count??0,a=s?.failure_count??0,r=s?.total_count??l+a,i=e.original.plan?.steps?.filter(e=>e?.role===eN.WorkflowRole.evaluation||e?.type==="eval-prompt").length??0;return(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-emerald-500",children:[(0,t.jsx)(n.CheckCircle2,{className:"size-4"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:l})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-destructive",children:[(0,t.jsx)(eg.default,{className:"size-4"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:a})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-muted-foreground",children:[(0,t.jsx)(ew.default,{className:"size-4"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:i?`${r}/${i}`:`${r}/0`})]})]})}}),c)?s.map(e=>({...e,cell:()=>(0,t.jsx)(Z.Skeleton,{className:"flex h-[36px] w-full"})})):s},[N,i,v,c,l?.plan?.steps,f,r]),_=(0,s.useMemo)(()=>c?ey(Math.max(l?.runs_count??0,3)):d||[],[c,l?.runs_count,d]),T=(0,K.useReactTable)({columns:y,data:_,getCoreRowModel:(0,L.getCoreRowModel)(),getSortedRowModel:(0,L.getSortedRowModel)(),columnResizeDirection:"ltr",columnResizeMode:"onChange",initialState:{sorting:[{id:"created_at",desc:!0}]}}),{rows:z}=T.getRowModel();return l?(0,t.jsx)("div",{className:(0,h.cn)("flex flex-col w-full max-h-[310px] px-2 last:pb-2 overflow-hidden"),children:(0,t.jsx)("div",{className:(0,h.cn)("w-full h-full overflow-auto p-1 rounded-b-xl bordered-scroll",e.getIsExpanded()&&"border border-t-0"),children:(0,t.jsxs)("table",{className:"w-full relative overflow-x-auto",children:[(0,t.jsx)("thead",{children:T.getHeaderGroups().map(e=>(0,t.jsx)("tr",{className:"border-b",children:e.headers.map(e=>(0,t.jsx)("th",{className:"text-left p-2 font-medium text-muted-foreground text-sm",style:{width:e.getSize()},children:e.isPlaceholder?null:(0,t.jsx)("div",{className:(0,h.cn)("flex items-center gap-2",e.column.getCanSort()&&"cursor-pointer select-none"),onClick:e.column.getToggleSortingHandler(),children:"function"==typeof e.column.columnDef.header?e.column.columnDef.header(e.getContext()):e.column.columnDef.header})},e.id))},e.id))}),(0,t.jsxs)("tbody",{children:[z.map(e=>(0,t.jsx)(ek,{row:e},e.original.id)),(p&&0===_.length||0===z.length)&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:T.getAllColumns().length,className:"h-[180px]",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center text-muted-foreground",children:[(0,t.jsxs)("span",{className:"text-center",children:["Looks like you haven't created any runs of this notebook yet. ",(0,t.jsx)("br",{}),"Let's start a run below"]}),(0,t.jsx)(m.Button,{size:"sm",onClick:()=>{j({payload:{type:"child",parentId:l.id},redirect:!0,from:"workflows:empty-table"})},disabled:w,children:"Create run"})]})})})]})]})})}):null},e_=(0,s.memo)(({row:e,isExpanded:l,isSelected:n})=>{let i=!!(0,$.useIsMutating)({mutationKey:["workflow/delete",e.original.id]}),{teamId:o,groupId:d}=(0,C.useParams)(),c=(0,C.useRouter)(),u=(0,W.useQueryClient)(),m=e.getVisibleCells().length,x=(0,s.useCallback)(t=>{if(!t.target.closest('button, a, input, select, textarea, [role="button"]')&&!i){let t=e.original.id;u.getQueryData((0,q.getWorkflowQueryKey)(t))||u.setQueryData((0,q.getWorkflowQueryKey)(t),e.original),I.default.capture("workflow:open",{content_id:t,new_workflows:!0,from:"row-click"}),c.push(P.workflowService.getWorkflowUrl(t,o,d))}},[u,d,i,e.original,c,o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("tr",{className:(0,h.cn)("!relative group/row text-sm cursor-pointer transition-colors",i&&"pointer-events-none opacity-25"),"data-selected":!!n||void 0,onClick:x,children:e.getVisibleCells().map((e,s)=>{let a,r;return(0,t.jsx)("td",{className:(0,h.cn)("first:pl-2 last:pr-2 h-[50px] px-0",l?"first:rounded-tl-xl last:rounded-tr-xl pb-0":"first:rounded-l-xl last:rounded-r-xl"),style:{width:e.column.getSize()},children:(0,t.jsx)("div",{className:(0,h.cn)("px-1.5 py-4 flex flex-1 bg-background group-hover/row:bg-message overflow-hidden h-full duration-200",(a=0===s,r=s===m-1,l?(0,h.cn)("bg-message border-border border-t border-b",a&&"border-l rounded-tl-xl",r&&"border-r rounded-tr-xl"):(0,h.cn)("border-transparent border-t border-b border-t-border",a&&"border-l rounded-tl-none",r&&"border-r rounded-tr-none"))),children:(0,K.flexRender)(e.column.columnDef.cell,e.getContext())})},e.id)})},e.id),(0,t.jsx)(a.AnimatePresence,{children:l&&(0,t.jsx)("tr",{className:"overflow-hidden",children:(0,t.jsx)("td",{colSpan:m,className:"p-0 overflow-hidden",children:(0,t.jsx)(r.m.div,{className:"overflow-hidden",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{height:{type:"easeOut",duration:.2},opacity:{duration:.2}},children:(0,t.jsx)(eC,{parentRow:e})})})})})]})},(e,t)=>e.row.id===t.row.id&&e.row.original===t.row.original&&e.isExpanded===t.isExpanded&&e.isSelected===t.isSelected);F.default.extend(Q.default),F.default.extend(U.default);let eT=e=>{let t=(0,F.default)(),s=F.default.utc(e).local(),l=Math.floor(Math.floor(t.diff(s)/1e3)/60),a=Math.floor(l/60),r=Math.floor(a/24),n=Math.floor(r/30),i=Math.floor(r/365);return i>0?`${i}y ago`:n>0?`${n}mo ago`:r>0?`${r}d ago`:a>0?`${a}h ago`:l>0?`${l}m ago`:"now"};e.s(["default",0,({teamId:e,groupId:l})=>{let a=(0,C.useSearchParams)().get("type")||"templates",{data:r,isLoading:n,isSuccess:i,isError:d,error:c}=(0,u.useListWorkflows)({teamId:e,groupId:l,type:a});(0,u.useListWorkflows)({teamId:e,groupId:l,type:"runs"});let{mutateAsync:p,isPending:f}=(0,u.useCreateWorkflow)({teamId:e,groupId:l}),g=(0,W.useQueryClient)(),{data:j}=(0,u.useWorkflowCrons)({teamId:e,groupId:l}),w=(0,$.useMutationState)({filters:{mutationKey:["workflow/create"]}}),b=(0,s.useMemo)(()=>j?.length?j.reduce((e,t)=>(t?.content_id&&e.set(t.content_id,t),e),new Map):new Map,[j]),y=(0,s.useMemo)(()=>w.length?w.reduce((e,t)=>{if("pending"!==t.status)return e;let s=t.variables?.payload;return s?.type==="child"&&s.parentId&&e.add(s.parentId),e},new Set):new Set,[w]),_="templates"===a||"schedule"===a,T=!!e,z=(0,s.useMemo)(()=>{let s=[..._?[{accessorKey:"runs_count",id:"runs_count",header:null,size:0,minSize:0,maxSize:0,cell:({row:e})=>{let s=e.original.runs_count??0,l=s>0;return(0,t.jsx)("div",{className:"group flex items-center justify-start pr-1 z-[1]",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.getToggleExpandedHandler()()},children:(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(m.Button,{className:"flex items-center gap-1.5 p-0.5 pl-1.5 pr-2 h-7 min-w-[2.5rem] justify-start border border-transparent rounded-full group-hover:bg-slate-300/25 group-hover:border",variant:"ghost",children:[(0,t.jsx)(N.ChevronRight,{className:(0,h.cn)("text-muted-foreground size-4 duration-200 flex-shrink-0",e.getIsExpanded()&&"rotate-90")}),(0,t.jsx)("div",{className:"text-nowrap text-muted-foreground text-xs font-medium","data-intercom-target":"run-count",children:l?`${s}`:"-"})]})}),(0,t.jsxs)(x.TooltipContent,{children:[e.getIsExpanded()?"Collapse runs":"Expand runs",l?` (${s})`:""]})]})})}}]:[],{accessorKey:"name",accessorFn:e=>e.plan?.name,id:"name",maxSize:300,cell:({getValue:s,row:a})=>{let r=s()||"Untitled notebook",n=a.original,i=b.get(n?.id),o="UTC";try{o=Intl.DateTimeFormat().resolvedOptions().timeZone}catch{}return(0,t.jsx)("div",{className:"flex items-center w-full",children:(0,t.jsxs)("div",{className:"flex flex-col justify-center truncate w-full px-2",children:[(0,t.jsxs)("div",{className:"inline-flex flex-row items-center",children:[(0,t.jsxs)(x.Tooltip,{delayDuration:500,children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(k.default,{onClick:e=>{e.stopPropagation();let t=a.original.id;g.getQueryData((0,q.getWorkflowQueryKey)(t))||g.setQueryData((0,q.getWorkflowQueryKey)(t),a.original)},href:P.workflowService.getWorkflowUrl(n.id,e,l),className:(0,h.cn)("inline-flex items-center text-wrap break-all line-clamp-1 max-w-full text-base font-medium truncate text-foreground group-hover/row:underline mr-1"),children:r})}),(0,t.jsx)(x.TooltipContent,{side:"top",align:"center",className:"text-wrap break-all max-w-full text-xs",children:r})]}),i&&(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(er.default,{workflow:a.original,children:(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(m.Button,{variant:"ghost",size:"sm",className:" transition-all duration-200 gap-2 text-foreground z-[1] hover:bg-slate-300/25 size-7 p-0 focus-visible:ring-0 focus-visible:ring-offset-0",children:(0,t.jsx)(G.Clock,{className:"size-3.5"})})})}),(0,t.jsx)(x.TooltipContent,{side:"top",align:"center",className:"text-wrap break-all max-w-full text-xs",children:(0,J.getCronScheduleDescription)(i.frequency,i.timezone||o)})]}),(0,t.jsx)("div",{className:"flex items-center h-full group",onClick:e=>{e.stopPropagation(),e.preventDefault(),I.default.capture("workflow:open:preview",{id:a.original.id});let t=a.original.id;g.getQueryData((0,q.getWorkflowQueryKey)(t))||g.setQueryData((0,q.getWorkflowQueryKey)(t),a.original)},children:(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(ea,{workflow:a.original,teamId:e,children:(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(m.Button,{"data-intercom-target":"run-template-button",variant:"ghost",size:"sm",className:" transition-all duration-200 gap-2 text-foreground z-[1] group-hover:bg-slate-300/25 size-7 p-0 focus-visible:ring-0 focus-visible:ring-offset-0",children:(0,t.jsx)(V.Eye,{className:" size-4 group-hover/row:block hidden"})})})}),(0,t.jsx)(x.TooltipContent,{children:"Quick preview"})]})})]}),(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"text-sm font-normal text-muted-foreground truncate max-w-[300px]",children:n?.plan?.description||""})}),n?.plan?.description&&(0,t.jsx)(x.TooltipContent,{className:"break-words max-w-[90%]",side:"right",children:n?.plan?.description})]})]})})},header:({table:e})=>(0,t.jsx)("div",{className:"flex flex-row gap-5 items-center",children:(0,t.jsx)("span",{children:"Name"})})},...T?[{accessorKey:"creator.email",id:"editor",size:100,header:()=>(0,t.jsx)("span",{children:"Shared by"}),cell:({row:e})=>(0,t.jsx)("div",{className:"flex flex-row items-center gap-3 w-full",children:(0,t.jsx)("span",{className:"text-sm truncate",children:e.original.creator.email})})}]:[],{accessorKey:"actions",id:"actions",header:()=>(0,t.jsx)("span",{}),size:200,cell:({row:e})=>{let s=e.original.is_template,l=y.has(e.original.id),r="gap-1.5 text-foreground bg-message hover:bg-slate-300/25 h-8 px-3 border border-border";return(0,t.jsxs)("div",{className:"flex flex-row items-center justify-end gap-1 w-full z-[1] mr-2",children:[s&&"templates"===a&&(0,t.jsx)("div",{className:"opacity-0 group-hover/row:opacity-100 transition-opacity",children:(0,t.jsx)(er.default,{workflow:e.original,children:(0,t.jsxs)(m.Button,{variant:"ghost",size:"sm",className:r,onClick:e=>{e.stopPropagation(),I.default.capture("workflow_schedule_button_clicked",{location:"hover"})},children:[(0,t.jsx)(G.Clock,{className:"size-4"}),(0,t.jsx)("span",{className:"font-sans font-medium text-sm",children:"Schedule"})]})})}),s&&"templates"===a&&(0,t.jsx)("div",{className:"opacity-0 group-hover/row:opacity-100 transition-opacity",children:(0,t.jsxs)(m.Button,{"data-intercom-target":"run-template-button",variant:"ghost",size:"sm",className:r,disabled:l,onClick:t=>{t.stopPropagation(),I.default.capture("workflow_run_button_clicked",{location:"hover"}),p({from:"workflows:empty-table",payload:{type:"child",parentId:e.original.id},redirect:!0})},children:[l?(0,t.jsx)(o.Loader2,{className:"animate-spin size-4"}):(0,t.jsx)(R.Play,{size:14}),(0,t.jsx)("span",{className:"font-sans font-medium text-sm",children:"Run"})]})})]})}},{accessorKey:"updated_at",id:"updated_at",size:100,sortingFn:(e,t)=>F.default.utc(e.original.updated_at).diff(F.default.utc(t.original.updated_at)),cell:({getValue:e})=>{let s=e(),l=F.default.utc(s).local(),a=eT(s),r=l.format("MMMM D, YYYY h:mm A");return(0,t.jsx)("div",{className:"flex justify-between w-full",children:(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"inline-flex items-center text-muted-foreground whitespace-nowrap",children:a})}),(0,t.jsx)(x.TooltipContent,{children:r})]})})},header:()=>"Updated"},{accessorKey:"created_at",id:"created_at",size:100,sortingFn:(e,t)=>F.default.utc(e.original.created_at).diff(F.default.utc(t.original.created_at)),cell:({getValue:e})=>{let s=e(),l=F.default.utc(s).local(),a=eT(s),r=l.format("MMMM D, YYYY h:mm A");return(0,t.jsx)("div",{className:"flex justify-between w-full",children:(0,t.jsxs)(x.Tooltip,{children:[(0,t.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"inline-flex items-center text-muted-foreground whitespace-nowrap",children:a})}),(0,t.jsx)(x.TooltipContent,{children:r})]})})},header:()=>"Created"},..."shared"===a?[{accessorKey:"creator.email",id:"editor",size:100,header:()=>(0,t.jsx)("span",{children:"Shared by"}),cell:({row:e})=>(0,t.jsx)("div",{className:"flex flex-row items-center gap-3 w-full",children:(0,t.jsx)("span",{className:"text-sm truncate",children:e.original.creator.email})})}]:[],{accessorKey:"creator",id:"menu",header:()=>(0,t.jsx)("span",{}),maxSize:0,minSize:0,cell:({row:s})=>(0,t.jsx)("div",{className:"flex flex-row items-center justify-end gap-1 w-full z-[1]",children:(0,t.jsx)(ef,{row:s,teamId:e,groupId:l})})}];return n?s.map(e=>({...e,cell:()=>(0,t.jsx)(Z.Skeleton,{className:"flex h-[40px] w-full"})})):s},[_,T,a,n,b,e,l,g,y,p]),M=(0,s.useMemo)(()=>d?(e=>{if(!e)return"Failed to load workflows.";if("string"==typeof e)return e;if(e instanceof Error)return e.message;if("object"==typeof e&&null!==e){if("error"in e&&"string"==typeof e.error)return e.error;if("detail"in e&&"string"==typeof e.detail)return e.detail;if("message"in e&&"string"==typeof e.message)return e.message}return"Failed to load workflows."})(c):null,[d,c]),S=(0,s.useMemo)(()=>n?ey(10):d?[]:r||[],[r,n,d]),B=(0,K.useReactTable)({columns:z,data:S,getRowCanExpand:()=>_,getCoreRowModel:(0,L.getCoreRowModel)(),getSortedRowModel:(0,L.getSortedRowModel)(),getFilteredRowModel:(0,L.getFilteredRowModel)(),getExpandedRowModel:(0,L.getExpandedRowModel)(),enableColumnResizing:!0,autoResetExpanded:!1,initialState:{sorting:[{id:"updated_at",desc:!0}]}}),E=B.getColumn("name");return(0,t.jsx)("div",{className:"flex flex-col relative rounded-3xl w-full gap-5 max-w-screen-lg",children:(0,t.jsxs)("div",{className:"w-full  max-w-screen-lg overflow-auto bg-background ",children:[(0,t.jsx)("div",{className:"flex flex-row flex-wrap gap-3 justify-between ",children:(0,t.jsxs)("div",{className:"flex flex-row flex-1 items-center relative rounded-lg border border-input pr-3 px-2 py-1 gap-2 w-full max-w-[400px]",children:[(0,t.jsx)(X.Search,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)(A.Input,{className:"flex flex-1 bg-transparent h-6 p-0 border-none focus-visible:ring-0 text-sm placeholder:text-light",onChange:e=>E.setFilterValue(e.target.value),placeholder:"Search notebooks...",type:"text",value:E.getFilterValue()??""})]})}),(0,t.jsxs)("table",{className:"w-full relative border-none",children:[(0,t.jsx)("thead",{className:"z-50 bg-background",children:B.getHeaderGroups().map(e=>(0,t.jsx)("tr",{children:e.headers.map(e=>(0,t.jsx)("th",{colSpan:e.colSpan,className:(0,h.cn)("relative text-muted-foreground font-medium","runs_count"===e.id?"p-0 px-1":"p-2 py-2"),style:{width:"runs_count"===e.id?e.column.getSize():void 0},children:e.isPlaceholder?null:(0,t.jsxs)("div",{className:(0,h.cn)(e.column.getCanSort()?"cursor-pointer select-none":"","flex flex-row text-sm justify-start gap-1 items-center hover:text-foreground"),onClick:e.column.getToggleSortingHandler(),children:[(0,K.flexRender)(e.column.columnDef.header,e.getContext()),{asc:(0,t.jsx)(Y.ChevronUp,{className:"w-4 h-4"}),desc:(0,t.jsx)(v.ChevronDown,{className:"w-4 h-4"})}[e.column.getIsSorted()]??null]})},e.id))},e.id))}),(0,t.jsxs)("tbody",{children:[B.getRowModel().rows.map(e=>"runs"===a?(0,t.jsx)(en,{row:e},e.id):(0,t.jsx)(e_,{row:e,isExpanded:e.getIsExpanded(),isSelected:e.getIsSelected()},e.id)),d&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:B.getAllColumns().length,className:"py-12 px-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center text-muted-foreground",children:[(0,t.jsx)(H.AlertCircle,{className:"w-8 h-8 text-destructive"}),(0,t.jsx)("span",{className:"text-center",children:M||"Failed to load workflows."})]})})}),i&&0===S.length&&(0,t.jsxs)(t.Fragment,{children:["templates"===a&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:B.getAllColumns().length,className:"py-12 px-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center text-muted-foreground",children:[(0,t.jsx)(O.CircleOff,{className:"w-8 h-8"}),(0,t.jsxs)("span",{className:"text-center",children:["Looks like you haven't created any templates yet. ",(0,t.jsx)("br",{}),"Let's get started by creating a new one."]}),(0,t.jsxs)(m.Button,{className:"gap-1 h-8",onClick:()=>p({from:"workflows:empty-table",payload:{type:"parent"},redirect:!0}),disabled:f,children:[(0,t.jsx)(D.Plus,{className:"size-4"}),"New"]})]})})}),"schedule"===a&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:B.getAllColumns().length,className:"py-12 px-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center text-muted-foreground",children:[(0,t.jsx)(O.CircleOff,{className:"w-8 h-8"}),(0,t.jsxs)("span",{className:"text-center",children:["Looks like you haven't created any scheduled notebooks yet. ",(0,t.jsx)("br",{}),"Head to your"," ",(0,t.jsx)(k.default,{className:"text-primary underline",href:"/notebooks",children:"notebooks"})," ","to schedule one using the ",(0,t.jsx)("br",{})," dropdown menu located on the table row."]})]})})})]})]})]})]})})}],982551)}]);

//# debugId=5f615c55-5d43-abee-a331-67cf1e80f44e
//# sourceMappingURL=73951c845df6608e.js.map