;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="022b6b94-56ea-707b-5e1a-5ee2a705ab6b")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,532711,e=>{"use strict";var t=e.i(843476),a=e.i(271645),s=e.i(744266),r=e.i(373488),r=r,i=e.i(737345),n=e.i(475254);let l=(0,n.default)("panel-right",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var o=e.i(239616),d=e.i(770703),c=e.i(522016),u=e.i(618566),m=e.i(604570),h=e.i(749064),p=e.i(982926);let x=(0,n.default)("slash",[["path",{d:"M22 2 2 22",key:"y4kqgn"}]]);var f=e.i(167881),g=e.i(728231),v=e.i(351538),b=e.i(912598),j=e.i(808451),w=e.i(643531),y=e.i(344523),N=e.i(531278),C=e.i(471512),k=e.i(753751),_=e.i(59377),E=e.i(647163),T=e.i(268580);function S({children:e}){let s=(0,b.useQueryClient)(),{workflowId:r,teamId:i,groupId:n}=(0,u.useParams)(),l=(0,a.useRef)(null),o=(0,a.useRef)(null),{data:d}=(0,p.useWorkflowQuery)({workflowId:r}),m=d?.is_template?d?.id:d?.parent_id,h=d?.is_template?void 0:d?.id,{data:x,isPending:f}=(0,C.useListWorkflows)({teamId:i,type:"templates"}),v=(0,a.useMemo)(()=>x?x.sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()):[],[x]),[S,A]=(0,a.useState)(m),{data:P,isPending:I}=(0,p.useWorkflowRuns)({workflowId:S,teamId:i}),R=(0,a.useMemo)(()=>P?P.sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()):[],[P]),F=(0,j.debounce)(e=>A(e),250),[O,M]=(0,a.useState)("templates"),D=(0,a.useCallback)(e=>{M("templates"),s.getQueryData(["workflows/runs",e,i])?(F.cancel(),A(e)):F(e)},[s,F,i]);return(0,a.useEffect)(()=>{!S&&d&&A(m)},[S,d,m]),(0,t.jsxs)(_.Popover,{onOpenChange:e=>{e&&setTimeout(()=>{l.current&&l.current.scrollIntoView({behavior:"instant",block:"center"}),o.current&&o.current.scrollIntoView({behavior:"instant",block:"center"})},0)},children:[(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(_.PopoverTrigger,{className:"flex flex-col h-full justify-center px-1 py-1 mx-1 rounded-lg hover:bg-message",asChild:!0,children:(0,t.jsx)(g.TooltipTrigger,{children:e||(0,t.jsx)(y.ChevronsUpDown,{className:"size-3.5"})})}),(0,t.jsx)(g.TooltipContent,{children:"Notebook selector"})]}),(0,t.jsxs)(_.PopoverContent,{className:"flex flex-row w-[512px] h-[300px] p-0 items-start justify-start rounded-xl",children:[(0,t.jsxs)(k.Command,{className:(0,E.cn)("flex rounded-none rounded-l-xl bg-message duration-200","templates"===O&&"bg-background"),onMouseEnter:()=>M("templates"),children:[(0,t.jsx)(k.CommandInput,{className:"border-0 border-y rounded-none bg-transparent focus-visible:ring-0 py-5 px-4",placeholder:"Search templates..."}),(0,t.jsxs)(k.CommandList,{className:"h-full max-h-none bordered-scroll",children:[(0,t.jsx)(k.CommandEmpty,{className:"flex items-center justify-center h-full",children:f?(0,t.jsx)(N.Loader2,{className:"animate-spin"}):"No templates found"}),(0,t.jsx)(k.CommandGroup,{className:"p-2",children:v.map(e=>(0,t.jsx)(k.CommandItem,{value:`${e.id} ${e.plan?.name||"Untitled Notebook"}`,onMouseEnter:()=>D(e.id),asChild:!0,children:(0,t.jsxs)(c.default,{ref:e.id===m?l:null,href:T.workflowService.getWorkflowUrl(e.id,i,n),className:(0,E.cn)("cursor-pointer flex justify-between rounded-lg mb-1",e.id===m&&"bg-accent"),children:[e.plan.name||"Untitled Notebook",e.id===m&&(0,t.jsx)(w.Check,{className:"size-4 ml-2"})]})},e.id))})]})]}),(0,t.jsx)("div",{className:"h-full w-[1px] bg-border"}),(0,t.jsxs)(k.Command,{className:(0,E.cn)("flex rounded-none rounded-r-xl bg-message duration-200","runs"===O&&"bg-background"),onMouseEnter:()=>M("runs"),children:[(0,t.jsx)(k.CommandInput,{className:"border-0 border-y rounded-none bg-transparent focus-visible:ring-0 py-5 px-4",placeholder:"Search runs..."}),(0,t.jsxs)(k.CommandList,{className:"h-full bordered-scroll",children:[(0,t.jsx)(k.CommandEmpty,{className:"flex items-center justify-center h-full",children:I?(0,t.jsx)(N.Loader2,{className:"animate-spin"}):"No runs found"}),(0,t.jsx)(k.CommandGroup,{className:"p-2",children:R.map(e=>(0,t.jsx)(k.CommandItem,{value:`${e.id} ${e.plan?.name||"Untitled Notebook"}`,asChild:!0,children:(0,t.jsxs)(c.default,{ref:e.id===h?o:null,href:T.workflowService.getWorkflowUrl(e.id,i,n),className:(0,E.cn)("cursor-pointer flex justify-between rounded-lg mb-1",e.id===h&&"bg-accent"),children:[e.plan.name||"Untitled Notebook",e.id===h&&(0,t.jsx)(w.Check,{className:"size-4 ml-2"})]})},e.id))})]})]})]})]})}e.s([],224086),e.i(224086);var A=e.i(911899),P=e.i(978605);let[I,R]=(0,e.i(532592).createContext)({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),F=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getAreaProps(),e);return(0,t.jsx)(P.ark.div,{...r,ref:a})});F.displayName="EditableArea";let O=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getCancelTriggerProps(),e);return(0,t.jsx)(P.ark.button,{...r,ref:a})});O.displayName="EditableCancelTrigger";let M=e=>e.children(R()),D=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getControlProps(),e);return(0,t.jsx)(P.ark.div,{...r,ref:a})});D.displayName="EditableControl";let L=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getEditTriggerProps(),e);return(0,t.jsx)(P.ark.button,{...r,ref:a})});L.displayName="EditableEditTrigger";var U=e.i(220668);let V=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getInputProps(),e),i=(0,U.useFieldContext)();return(0,t.jsx)(P.ark.input,{"aria-describedby":i?.ariaDescribedby,...r,ref:a})});V.displayName="EditableInput";let z=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getLabelProps(),e);return(0,t.jsx)(P.ark.label,{...r,ref:a})});z.displayName="EditableLabel";let G=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getPreviewProps(),e);return(0,t.jsx)(P.ark.span,{...r,ref:a})});G.displayName="EditablePreview";var B=e.i(287942),$=e.i(956364),Q=e.i(750377),q=e.i(712266),W=e.i(978445),K=e.i(118991),H=(0,$.createAnatomy)("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control").build(),J=e=>e.ids?.preview??`editable:${e.id}:preview`,X=e=>e.ids?.input??`editable:${e.id}:input`,Y=e=>e.ids?.submitTrigger??`editable:${e.id}:submit`,Z=e=>e.ids?.cancelTrigger??`editable:${e.id}:cancel`,ee=e=>e.ids?.editTrigger??`editable:${e.id}:edit`,et=e=>e.getById(X(e)),ea=(0,A.createMachine)({props:({props:e})=>({activationMode:"focus",submitMode:"both",defaultValue:"",selectOnFocus:!0,...e,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...e.translations}}),initialState:({prop:e})=>e("edit")||e("defaultEdit")?"edit":"preview",entry:["focusInputIfNeeded"],context:({bindable:e,prop:t})=>({value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange:e=>t("onValueChange")?.({value:e})})),previousValue:e(()=>({defaultValue:""}))}),watch({track:e,action:t,context:a,prop:s}){e([()=>a.get("value")],()=>{t(["syncInputValue"])}),e([()=>s("edit")],()=>{t(["toggleEditing"])})},computed:{submitOnEnter({prop:e}){let t=e("submitMode");return"both"===t||"enter"===t},submitOnBlur({prop:e}){let t=e("submitMode");return"both"===t||"blur"===t},isInteractive:({prop:e})=>!(e("disabled")||e("readOnly"))},on:{"VALUE.SET":{actions:["setValue"]}},states:{preview:{entry:["blurInput"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{effects:["trackInteractOutside"],entry:["syncInputValue"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}},implementations:{guards:{isEditControlled:({prop:e})=>void 0!=e("edit"),isSubmitEvent:({event:e})=>e.previousEvent?.type==="SUBMIT"},effects:{trackInteractOutside:({send:e,scope:t,prop:a,computed:s})=>(0,q.trackInteractOutside)(et(t),{exclude:e=>[t.getById(Z(t)),t.getById(Y(t))].some(t=>(0,Q.contains)(t,e)),onFocusOutside:a("onFocusOutside"),onPointerDownOutside:a("onPointerDownOutside"),onInteractOutside(t){if(a("onInteractOutside")?.(t),t.defaultPrevented)return;let{focusable:r}=t.detail;e({type:s("submitOnBlur")?"SUBMIT":"CANCEL",src:"interact-outside",focusable:r})}})},actions:{restoreFocus({event:e,scope:t,prop:a}){e.focusable||(0,Q.raf)(()=>{let e=a("finalFocusEl")?.()??t.getById(ee(t));e?.focus({preventScroll:!0})})},clearValue({context:e}){e.set("value","")},focusInputIfNeeded({action:e,prop:t}){(t("edit")||t("defaultEdit"))&&e(["focusInput"])},focusInput({scope:e,prop:t}){(0,Q.raf)(()=>{let a=et(e);a&&(t("selectOnFocus")?a.select():a.focus({preventScroll:!0}))})},invokeOnCancel({prop:e,context:t}){let a=t.get("previousValue");e("onValueRevert")?.({value:a})},invokeOnSubmit({prop:e,context:t}){let a=t.get("value");e("onValueCommit")?.({value:a})},invokeOnEdit({prop:e}){e("onEditChange")?.({edit:!0})},invokeOnPreview({prop:e}){e("onEditChange")?.({edit:!1})},toggleEditing({prop:e,send:t,event:a}){t({type:e("edit")?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:a})},syncInputValue({context:e,scope:t}){let a=et(t);a&&(0,Q.setElementValue)(a,e.get("value"))},setValue({context:e,prop:t,event:a}){let s=t("maxLength"),r=null!=s?a.value.slice(0,s):a.value;e.set("value",r)},setPreviousValue({context:e}){e.set("previousValue",e.get("value"))},revertValue({context:e}){let t=e.get("previousValue");t&&e.set("value",t)},blurInput({scope:e}){et(e)?.blur()}}}}),es=(0,W.createProps)()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);(0,K.createSplitProps)(es);var er=e.i(204299),ei=e.i(7652),en=e.i(962288);let el=(0,B.createSplitProps)(),eo=(0,a.forwardRef)((e,s)=>{let[r,i]=el(e,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),n=(e=>{let t=(0,a.useId)(),{getRootNode:s}=(0,ei.useEnvironmentContext)(),{dir:r}=(0,en.useLocaleContext)(),i=(0,U.useFieldContext)(),n={id:t,ids:{label:i?.ids.label,input:i?.ids.control},dir:r,disabled:i?.disabled,invalid:i?.invalid,readOnly:i?.readOnly,required:i?.required,getRootNode:s,...e};return function(e,t){let{state:a,context:s,send:r,prop:i,scope:n,computed:l}=e,o=!!i("disabled"),d=l("isInteractive"),c=!!i("readOnly"),u=!!i("required"),m=!!i("invalid"),h=!!i("autoResize"),p=i("translations"),x=a.matches("edit"),f=i("placeholder"),g="string"==typeof f?{edit:f,preview:f}:f,v=s.get("value"),b=""===v.trim(),j=b?g?.preview??"":v;return{editing:x,empty:b,value:v,valueText:j,setValue(e){r({type:"VALUE.SET",value:e,src:"setValue"})},clearValue(){r({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){d&&r({type:"EDIT"})},cancel(){d&&r({type:"CANCEL"})},submit(){d&&r({type:"SUBMIT"})},getRootProps:()=>t.element({...H.root.attrs,id:n.ids?.root??`editable:${n.id}`,dir:i("dir")}),getAreaProps:()=>t.element({...H.area.attrs,id:n.ids?.area??`editable:${n.id}:area`,dir:i("dir"),style:h?{display:"inline-grid"}:void 0,"data-focus":(0,Q.dataAttr)(x),"data-disabled":(0,Q.dataAttr)(o),"data-placeholder-shown":(0,Q.dataAttr)(b)}),getLabelProps:()=>t.label({...H.label.attrs,id:n.ids?.label??`editable:${n.id}:label`,dir:i("dir"),htmlFor:X(n),"data-focus":(0,Q.dataAttr)(x),"data-invalid":(0,Q.dataAttr)(m),"data-required":(0,Q.dataAttr)(u),onClick(){if(x)return;let e=n.getById(J(n));e?.focus({preventScroll:!0})}}),getInputProps:()=>t.input({...H.input.attrs,dir:i("dir"),"aria-label":p?.input,name:i("name"),form:i("form"),id:X(n),hidden:h?void 0:!x,placeholder:g?.edit,maxLength:i("maxLength"),required:i("required"),disabled:o,"data-disabled":(0,Q.dataAttr)(o),readOnly:c,"data-readonly":(0,Q.dataAttr)(c),"aria-invalid":(0,Q.ariaAttr)(m),"data-invalid":(0,Q.dataAttr)(m),"data-autoresize":(0,Q.dataAttr)(h),defaultValue:v,size:h?1:void 0,onChange(e){r({type:"VALUE.SET",src:"input.change",value:e.currentTarget.value})},onKeyDown(e){if(e.defaultPrevented||(0,Q.isComposingEvent)(e))return;let t={Escape(){r({type:"CANCEL"}),e.preventDefault()},Enter(e){if(!l("submitOnEnter"))return;let{localName:t}=e.currentTarget;if("textarea"===t){if(!((0,Q.isApple)()?e.metaKey:e.ctrlKey))return;r({type:"SUBMIT",src:"keydown.enter"});return}"input"!==t||e.shiftKey||e.metaKey||(r({type:"SUBMIT",src:"keydown.enter"}),e.preventDefault())}}[e.key];t&&t(e)},style:h?{gridArea:"1 / 1 / auto / auto",visibility:x?void 0:"hidden"}:void 0}),getPreviewProps:()=>t.element({id:J(n),...H.preview.attrs,dir:i("dir"),"data-placeholder-shown":(0,Q.dataAttr)(b),"aria-readonly":(0,Q.ariaAttr)(c),"data-readonly":(0,Q.dataAttr)(o),"data-disabled":(0,Q.dataAttr)(o),"aria-disabled":(0,Q.ariaAttr)(o),"aria-invalid":(0,Q.ariaAttr)(m),"data-invalid":(0,Q.dataAttr)(m),"aria-label":p?.edit,"data-autoresize":(0,Q.dataAttr)(h),children:j,hidden:h?void 0:x,tabIndex:d?0:void 0,onClick(){d&&"click"===i("activationMode")&&r({type:"EDIT",src:"click"})},onFocus(){d&&"focus"===i("activationMode")&&r({type:"EDIT",src:"focus"})},onDoubleClick(e){e.defaultPrevented||!d||"dblclick"===i("activationMode")&&r({type:"EDIT",src:"dblclick"})},style:h?{whiteSpace:"pre",gridArea:"1 / 1 / auto / auto",visibility:x?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0}),getEditTriggerProps:()=>t.button({...H.editTrigger.attrs,id:ee(n),dir:i("dir"),"aria-label":p?.edit,hidden:x,type:"button",disabled:o,onClick(e){e.defaultPrevented||d&&r({type:"EDIT",src:"edit.click"})}}),getControlProps:()=>t.element({id:n.ids?.control??`editable:${n.id}:control`,...H.control.attrs,dir:i("dir")}),getSubmitTriggerProps:()=>t.button({...H.submitTrigger.attrs,dir:i("dir"),id:Y(n),"aria-label":p?.submit,hidden:!x,disabled:o,type:"button",onClick(e){e.defaultPrevented||d&&r({type:"SUBMIT",src:"submit.click"})}}),getCancelTriggerProps:()=>t.button({...H.cancelTrigger.attrs,dir:i("dir"),"aria-label":p?.cancel,id:Z(n),hidden:!x,type:"button",disabled:o,onClick(e){e.defaultPrevented||d&&r({type:"CANCEL",src:"cancel.click"})}})}}((0,er.useMachine)(ea,n),er.normalizeProps)})(r),l=(0,A.mergeProps)(n.getRootProps(),i);return(0,t.jsx)(I,{value:n,children:(0,t.jsx)(P.ark.div,{...l,ref:s})})});eo.displayName="EditableRoot";let ed=(0,B.createSplitProps)(),ec=(0,a.forwardRef)((e,a)=>{let[{value:s},r]=ed(e,["value"]),i=(0,A.mergeProps)(s.getRootProps(),r);return(0,t.jsx)(I,{value:s,children:(0,t.jsx)(P.ark.div,{...i,ref:a})})});ec.displayName="EditableRootProvider";let eu=(0,a.forwardRef)((e,a)=>{let s=R(),r=(0,A.mergeProps)(s.getSubmitTriggerProps(),e);return(0,t.jsx)(P.ark.button,{...r,ref:a})});eu.displayName="EditableSubmitTrigger",e.s(["Area",()=>F,"CancelTrigger",()=>O,"Context",()=>M,"Control",()=>D,"EditTrigger",()=>L,"Input",()=>V,"Label",()=>z,"Preview",()=>G,"Root",()=>eo,"RootProvider",()=>ec,"SubmitTrigger",()=>eu],649760);var em=e.i(649760),em=em,eh=e.i(602246);let ep=({crumb:e,finalCrumb:a})=>{let{mutateAsync:s}=(0,p.useUpdateWorkflowPlan)({workflowId:e.id}),{data:r}=(0,p.useWorkflowQuery)({workflowId:e.id}),i=(0,b.useQueryClient)(),n=async e=>{e.value&&await s({workflowPlan:{...r.plan,name:e.value.trim()}}),await i.invalidateQueries({queryKey:r.is_template?(0,C.getListWorkflowsQueryKey)({type:"templates"}):["workflows/runs",r.parent_id],exact:!1})};return(0,t.jsx)(em.Root,{activationMode:"click",className:"max-w-[350px]",placeholder:"Untitled Workflow",defaultValue:e.name,autoResize:!0,value:r?.plan?.name,onValueChange:t=>{r&&i.setQueryData((0,eh.getWorkflowQueryKey)(e.id),e=>({...e,plan:{...e.plan,name:t.value}}))},onValueCommit:n,children:(0,t.jsx)(em.Context,{children:({editing:e})=>(0,t.jsxs)(em.Area,{className:(0,E.cn)("border border-transparent text-muted-foreground",e&&"px-3 bg-background rounded-lg border border-input",a&&" text-foreground"),children:[(0,t.jsx)(em.Input,{className:"p-0 border-0 w-[115%] bg-transparent focus-visible:ring-0 focus:ring-0 focus:outline-none !text-sm"}),(0,t.jsx)(em.Preview,{className:"flex items-center text-sm"})]})})})},ex=({path:e})=>(0,t.jsx)("div",{className:"flex flex-row items-center justify-center w-full",children:e.map((s,r)=>{let i=r===e.length-1;return(0,t.jsxs)(a.Fragment,{children:[s.href?(0,t.jsx)(c.default,{href:s.href||"",className:"flex items-end text-muted-foreground justify-between py-1 text-sm/tight p-0 gap-1 font-normal rounded-lg",children:(0,t.jsx)("span",{className:"whitespace-nowrap truncate max-w-[200px]",children:s.name})}):i?(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(v.default,{workflowId:s.id,children:(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{className:"flex h-full gap-1 text-foreground text-sm/tight font-normal hover:bg-message px-0 py-1 ring-0",variant:"ghost",children:(0,t.jsx)("span",{className:"whitespace-nowrap truncate max-w-[200px]",children:s.name})})})}),(0,t.jsx)(g.TooltipContent,{children:"Edit details"})]}):(0,t.jsx)(ep,{crumb:s,finalCrumb:i}),i&&(0,t.jsx)(S,{}),!i&&(0,t.jsx)(x,{className:"w-4 h-3 -rotate-12 text-muted-foreground"})]},s.id)})});var ef=e.i(367944),eg=e.i(915492),ev=e.i(616525),eb=e.i(394073),ej=e.i(620949);let ew=(e,t,a)=>{let s="";return t&&(s=`/team/${t}`),a&&t&&(s=`/team/${t}/group/${a}`),s+="/notebooks",e&&(s+=`/${e}`),s};e.i(971804);var ey=e.i(511108),eN=e.i(62870),eC=e.i(51509),ek=e.i(314141),e_=e.i(556703);let eE=function(){let e,{toolPreferences:s,setToolPreferences:r,conversations:i,activeConversationId:n,setConversations:l}=(0,ef.useChatContext)(),{handleChangeAccelerator:o}=(0,ev.useUserContext)(),{data:d,isLoading:c}=(0,ej.useUserInformation)();d?.hardware_spec&&(e="GPU"===d.hardware_spec?"GPU":null);let u=(0,ej.useUpdateUserPreferences)(),[h,p]=(0,a.useState)(e||d?.preferences?.default_kernel||"Python"),[x,v]=(0,a.useState)(!1),b=(0,a.useCallback)(()=>{if(d)if(n){if(i?.[n]&&i[n]?.tool_preferences!==void 0){r(i[n].tool_preferences);let e=i[n]?.tool_preferences;e?.minimal_env?p("minimal_env"):p(e?.use_r_kernel?"R":"Python")}}else{let e=d.preferences?.default_kernel,t=new URLSearchParams(window.location.search).get("workflow_kernel");"r"===t?e="R":"python"===t&&(e="Python"),"R"===e?(r(e=>({...e,use_r_kernel:!0,minimal_env:!1})),p(e)):"minimal_env"===e?(r(e=>({...e,use_r_kernel:!1,minimal_env:!0})),p("minimal_env")):(r(e=>({...e,use_r_kernel:!1,minimal_env:!1})),p("Python"))}},[d,i,n,r]);(0,a.useEffect)(()=>{try{b()}catch(e){console.error("Unable to update kernel",e)}},[b]);let{patchConversation:j}=(0,ey.useChatAPI)(),w=async e=>{let t="R"===e,a="minimal_env"===e;m.default.capture("tool_selection",{toolName:"use_r_kernel",checked:t,useMinimalEnv:a});let o={...s,use_r_kernel:t,minimal_env:a};r(o),n&&(l({...i,[n]:{...i[n],tool_preferences:o}}),await j({conversationId:n,toolPreferences:o})),await u.mutateAsync({default_kernel:e,use_r_kernel:t,minimal_env:a})},y=async e=>{v(!0),m.default.capture("kernel_select",{model:e,from:h}),"GPU"===e?(p("Python"),await o("GPU")):"minimal_env"===e?(p("minimal_env"),await o(null),await w("minimal_env")):(p(e),await o(null),await w(e)),v(!1)};return(0,t.jsxs)(eN.Select,{value:e||h,defaultValue:"Python",onValueChange:y,children:[(0,t.jsxs)(g.Tooltip,{delayDuration:250,children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{size:"icon",variant:"ghost",className:"gap-2 p-0 size-8 items-center justify-center",asChild:!0,children:(0,t.jsx)(eN.SelectTrigger,{"data-cy":"runtime-selector",disabled:x||c,noIndicator:!0,children:(0,t.jsx)(eN.SelectValue,{asChild:!0,children:(0,t.jsx)("div",{className:"flex flex-row min-w-fit",children:x?(0,t.jsx)(N.Loader2,{className:"size-3.5 animate-spin"}):"Python"===h||"minimal_env"===h?(0,t.jsx)(ek.default,{className:"w-3.5 h-3.5"}):"R"===h?(0,t.jsx)(e_.default,{className:"w-3.5 h-3.5"}):"GPU"===h?(0,t.jsx)(eC.default,{className:"w-3.5 h-3.5"}):null})})})})}),(0,t.jsx)(g.TooltipContent,{children:"Change code language"})]}),(0,t.jsx)(eN.SelectContent,{children:(0,t.jsxs)(eN.SelectGroup,{className:"flex flex-col justify-start items-start",children:[(0,t.jsx)(eN.SelectLabel,{className:"text-xs",children:"Runtimes"}),(0,t.jsx)(eN.SelectItem,{value:"Python",className:"text-xs w-full","data-cy":"runtime-python",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ek.default,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"Python"})]})},"Python"),(0,t.jsx)(eN.SelectItem,{value:"R",className:"text-xs","data-cy":"runtime-R",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e_.default,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"R"})]})},"R"),eb.FEATURE_FLAGS.GPU_ALLOWED&&(0,t.jsx)(eN.SelectItem,{value:"GPU",className:"text-xs","data-cy":"runtime-GPU",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eC.default,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"GPU"}),(0,t.jsx)("span",{className:"font-semibold text-primary",children:"(LIMITED)"})]})},"GPU"),eb.FEATURE_FLAGS.SIMPLE_PYTHON_ENV&&(0,t.jsx)(eN.SelectItem,{value:"minimal_env",className:"text-xs","data-cy":"runtime-lean-python",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ek.default,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{children:"Lean Python"})]})},"minimal_env")]})})]})};var eT=e.i(86585),eS=e.i(503116),eA=e.i(846696);function eP({className:e=""}){let a=(0,u.useRouter)(),{activeConversationId:s}=(0,ef.useChatContext)(),{mutate:r,isPending:i}=(0,C.useConvertConversationToNotebookWithSchedule)();return(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{type:"button",variant:"ghost",size:"default",onClick:()=>{m.default.capture("notebook:schedule:chat_cta_clicked",{source:"chat-top-bar"}),r(s,{onSuccess:e=>{e?a.push(`/notebooks/${e}?schedule=true`):eA.toast.error("Failed to set up schedule. Please try again.")},onError:e=>{console.error("Failed to set up schedule:",e),eA.toast.error("Failed to set up schedule. Please try again.")}})},disabled:i,className:(0,E.cn)("gap-1 h-8",e,"chat-top-bar-show"===e?"flex @[900px]/chat-top-bar:hidden h-8 px-2 w-full gap-3 items-center justify-start":"hidden @[900px]/chat-top-bar:flex"),children:[(0,t.jsx)(eS.Clock,{className:"w-4 h-4"}),"chat-top-bar-show"===e&&(0,t.jsx)("span",{className:"text-start text-xs font-normal",children:"Schedule notebook"})]})}),(0,t.jsx)(g.TooltipContent,{children:"Schedule this to run daily or weekly"})]})}var eI=e.i(972520);let eR=(0,n.default)("slack",[["rect",{width:"3",height:"8",x:"13",y:"2",rx:"1.5",key:"diqz80"}],["path",{d:"M19 8.5V10h1.5A1.5 1.5 0 1 0 19 8.5",key:"183iwg"}],["rect",{width:"3",height:"8",x:"8",y:"14",rx:"1.5",key:"hqg7r1"}],["path",{d:"M5 15.5V14H3.5A1.5 1.5 0 1 0 5 15.5",key:"76g71w"}],["rect",{width:"8",height:"3",x:"14",y:"13",rx:"1.5",key:"1kmz0a"}],["path",{d:"M15.5 19H14v1.5a1.5 1.5 0 1 0 1.5-1.5",key:"jc4sz0"}],["rect",{width:"8",height:"3",x:"2",y:"8",rx:"1.5",key:"1omvl4"}],["path",{d:"M8.5 5H10V3.5A1.5 1.5 0 1 0 8.5 5",key:"16f3cl"}]]);var eF=e.i(264082),eO=e.i(630374);let eM=(0,d.default)(()=>e.A(569900),{loadableGenerated:{modules:[800389]},ssr:!1});function eD({className:e=""}){let{activeConversationId:s}=(0,ef.useChatContext)(),{continueChatInSlack:r}=(0,eF.useAuthenticatedAPIs)(),[i,n]=(0,a.useState)(!1),[l,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[p,x]=(0,a.useState)(!1),v=async()=>{x(!0);try{let e=await r({activeConversationId:s,channelId:l,channelName:d});if(e?.channel_id&&e?.thread_ts){let t=`slack://channel?id=${e.channel_id}&message=${e.thread_ts}`;h(t),m.default.capture("chat:slack:continue_in_slack_message_created",{channel_id:e.channel_id})}}finally{x(!1)}};return(0,t.jsxs)("div",{className:`hidden @[900px]/chat-top-bar:block ${e}`,children:[(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{type:"button",variant:"ghost",size:"default",onClick:()=>{m.default.capture("chat:slack:continue_in_slack_clicked",{source:"chat-top-bar"}),n(!0)},className:(0,E.cn)("gap-1 h-8","chat-top-bar-show"===e&&"h-8 px-2 w-full gap-3 items-center justify-start"),children:[(0,t.jsx)(eR,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"chat-top-bar-show"===e?"text-xs font-normal":"",children:"Continue in Slack"})]})}),(0,t.jsx)(g.TooltipContent,{children:"Continue this conversation in Slack"})]}),(0,t.jsx)(eO.Dialog,{open:i,onOpenChange:n,children:(0,t.jsxs)(eO.DialogContent,{children:[(0,t.jsx)(eO.DialogHeader,{children:(0,t.jsx)(eO.DialogTitle,{children:"Continue this conversation in your Slack"})}),!u&&(0,t.jsx)(eM,{channelId:l,channelName:d,onChannelChange:(e,t)=>{o(e),c(t)},disabled:!1,showImage:!0,placeholderForNoChannel:"Select a Slack channel",placeholderForNoIntegration:"Chat with Julius directly in Slack and get data insights in seconds"}),!u&&l&&(0,t.jsx)(f.Button,{onClick:v,disabled:p,children:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Loader2,{className:"mr-2 size-4 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:["Send to Slack",(0,t.jsx)(eI.ArrowRight,{className:"ml-2 size-4"})]})}),u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(f.Button,{disabled:!0,className:"gap-2",children:["Moved to Slack ",(0,t.jsx)(w.Check,{className:"size-4"})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Reply to the thread in"," ",(0,t.jsxs)("button",{onClick:()=>{u&&window.open(u,"_blank")},className:"font-medium text-primary hover:underline",children:["#",d]})," ","to continue chatting with Julius there."]})]})]})})]})}var eL=e.i(779334);function eU(){let[e,s]=(0,a.useState)(!1),{activeConversationId:r}=(0,ef.useChatContext)(),i=async()=>{m.default.capture("report:generate",{source:"chat-top-bar"}),s(!0),window.open(`/reports?id=${r}`,"_blank"),s(!1)};return(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{type:"button",variant:"ghost",size:"icon",className:"chat-top-bar-hidden",onClick:i,disabled:e,children:(0,t.jsx)(eL.Newspaper,{className:"w-4 h-4"})})}),(0,t.jsx)(g.TooltipContent,{children:"Generate Analysis Report"})]})}var eV=e.i(844343),ez=e.i(88653),eG=e.i(824511),eB=e.i(364573),e$=e.i(500),eQ=e.i(248256),eq=e.i(107233),eW=e.i(37727),eK=e.i(52563),eH=e.i(954616),eJ=e.i(266027);let eX=async({conversationId:e,accessToken:t})=>{let a=await (0,E.customFetch)(`${eb.BASE_API}/api/chat/conversations/${e}/sharing`,{headers:{Authorization:`Bearer ${t}`,"X-Intentional-Action":"true"}});if(!a.ok)throw await a.json();return a.json()},eY=async({conversationId:e,user_email:t,accessToken:a})=>{let s=await (0,E.customFetch)(`${eb.BASE_API}/api/chat/conversations/${e}/sharing`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json","X-Intentional-Action":"true"},method:"POST",body:JSON.stringify({user_email:t})});if(!s.ok)throw await s.json();return s.json()},eZ=async({conversationId:e,user_email:t,accessToken:a})=>{let s=await (0,E.customFetch)(`${eb.BASE_API}/api/chat/conversation/${e}/sharing`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json","X-Intentional-Action":"true"},method:"DELETE",body:JSON.stringify({user_email:t})});if(!s.ok)throw await s.json();return s.json()};var e0=e.i(796610),e1=e.i(23750),e5=e.i(319036),e2=e.i(664659),e4=e.i(655900),e3=e.i(562920);let e6=({teamId:e,teamName:s,conversationId:r})=>{let[i,n]=(0,a.useState)(!1),{data:l,isLoading:o}=(0,e3.useTeamGroups)(e),{data:d,isLoading:c}=(0,e3.useConversationGroupShares)(r),u=(0,e3.useShareConversationWithGroup)(),[h,p]=(0,a.useState)({});(0,a.useEffect)(()=>{d&&p(d.reduce((t,a)=>(a.team_id===e&&(t[a.group_id]=!0),t),{}))},[d,e]);let x=async(t,a)=>{try{t?m.default.capture("share_chat_with_group",{conversation_id:r,team_id:e,group_id:a}):m.default.capture("unshare_chat_with_group",{conversation_id:r,team_id:e,group_id:a}),await u.mutateAsync({conversationId:r,teamId:e,groupId:a,share:t}),p(e=>({...e,[a]:t})),t?eA.toast.success("Shared conversation with group"):eA.toast.success("Removed conversation from group")}catch(e){eA.toast.error("Failed to change group sharing setting"),p(e=>({...e,[a]:!t}))}};return o||c||!l?.length?null:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,t.jsx)("span",{className:"font-medium",children:s}),(0,t.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>n(!i),className:"h-8 w-8 p-0",children:i?(0,t.jsx)(e4.ChevronUp,{className:"h-4 w-4"}):(0,t.jsx)(e2.ChevronDown,{className:"h-4 w-4"})})]}),i&&(0,t.jsx)("div",{className:"flex flex-col gap-2 pl-4",children:l.map(e=>(0,t.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.name}),(0,t.jsx)(e5.Switch,{checked:h[e.id]||!1,onCheckedChange:t=>x(t,e.id)})]},e.id))})]})},e8=(0,d.default)(()=>e.A(651773),{loadableGenerated:{modules:[58220]},ssr:!1}),e7=({children:e})=>{let[s,r]=(0,a.useState)(!1),{activeConversationId:i,conversations:n,updateConversation:l,isOwner:o}=(0,ef.useChatContext)(),{changeConversationPrivacy:d,shareConversationWithTeam:c,getTeamsConversationIsSharedWith:u}=(0,ey.useChatAPI)(),[h,p]=(0,a.useState)(!1),{data:x}=(0,e0.useTeams)(),[v,j]=(0,a.useState)({}),[w,y]=(0,a.useState)(""),{data:N}=(e=>{let{getAccessTokenSilently:t,user:a,isAuthenticated:s}=(0,eK.useAuth0)();return(0,eJ.useQuery)({queryKey:["conversation_members",e],enabled:s&&!!a,queryFn:async()=>eX({conversationId:e,accessToken:await t()}),retry:3,refetchOnWindowFocus:!1})})(i),C=(()=>{let{getAccessTokenSilently:e}=(0,eK.useAuth0)(),t=(0,b.useQueryClient)();return(0,eH.useMutation)({mutationFn:async({conversationId:t,user_email:a})=>eY({conversationId:t,user_email:a,accessToken:await e()}),onMutate:async({conversationId:e,user_email:a})=>{await t.cancelQueries({queryKey:["conversation_members",e]});let s=t.getQueryData(["conversation_members",e]);return t.setQueryData(["conversation_members",e],t=>t?[...t,{id:`temp-${Date.now()}`,user_email:a,conversation_id:e,created_at:"",updated_at:"",role:"member"}]:t),{previousMembers:s}},onSuccess:(e,{conversationId:a})=>{t.setQueryData(["conversation_members",a],t=>t?t.map(t=>t.user_email===e.user_email?e:t):[e])},onError:(e,{conversationId:a},s)=>{s?.previousMembers&&t.setQueryData(["conversation_members",a],s.previousMembers)},onSettled:(e,a,{conversationId:s})=>{t.invalidateQueries({queryKey:["conversation_members",s]})}})})(),k=(()=>{let{getAccessTokenSilently:e}=(0,eK.useAuth0)(),t=(0,b.useQueryClient)();return(0,eH.useMutation)({mutationFn:async({conversationId:t,user_email:a})=>eZ({conversationId:t,user_email:a,accessToken:await e()}),onMutate:async({conversationId:e,user_email:a})=>{await t.cancelQueries({queryKey:["conversation_members",e]});let s=t.getQueryData(["conversation_members",e]);return t.setQueryData(["conversation_members",e],e=>e?e.filter(e=>e.user_email!==a):e),{previousMembers:s}},onError:(e,{conversationId:a},s)=>{s?.previousMembers&&t.setQueryData(["conversation_members",a],s.previousMembers)},onSettled:(e,a,{conversationId:s})=>{t.invalidateQueries({queryKey:["conversation_members",s]})}})})(),_=async()=>{let e=w.trim();if(e){if(N?.some(t=>t.user_email===e))return void eA.toast.error(`Conversation is already shared with ${e}`);try{await C.mutateAsync({conversationId:i,user_email:e}),y(""),eA.toast.success("Successfully shared conversation")}catch(e){console.error("Failed to share:",e),eA.toast.error("Failed to share conversation")}}},T=async e=>{try{await k.mutateAsync({conversationId:i,user_email:e}),eA.toast.success("Successfully removed access")}catch(e){console.error("Failed to remove access:",e),eA.toast.error("Failed to remove access")}},S=eb.FEATURE_FLAGS.IS_WEBVIEW?`https://julius.ai/chat?id=${i}`:`${window.location.protocol}//${window.location.host}/chat?id=${i}`,A=(0,a.useMemo)(()=>n&&i?n[i]:void 0,[n,i]);(0,a.useEffect)(()=>{if(!A||(p(A?.is_public||!1),!eb.FEATURE_FLAGS.TEAM_CHAT_PAGE||!x?.length||!i))return;let e=Object.fromEntries(x.map(e=>[e.id,!1]));(async()=>{try{let e=await u(i),t=Object.fromEntries(x.map(t=>[t.id,e.some(e=>e.team_id===t.id)]));j(t)}catch(t){console.error("Failed to fetch teams sharing status:",t),j(e)}})()},[A,x,i,u]);let P=()=>{(0,eV.default)(S),r(!0),setTimeout(()=>r(!1),5e3)},I=async e=>{try{p(e);let t=await d(i,e);e?(P(),eA.toast.success("Link copied. Your thread is now public!")):eA.toast.success("Your thread is now private."),l(i,{is_public:t.is_public})}catch(e){eA.toast.error("Failed to change thread setting"),p(A?.is_public||!1)}},R=async(e,t)=>{try{e?m.default.capture("share_chat_with_team",{conversation_id:i,team_id:t}):m.default.capture("unshare_chat_with_team",{conversation_id:i,team_id:t}),await c(i,t,e),j(a=>({...a,[t]:e})),e?eA.toast.success("Shared conversation thread to team"):eA.toast.success("Removed conversation from team")}catch(a){eA.toast.error("Failed to change team sharing setting"),j(a=>({...a,[t]:!e}))}};return(0,t.jsxs)(eO.Dialog,{children:[(0,t.jsx)(eO.DialogTrigger,{asChild:!0,children:e}),(0,t.jsxs)(eO.DialogContent,{onClick:e=>e.stopPropagation(),className:(0,E.cn)("flex overflow-hidden flex-col w-full sm:max-w-[512px] max-h-[635px] mobile-bottom-dialog","data-[state=open]:animate-slide-in-bottom data-[state=closed]:animate-slide-out-bottom","sm:data-[state=open]:animate-none sm:data-[state=closed]:animate-none","rounded-xl p-0 py-6 gap-0"),children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 px-6 pb-3",children:[(0,t.jsxs)(eO.DialogTitle,{className:"font-sans font-light text-2xl",children:['Share "',A?.name||"New Thread",'"']}),o&&(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(e1.Input,{size:"sm",value:w,placeholder:"Add people",onChange:e=>{y(e.target.value)}}),(0,t.jsx)(f.Button,{size:"sm",type:"submit",onClick:()=>_(),disabled:C?.isPending,children:C?.isPending?(0,t.jsx)("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full"}):(0,t.jsx)(eq.Plus,{size:18})})]})]}),(0,t.jsxs)("div",{className:"flex flex-col flex-1 overflow-auto gap-6",children:[N&&N?.length>0&&(0,t.jsxs)("div",{className:"flex flex-col px-6 flex-1 gap-2 py-6",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h1",{children:"People"}),(0,t.jsx)("span",{className:"text-sm font-light",children:"Anyone can view"})]}),(0,t.jsx)("div",{className:"flex flex-col max-h-[512px] overflow-auto",children:N?.slice()?.sort((e,t)=>"owner"===e.role&&"owner"!==t.role?-1:"owner"===t.role&&"owner"!==e.role?1:e.user_email.localeCompare(t.user_email))?.map(e=>(0,t.jsx)(e8,{role:e.role,title:e.user_email,children:"owner"!==e.role&&o&&(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{variant:"ghost",size:"icon",disabled:k?.isPending,onClick:()=>T(e?.user_email),children:(0,t.jsx)(eW.X,{size:16})})}),(0,t.jsx)(g.TooltipContent,{children:"Remove access"})]})},e?.id))})]}),o&&x?.length===0?(0,t.jsxs)("div",{className:"flex flex-col p-3 rounded-lg bg-message border border-border mx-6",children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-1",children:"Want to collaborate on threads?"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Create a team to share threads with your colleagues"}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(f.Button,{size:"sm",variant:"outline",className:"w-fit",onClick:()=>window.location.href="/settings/teams",children:"Get started"})})]}):x?.length>0&&(0,t.jsxs)(t.Fragment,{children:[eb.FEATURE_FLAGS.TEAM_CHAT_PAGE&&(0,t.jsxs)("div",{className:"flex flex-col px-6 flex-1 gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h1",{children:"Teams"}),(0,t.jsx)("span",{className:"text-sm font-light",children:"Anyone on the team can view"})]}),(0,t.jsx)("div",{className:"flex flex-col max-h-[512px] overflow-auto",children:x?.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg hover:bg-message",children:[(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsx)("span",{className:"text-sm font-medium",children:e.team_name})}),(0,t.jsx)(e5.Switch,{checked:v[e.id]||!1,onCheckedChange:t=>R(t,e.id)})]},e.id))})]}),eb.FEATURE_FLAGS.TEAM_GROUPS&&(0,t.jsxs)("div",{className:"flex flex-col px-6 flex-1 gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h1",{children:"Team Groups"}),(0,t.jsx)("span",{className:"text-sm font-light",children:"Anyone on the group in the team can view"})]}),(0,t.jsx)("div",{className:"flex flex-col max-h-[512px] overflow-auto",children:x?.map(e=>(0,t.jsx)(e6,{teamId:e.id,teamName:e.team_name,conversationId:i},e.id))})]})]}),o&&(0,t.jsx)("div",{className:"flex flex-col space-y-3",children:(0,t.jsxs)("div",{className:"flex flex-col bg-sidesecondary px-3 py-2 rounded-xl mx-6 gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-4 justify-between items-center",children:[(0,t.jsx)("div",{className:"flex flex-col gap-2 items-center",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h1",{children:"Public access"}),(0,t.jsx)("span",{className:"text-sm font-light",children:"Anyone with the link can view"})]})}),(0,t.jsx)(e5.Switch,{checked:h,onCheckedChange:I})]}),(0,t.jsx)(ez.AnimatePresence,{children:A?.is_public&&(0,t.jsxs)(eG.m.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"w-full flex relative flex-row overflow-hidden border border-input rounded-xl bg-background",children:[(0,t.jsx)(e1.Input,{id:"link",defaultValue:S,readOnly:!0,className:"pr-10 pl-3 w-full h-9 font-mono font-medium border-none focus:ring-offset-0 focus:outline-none focus-visible:ring-0 focus-visible:outline-none",value:void 0}),(0,t.jsx)(f.Button,{"data-event":"share_link_copy",variant:"ghost",onClick:P,className:`absolute right-0 top-1/2 transform -translate-y-1/2 text-primary hover:text-primary ${s&&"bg-accent"}`,size:"sm",children:s?(0,t.jsx)(eB.ClipboardCheckIcon,{className:"w-4 h-4 text-green-500"}):(0,t.jsx)(e$.ClipboardCopyIcon,{className:"w-4 h-4"})})]})})]})})]}),(0,t.jsxs)("div",{className:"flex justify-between px-6 mt-3",children:[o&&(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{variant:"ghost",onClick:P,children:[(0,t.jsx)(eQ.Globe,{size:14,strokeWidth:2,className:"mr-2"}),(0,t.jsx)("span",{className:"whitespace-nowrap",children:"Copy Link"})]})}),(0,t.jsx)(g.TooltipContent,{children:"Copy share link"})]}),(0,t.jsx)(eO.DialogClose,{asChild:!0,children:(0,t.jsx)(f.Button,{size:"sm",className:"px-6",children:"Done"})})]})]})]})},e9=(0,n.default)("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]]);var te=e.i(440160),tt=e.i(591289),ta=e.i(866195),ts=e.i(483202),tr=e.i(463415),ti=e.i(990942);let tn=({children:e})=>{let[s,r]=(0,a.useState)(!1),[i,n]=(0,a.useState)(!1),{debugMode:l,setDebugMode:o,isCaesar:d}=(0,ev.useUserContext)(),{handleConvertToWorkflow:c}=(0,eF.useAuthenticatedAPIs)(),{activeConversationId:h,memoizedGenerateDocx:p,memoizedGeneratePdf:x}=(0,ef.useChatContext)(),{downloadConversationNotebook:f,downloadSessionSnapshot:g}=(0,ts.useUserAPI)(),{getAccessTokenSilently:v}=(0,eK.useAuth0)(),b=(0,u.usePathname)().includes("/notebooks"),j=async()=>{let e=await v();eA.toast.promise(x(h,e),{loading:"Generating document...",success:()=>"Document exported successfully!",error:e=>`Export failed: ${e.message}`})},w=async()=>{let e=await v();m.default.capture("export:docx"),eA.toast.promise(p(h,e),{loading:"Generating document...",success:()=>"Document exported successfully!",error:e=>`Export failed: ${e.message}`})},y=async()=>{r(!0),m.default.capture("workflow:convert:thread"),await c(h),r(!1)},N=async()=>{m.default.capture("report:generate",{source:"dropdown"}),n(!0),window.open(`/reports?id=${h}`,"_blank"),n(!1)};return(0,t.jsxs)(tr.DropdownMenu,{children:[(0,t.jsx)(tr.DropdownMenuTrigger,{asChild:!0,children:e}),(0,t.jsxs)(tr.DropdownMenuContent,{children:[h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(tr.DropdownMenuSub,{children:[(0,t.jsxs)(tr.DropdownMenuSubTrigger,{className:"flex gap-3 cursor-pointer items-center text-xs px-2",children:[(0,t.jsx)(te.Download,{className:"flex-shrink-0 w-4 h-4"}),"Download"]}),(0,t.jsxs)(tr.DropdownMenuSubContent,{children:[(0,t.jsx)(tr.DropdownMenuItem,{onClick:j,children:"Download as .pdf"}),(0,t.jsx)(tr.DropdownMenuItem,{onClick:w,children:"Download as .docx"}),(0,t.jsx)(tr.DropdownMenuItem,{onClick:()=>f(h),children:"Download as Jupyter Notebook"}),eb.FEATURE_FLAGS.EXPORT_SESSION&&(0,t.jsx)(tr.DropdownMenuItem,{onClick:()=>g(h),children:"Download as Session"})]})]}),eb.FEATURE_FLAGS.GENERATE_ANALYSIS_REPORT&&(0,t.jsxs)(tr.DropdownMenuItem,{className:"flex gap-3 cursor-pointer items-center",onClick:N,disabled:i,children:[(0,t.jsx)(eL.Newspaper,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-start",children:"Generate Analysis Report"})]}),d&&(0,t.jsxs)(tr.DropdownMenuItem,{className:"flex gap-3 cursor-pointer items-center",onClick:()=>{try{window.localStorage.setItem("julius-debug-mode",l?"true":"false"),o(e=>!e)}catch(e){}},children:[(0,t.jsx)(e9,{className:"flex-shrink-0 w-4 h-4"}),"Debug mode"]}),!b&&eb.FEATURE_FLAGS.CONVERT_CONVERSATION_TO_PLAN&&(0,t.jsxs)(tr.DropdownMenuItem,{className:"flex gap-3 cursor-pointer items-center",onClick:y,disabled:s,children:[(0,t.jsx)(ta.Notebook,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-start",children:"Convert to notebook"})]}),!b&&h&&(0,t.jsx)(eP,{className:"chat-top-bar-show"}),eb.FEATURE_FLAGS.CONTINUE_IN_SLACK&&h&&(0,t.jsx)(eD,{className:"chat-top-bar-show"})]}),!eb.FEATURE_FLAGS.IS_HBS&&(0,t.jsx)(ti.default,{className:"hidden sm:flex",children:(0,t.jsxs)(tr.DropdownMenuItem,{className:"flex gap-3 cursor-pointer items-center",children:[(0,t.jsx)(tt.MessageCircleQuestion,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-start",children:"Help"})]})})]})]})},tl=(0,d.default)(()=>e.A(364227),{loadableGenerated:{modules:[509381]},ssr:!1}),to=(0,d.default)(()=>e.A(891775).then(e=>e.ChatSettingsModal),{loadableGenerated:{modules:[314465]},ssr:!1}),td=(0,d.default)(()=>e.A(608738),{loadableGenerated:{modules:[782085]},ssr:!1}),tc=(0,d.default)(()=>e.A(819367),{loadableGenerated:{modules:[24018]},ssr:!1}),tu=(0,a.memo)(function({showMinimal:e=!1,enableSidebar:s=!0,workflowId:n,className:d,...m}){let[x,v]=(0,a.useState)(""),{activeConversationId:b,conversations:j,setActiveConversationId:w}=(0,ef.useChatContext)(),{isSidebarOpen:y,isRightSidebarOpen:N,setIsRightSidebarOpen:C}=(0,eg.useSidebarsContext)(),{data:k}=(0,p.useWorkflowQuery)({workflowId:n}),{observe:_,currentBreakpoint:T}=(0,h.default)({breakpoints:{showCrumb:1e3},updateOnBreakpointChange:!0}),{data:S,isLoading:A}=(0,ej.useUserSubscription)(),{breakpoint:P}=(0,ev.useUserContext)(),I=(0,u.usePathname)(),{teamId:R}=(0,u.useParams)(),F=I.includes("/models"),O=e?"search":j[b]?.chat_type,M=j[b]?.name,D=(0,a.useMemo)(()=>{let e=[{id:"notebooks",name:"Notebooks",href:ew(void 0,R),index:!0}];return k&&(k.parent_id&&e.push({id:k.parent_id,href:ew(k.parent_id,R),name:"showCrumb"===T?k.parent.plan?.name||"Untitled Notebook":"..."}),e.push({id:k.id,name:k.plan?.name||"Untitled Notebook"})),e},[T,R,k]);return(0,t.jsxs)("div",{ref:_,className:(0,E.cn)("justify-between items-center gap-2 w-full min-w-full sticky top-0 font-normal flex z-10 p-3 lg:px-3 lg:py-1.5 border-b @container/chat-top-bar",d),...m,children:[(0,t.jsxs)("div",{className:"flex gap-1 items-center",children:[("initial"===P||"xs"===P||"sm"===P||"md"===P)&&(0,t.jsx)(tl,{}),(0,t.jsx)(eT.ServerStatus,{}),(0,t.jsx)(eE,{})]}),(0,t.jsx)("div",{className:"hidden sm:flex h-full justify-center items-center overflow-hidden",children:k?(0,t.jsx)(ex,{path:D}):(0,t.jsx)(t.Fragment,{children:j[b]&&(0,t.jsx)("h1",{className:"font-medium text-md truncate w-full",children:M||"New Thread"})})}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(td,{}),(0,t.jsx)(tc,{workflow:k,children:(0,t.jsx)(f.Button,{size:"sm",variant:"outline",className:"gap-1.5",children:"Share"})})]}):b&&(0,t.jsx)(e7,{children:(0,t.jsx)(f.Button,{size:"sm",variant:"outline",className:"gap-1.5","data-intercom-target":"chat-share-button",children:"Share"})}),(0,t.jsxs)("div",{className:"flex flex-row items-center min-w-fit",children:[!eb.FEATURE_FLAGS.IS_HBS&&!y&&!A&&!S?.status&&(0,t.jsx)(tm,{}),!k&&b&&(0,t.jsx)(eP,{className:"chat-top-bar-hidden"}),eb.FEATURE_FLAGS.CONTINUE_IN_SLACK&&b&&(0,t.jsx)(eD,{className:"chat-top-bar-hidden"}),"search"!==O&&!F&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{size:"icon",type:"button","data-event":"personalize_conversation_settings",variant:"ghost",onClick:()=>v("chat_settings"),"data-cy":"top-bar-chat-settings-button",children:(0,t.jsx)(o.Settings,{className:"size-4"})})}),(0,t.jsx)(g.TooltipContent,{children:"Chat Settings"})]}),(0,t.jsx)(to,{modal:x,setModal:v}),b&&(0,t.jsx)(f.Button,{className:"md:hidden",variant:"ghost",size:"icon",onClick:()=>{w(null)},asChild:!0,children:(0,t.jsx)(c.default,{href:"/chat",children:(0,t.jsx)(i.MessageSquarePlus,{className:"size-4"})})})]}),b&&eb.FEATURE_FLAGS.GENERATE_ANALYSIS_REPORT&&(0,t.jsx)(eU,{}),(0,t.jsx)(tn,{children:(0,t.jsx)(f.Button,{type:"button",variant:"ghost",size:"icon",children:(0,t.jsx)(r.default,{className:"size-4"})})}),s&&(0,t.jsx)(f.Button,{variant:"ghost",size:"icon",className:"hidden lg:flex cursor-pointer",onClick:()=>C(!N),children:(0,t.jsx)(l,{className:"size-4"})})]})]})]})}),tm=({location:e="top_bar"})=>(0,t.jsxs)(g.Tooltip,{children:[(0,t.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(c.default,{href:"/settings",children:(0,t.jsx)(f.Button,{size:"sm",type:"button",variant:"outline",onClick:t=>{m.default.capture("upgrade_button_clicked",{location:e})},children:(0,t.jsx)(s.CircleFadingArrowUp,{className:"w-5 h-5"})})})}),(0,t.jsx)(g.TooltipContent,{children:"Upgrade"})]});e.s(["default",0,tu],532711)}]);

//# debugId=022b6b94-56ea-707b-5e1a-5ee2a705ab6b
//# sourceMappingURL=9d8a5da73cfa4955.js.map