;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5910ef93-83af-38b6-8656-54561595f5d0")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,215881,582164,282200,331184,e=>{"use strict";e.i(247167);var s=e.i(52563),t=e.i(647163);e.s(["useDebugAPI",0,()=>{let{getAccessTokenSilently:e}=(0,s.useAuth0)();return{troubleshootMessage:async s=>{let l=await e(),o=await (0,t.customFetch)(`https://api.julius.ai/evals/${s}/troubleshoot`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});return await o.json()}}}],215881);var l=e.i(843476),o=e.i(271645),i=e.i(88653),n=e.i(824511),a=e.i(643531),r=e.i(519943),r=r,c=e.i(14),d=e.i(761086),u=e.i(788699),m=e.i(790092),h=e.i(649582),f=e.i(570894),x=e.i(365582),p=e.i(400417),g=e.i(770703),b=e.i(618566),j=e.i(604570);e.i(971804);var v=e.i(511108),y=e.i(728231),w=e.i(367944),A=e.i(210677),_=e.i(394073),N=e.i(620949),k=e.i(785768),C=e.i(672215),S=e.i(223622),T=e.i(571930),I=e.i(373375);let E=(0,e.i(475254).default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var P=e.i(722038),M=e.i(107233),L=e.i(116019),D=e.i(846696),R=e.i(167881),O=e.i(753751),q=e.i(23750),F=e.i(59377);function $({categories:e,selectedValue:s,setSelectedValue:i,isMessageActionButton:n,setShowDetailMenu:r,content:c,messageId:d,className:u}){let[m,h]=(0,o.useState)(!1),[f,x]=(0,o.useState)(""),[p,g]=(0,o.useState)(!1),[b,j]=(0,o.useState)(!1),[v,w]=(0,o.useState)(null),A=(0,C.useSavePromptCategory)(),{data:_}=(0,C.useSavedUserPrompts)(),N=(0,C.useSavePrompt)();(0,o.useEffect)(()=>{g(!1),x("")},[m]);let k=e=>{i(e),n&&$(e,d),h(!1)},$=async(e,s)=>{s&&D.toast.promise(N.mutateAsync({content:c,category_id:e.id,message_id:s}),{loading:"Saving prompt...",success:"Prompt saved!",error:"Error saving prompt"})},z=d?_?.prompts?.find(e=>e?.message_id===d):void 0,U=async()=>{let s=f.trim();if(s)if(e.some(e=>e?.category?.toLowerCase()===s.toLowerCase()))D.toast.error("Folder already exists");else try{D.toast.promise(A.mutateAsync(s),{loading:"Creating folder...",success:"Folder created successfully",error:e=>e.message||"Failed to create folder"}),x(""),g(!1)}catch(e){console.error("Error creating folder:",e)}},B=Array.isArray(e)?e:[];return(0,l.jsx)("div",{className:(0,t.cn)("flex items-center",u),children:(0,l.jsxs)(F.Popover,{open:m,onOpenChange:h,children:[(0,l.jsxs)(y.Tooltip,{children:[(0,l.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,l.jsx)(F.PopoverTrigger,{asChild:!0,children:n?(0,l.jsx)("div",{className:"hidden sm:flex text-muted-foreground w-[28px] h-[28px] rounded-lg items-center justify-center hover:text-foreground hover:bg-accent cursor-pointer",children:(0,l.jsx)(T.Bookmark,{className:"w-[0.9rem] h-[0.9rem] hover:text-foreground cursor-pointer"})}):(0,l.jsxs)(R.Button,{variant:"outline",role:"combobox","aria-expanded":m,className:"w-full justify-between rounded-lg py-1 focus-within:ring-0 focus-within:outline-none focus:ring-0 focus:outline-none active:ring-0 active:outline-none !focus-visible:ring-0 !focus-visible:outline-none",children:[s?.category||"Favorites",(0,l.jsx)(I.ChevronLeft,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,l.jsx)(y.TooltipContent,{side:"bottom",children:"Save"})]}),(0,l.jsx)(F.PopoverContent,{className:"w-[190px] md:w-[250px] p-0 rounded-xl mx-2",children:(0,l.jsx)(O.Command,{className:"rounded-xl",shouldFilter:!1,children:z?(0,l.jsx)(O.CommandList,{className:"rounded-xl p-2",children:(0,l.jsxs)(O.CommandItem,{value:"You already saved this prompt.",disabled:!0,className:"rounded-xl",children:[(0,l.jsx)(S.Ban,{className:"mr-2 h-4 w-4"}),"You already saved this prompt."]})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"border-b",children:[(0,l.jsx)("h2",{className:"px-3 pt-2 text-md font-medium",children:"Save Prompt"}),(0,l.jsx)("p",{className:"px-3 pb-2 text-xs font-light text-muted-foreground",children:"Add this prompt to a folder"})]}),(0,l.jsxs)(O.CommandList,{className:"rounded-xl",children:[(0,l.jsx)(O.CommandEmpty,{children:"No folder found."}),(0,l.jsx)(O.CommandGroup,{className:"rounded-xl",children:B.map(e=>(0,l.jsxs)(O.CommandItem,{value:e?.category||"",onSelect:()=>k(e),disabled:!!z,className:"rounded-xl flex justify-between items-center cursor-pointer",onMouseEnter:()=>{w(e.id),j(!1)},children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(E,{className:"h-4 w-4 text-muted-foreground mx-2"}),e?.category||"Unnamed"]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(R.Button,{variant:v!==e.id||b?"outline":"default",size:"sm",className:"h-7 px-2 mr-2",onClick:s=>{s.stopPropagation(),k(e)},tabIndex:-1,children:(0,l.jsx)(M.Plus,{className:"h-4 w-4"})}),!n&&e?.id!==null&&e?.category!=="Favorites"&&r&&(0,l.jsx)(R.Button,{variant:"ghost",size:"xs",onClick:s=>{s.stopPropagation(),h(!1),r({detailMenu:"delete-category",id:e.id})},className:"px-2 self-end hover:text-red-500",tabIndex:-1,children:(0,l.jsx)(L.Trash,{className:"h-4 w-4"})})]})]},e?.id||"no-id"))})]}),(0,l.jsx)(O.CommandSeparator,{}),(0,l.jsx)(O.CommandGroup,{children:p?(0,l.jsxs)("div",{className:"flex items-center gap-1 py-0.5 px-2",children:[(0,l.jsx)(R.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 ml-2",onClick:()=>{g(!1),x("")},children:(0,l.jsx)(I.ChevronLeft,{className:"h-4 w-4"})}),(0,l.jsx)(q.Input,{value:f,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),U()):"Escape"===e.key&&(g(!1),x(""))},placeholder:"Enter name...",className:"h-8 focus:ring-0 focus-visible:ring-0 focus:outline-none focus-visible:outline-none",autoFocus:!0}),(0,l.jsx)(R.Button,{variant:"contrast",size:"sm",className:"h-8 mx-2 px-2",onClick:()=>{U()},children:(0,l.jsx)(a.Check,{className:"h-4 w-4"})})]}):(0,l.jsxs)(O.CommandItem,{onSelect:()=>g(!0),className:"rounded-xl cursor-pointer text-muted-foreground py-2",onMouseEnter:()=>{w(null),j(!0)},children:[(0,l.jsx)(P.FolderPlus,{className:"h-4 w-4 text-muted-foreground mx-2"}),"Create new folder"]})})]})})})]})})}function z({content:e,messageId:s}){let[t,i]=(0,o.useState)(null),{error:n}=(0,C.useSavedUserPrompts)(),{data:a,error:r}=(0,C.usePromptCategories)();return n||r?(0,l.jsx)("div",{className:"text-red-500",children:"An error occurred while fetching data."}):(0,l.jsx)($,{isMessageActionButton:!0,categories:a?.categories,selectedValue:t,setSelectedValue:i,content:e,messageId:s})}let U={hidden:{x:-100,opacity:0,filter:"blur(8px)"},visible:{x:0,opacity:1,filter:"blur(0px)"}},B={hidden:{x:-20,opacity:0},visible:{x:0,opacity:1}},H=({show:e,onDismiss:s,setModal:t})=>{let[r,c]=(0,o.useState)("calibrating");return(0,o.useEffect)(()=>{if(!e)return void c("calibrating");let t=setTimeout(()=>c("calibrated"),1e3),l=setTimeout(s,5e3);return()=>{clearTimeout(t),clearTimeout(l)}},[e,s]),(0,l.jsx)(i.AnimatePresence,{children:e&&(0,l.jsx)(n.m.div,{initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.3,ease:"easeOut"},variants:U,className:"text-muted-foreground text-xs flex items-center gap-1.5 ml-2 overflow-hidden",onClick:s,children:"calibrating"===r?(0,l.jsxs)("div",{className:"flex flex-row items-center gap-1 text-muted-secondary",children:["Calibrating to feedback...",(0,l.jsx)(d.Loader,{className:"w-3.5 h-3.5 animate-spin"})]}):(0,l.jsxs)(l.Fragment,{children:["Calibrated to feedback",(0,l.jsx)(a.Check,{className:"w-3.5 h-3.5"}),(0,l.jsx)(n.m.div,{variants:B,initial:"hidden",animate:"visible",transition:{duration:.2,ease:"easeOut"},className:"text-xs cursor-pointer underline ml-1 text-muted-secondary",onClick:e=>{e.stopPropagation(),t("chat_settings")},children:"Show learnings"})]})})})};var V=e.i(625959),G=e.i(630374),Q=e.i(10708),W=e.i(184762);let J=({conversationId:e,generateBotResponse:s,isOpen:t,setIsOpen:i,messageId:n,modelProvider:a,advancedReasoning:r,extendedMemory:c,subscriptionPlan:d,isOwner:u})=>{let[m,h]=(0,o.useState)(""),[f,x]=(0,o.useState)(!0),[p,g]=(0,o.useState)(!1),{reportMessage:b}=(0,v.useChatAPI)(),j=async()=>{let t=new Promise(async(t,l)=>{try{g(!0);let l=m||"No feedback provided";await b(e,n,l,!1,"chat_feedback",null,a,r,c,d),f&&m.length>0&&s({content:m,role:"user"}),t()}catch(e){console.error(e),l(e)}finally{h(""),g(!1),i(!1)}});D.toast.promise(t,{loading:"Sending feedback",success:"Feedback sent",error:"Error sending feedback"})},y=async()=>{t&&!p&&await j(),i(!1)};return(0,l.jsx)(l.Fragment,{children:u&&(0,l.jsx)(G.Dialog,{open:t,onOpenChange:y,children:(0,l.jsxs)(G.DialogContent,{children:[(0,l.jsxs)(G.DialogHeader,{children:[(0,l.jsx)(G.DialogTitle,{className:"",children:"What went wrong?"}),(0,l.jsx)(G.DialogDescription,{className:"text-sm text-muted-foreground",children:"Try telling the AI as well. It may be able to fix its output if you explain to it what the problem is."})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,l.jsx)(V.Checkbox,{id:"tell-ai",checked:f,onCheckedChange:x,"aria-label":"Tell AI"}),(0,l.jsx)(Q.Label,{htmlFor:"tell-ai",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tell AI"})]}),(0,l.jsx)(W.Textarea,{rows:3,value:m,onChange:e=>h(e.target.value),className:"w-full",placeholder:"Your feedback is much appreciated and helps improve the AI!",disabled:p}),(0,l.jsx)("div",{className:"flex justify-end mt-2 space-x-2",children:(0,l.jsx)(R.Button,{"data-event":"chat_report_submission",onClick:y,disabled:p,children:"Submit"})})]})})})},K=(0,g.default)(()=>e.A(891775).then(e=>e.ChatSettingsModal),{loadableGenerated:{modules:[314465]},ssr:!1}),Y=(0,g.default)(()=>e.A(105356),{loadableGenerated:{modules:[583718]},ssr:!1}),X={ClipboardCopy:c.ClipboardCopy,Pencil:u.Pencil,RefreshCcw:m.RefreshCcw,ThumbsDown:x.ThumbsDown,ThumbsUp:p.ThumbsUp,Stamp:f.Stamp},Z=(0,o.memo)(({dataEvent:e,onClick:s,icon:t,tooltipContent:o,iconProps:i,id:n})=>{let a=X[t];return(0,l.jsxs)(y.Tooltip,{children:[(0,l.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,l.jsx)("button",{id:n,"data-event":e,className:"text-muted-foreground w-[28px] h-[28px] flex rounded-lg items-center justify-center hover:text-foreground hover:bg-accent cursor-pointer",onClick:s,children:a?(0,l.jsx)(a,{className:"w-[0.9rem] h-[0.9rem]",...i}):null})}),(0,l.jsx)(y.TooltipContent,{side:"bottom",children:o})]})});Z.displayName="ChatMessageActionButton";let ee=(0,o.memo)(({isLastAtomicMessage:s,isUserMessage:c,setEditingUserMessage:u,messageContent:m,messageId:f,isOwner:x,isAdmin:p,setShowTryAdvancedReasoning:g,...C})=>{let[S,T]=(0,o.useState)(!1),{isCopied:I,copyToClipboard:E}=(0,k.useCopyToClipboard)({timeout:2e3}),[P,M]=(0,o.useState)(!1),[L,D]=(0,o.useState)(!1),{data:R}=(0,N.useUserInformation)(),[O,q]=(0,o.useState)("idle"),[F,$]=(0,o.useState)(!1),[U,B]=(0,o.useState)(""),[V,G]=(0,o.useState)(s),{activeConversationId:Q,toolPreferences:W,isGenerating:X,modelProvider:ee}=(0,w.useChatContext)(),{generateBotResponse:es,regenerateBotResponse:et}=(0,A.useMessageContext)(),{upvoteMessage:el}=(0,v.useChatAPI)(),{data:eo}=(0,N.useUserSubscription)(),ei=window.location.pathname.includes("/notebooks/"),[en,ea]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let s;if(ei)return e.A(989105).then(({default:e})=>{ea(!!e.getState().activeStepId),s=e.subscribe(e=>{ea(!!e.activeStepId)})}),()=>s?.()},[ei]);let er=async(e,s,t,l,o,i,n)=>{try{(W?.learning_from_feedback||R?.preferences?.learning_from_feedback)&&q("calibrating"),await el(e,s,t,l,o,i,n),(W?.learning_from_feedback||R?.preferences?.learning_from_feedback)&&(q("done"),setTimeout(()=>{q("idle"),M(!0),G(!1)},4e3))}catch(e){(W?.learning_from_feedback||R?.preferences?.learning_from_feedback)&&q("idle")}},ec=(0,b.usePathname)(),ed=ec?.startsWith("/chat")||ec?.startsWith("/models"),eu=ec?.includes("/notebooks/"),em=X||en;return(0,l.jsxs)("div",{children:[S&&(0,l.jsx)(J,{conversationId:Q,generateBotResponse:es,isOpen:S,setIsOpen:T,messageId:f,isOwner:x,modelProvider:ee,advancedReasoning:W?.advanced_reasoning||!1,extendedMemory:W?.extended_memory||!1,subscriptionPlan:eo?.plan||"free"}),(0,l.jsxs)("div",{className:(0,t.cn)("flex flex-row items-center flex-wrap",x||p?"sm:visible sm:group-hover:visible":"visible"),...C,children:[c&&(0,l.jsx)(Z,{dataEvent:"chat_edit_message",onClick:()=>u(!0),icon:"Pencil",tooltipContent:"Edit message"}),c&&ed&&_.FEATURE_FLAGS.SAVED_PROMPTS&&(0,l.jsx)(z,{content:m,messageId:f}),!em&&(0,l.jsx)(l.Fragment,{children:I?(0,l.jsx)("div",{className:"w-[28px] h-[28px] flex rounded-lg items-center justify-center text-green-500",children:(0,l.jsx)(r.default,{className:"w-[0.9rem] h-[0.9rem]"})}):(0,l.jsx)(Z,{dataEvent:"chat_copy_message",onClick:()=>{I||E(m)},icon:"ClipboardCopy",tooltipContent:"Copy"})}),!c&&x&&(!em||!s)&&(0,l.jsx)(i.AnimatePresence,{children:(W?.learning_from_feedback||R?.preferences?.learning_from_feedback)&&V&&"idle"!==O?(0,l.jsx)(n.m.div,{className:"order-last basis-full mt-2",layout:!0,initial:{opacity:0,width:0,scale:.8},animate:{opacity:1,width:"auto",scale:1},exit:{opacity:0,width:0,scale:.8},transition:{type:"spring",stiffness:200,damping:15,mass:.5},children:(0,l.jsxs)("div",{className:"group rounded-lg py-1.5 pl-2 pr-2 mx-1 text-muted-foreground bg-background border border-border shadow-subtle text-left inline-flex flex-row items-center gap-2 whitespace-nowrap relative overflow-hidden w-fit",children:[(0,l.jsxs)(n.m.span,{className:"text-xs flex items-center gap-1.5 text-muted-foreground",layout:!0,transition:{type:"spring",stiffness:300,damping:25},children:["calibrating"===O&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.Loader,{className:"w-3.5 h-3.5 animate-spin"}),"Examining feedback..."]}),"done"===O&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.Check,{className:"w-3.5 h-3.5"}),"Learning saved"]})]}),"done"===O&&(0,l.jsxs)(y.Tooltip,{children:[(0,l.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,l.jsx)("button",{type:"button","aria-label":"Adjust learning settings",className:"opacity-0 group-hover:opacity-100 focus-visible:opacity-100 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring transition-opacity flex h-6 w-6 items-center justify-center rounded-full border border-border/70 text-muted-foreground hover:text-foreground",onClick:()=>{B("chat_settings"),j.posthog.capture("chat:show-learnings")},children:(0,l.jsx)(h.SlidersHorizontal,{className:"w-3.5 h-3.5"})})}),(0,l.jsx)(y.TooltipContent,{side:"bottom",children:"Adjust learning"})]})]})},"calibration"):(0,l.jsxs)(n.m.div,{className:"flex",initial:{opacity:0,width:0,scale:.8},animate:{opacity:1,width:"auto",scale:1},exit:{opacity:0,width:0,scale:.8},transition:{type:"spring",stiffness:200,damping:15,mass:.5},children:[(0,l.jsx)(Z,{dataEvent:"upvote",onClick:()=>{M(!P),P||er(Q,f,m,ee,W?.advanced_reasoning||!1,W?.extended_memory||!1,eo?.plan||"free")},icon:"ThumbsUp",tooltipContent:"Good response",iconProps:{fill:P?"currentColor":"none",strokeWidth:2*!P}}),(0,l.jsx)(Z,{dataEvent:"downvote",onClick:()=>{D(!L),L||(g(!0),T(!0))},icon:"ThumbsDown",tooltipContent:"Bad response",iconProps:{fill:L?"currentColor":"none",strokeWidth:2*!L}})]},"voteButtons")}),s&&x&&!c&&!ei&&!em&&(0,l.jsx)(Z,{dataEvent:"regenerate",onClick:()=>et(),icon:"RefreshCcw",tooltipContent:"Regenerate"}),!c&&x&&!V&&(!em||!s)&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(H,{show:F,onDismiss:()=>$(!1),setModal:B})}),eu&&(0,l.jsx)(Y,{children:(0,l.jsx)(Z,{id:"transform-modal-trigger-chat-message-actions",onClick:()=>{j.posthog.capture("workflows:embed-outputs:clicked",{from:"chat-message-actions"})},icon:"Stamp",tooltipContent:"Capture Outputs"})}),(0,l.jsx)(K,{modal:U,setModal:B,defaultSection:"learnFromFeedback"})]})]})});ee.displayName="ChatMessageActions",e.s(["ChatMessageActions",0,ee],582164);var es=e.i(918166),et=e.i(870553),el=e.i(63270);e.s(["AvatarDisplay",0,e=>{let{isOwner:s,messageRole:t}=e;return"user"===t?(0,l.jsx)(l.Fragment,{children:s?(0,l.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,l.jsx)("div",{className:"flex-shrink-0 items-center sm:block",children:(0,l.jsx)(et.UserIcon,{className:"w-6 h-6"})}),(0,l.jsx)("span",{className:"flex items-center text-muted-foreground text-sm",children:"You"})]}):(0,l.jsx)("div",{className:"hidden flex-shrink-0 items-center sm:block",children:(0,l.jsx)(el.Avatar,{className:"mt-1.5 mr-3 w-8 h-8",children:(0,l.jsx)(el.AvatarFallback,{children:(0,l.jsx)(es.User2,{className:"w-6 h-6"})})})})}):(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0 justify-center items-center w-6 h-6 rounded-full flex border bg-blue-50 border-blue-100 dark:bg-blue-900/25 dark:border-blue-900",children:(0,l.jsx)("span",{className:"text-center text-xs text-primary ",style:{lineHeight:"normal"},"data-cy":"julius-avatar",children:"J"})}),(0,l.jsx)("span",{className:"flex items-center text-muted-foreground font-medium text-sm",children:"Julius"})]})}],282200);let eo=(0,o.memo)(({message:e,children:s})=>(0,l.jsx)("div",{"data-group-message-id":e.message_id,children:s}));e.s(["default",0,eo],331184)},683647,e=>{"use strict";var s=e.i(843476),t=e.i(271645),l=e.i(647163);let o=t.default.forwardRef(({Header:e,children:t,className:o,...i},n)=>(0,s.jsxs)("div",{ref:n,className:(0,l.cn)("relative flex flex-col w-full rounded-2xl border-none gap-3",o),...i,children:[e&&(0,s.jsx)("div",{className:"flex flex-row",children:e}),t]}));e.s(["default",0,o])},835324,e=>{"use strict";var s=e.i(843476),t=e.i(271645),l=e.i(824511),o=e.i(531245),i=e.i(286536),n=e.i(356909),a=e.i(918166),r=e.i(640524),c=e.i(770703),d=e.i(618566),u=e.i(215881),m=e.i(384347),h=e.i(582164),f=e.i(38037),x=e.i(378075),p=e.i(167881),g=e.i(728231),b=e.i(367944),j=e.i(616525),v=e.i(394073),y=e.i(620949),w=e.i(647163),A=e.i(282200),_=e.i(331184),N=e.i(683647),k=e.i(918789),C=e.i(930380),S=e.i(472450),T=e.i(184762),I=e.i(210677),E=e.i(151154),P=e.i(968224);let M=(0,t.memo)(({attachments:e})=>{let{handleRemoveAttachment:t,creatingChat:l}=(0,b.useChatContext)();return e&&0!==Object.keys(e).length?(0,s.jsx)("div",{className:"flex flex-1 flex-row flex-wrap gap-2 my-2",children:Array.isArray(e)?e?.map(e=>(0,s.jsx)(P.default,{creatingChat:l,file:e,onDelete:e=>{t(e.name)},readOnly:!0},e.name)):Object.keys(e)?.map(o=>(0,s.jsx)(P.default,{creatingChat:l,file:e[o],onDelete:e=>{t(e.name)},readOnly:!0},o))}):null});var L=e.i(52563);let D=(0,t.memo)(({image_urls:e})=>{let{getAccessTokenSilently:l}=(0,L.useAuth0)(),[o,i]=(0,t.useState)(!1),[n,a]=(0,t.useState)([]);(0,t.useEffect)(()=>((async()=>{if(e?.length)try{let s=await l(),t=e.map(async e=>{let t=await fetch(e,{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw Error(`Failed to fetch image: ${e}`);let l=await t.blob();return URL.createObjectURL(l)}),o=await Promise.all(t);a(o)}catch(e){}})(),()=>{n.forEach(e=>URL.revokeObjectURL(e))}),[e,l]);let r=()=>{i(!o)};if(!e||!Array.isArray(e)||0===e.length)return null;let c=o?"":"max-w-[400px]",d=o?"cursor-zoom-out":"cursor-zoom-in";return(0,s.jsx)("div",{className:"flex flex-col m-1 space-y-2",children:n.map((e,t)=>(0,s.jsx)("img",{src:e,alt:`Image ${t+1}`,className:`pb-1 rounded-lg transition-transform duration-300 ease-in-out transform ${c} ${d}`,onClick:r},t))})}),R=({message:e,editingUserMessage:l,setEditingUserMessage:o})=>{let{conversations:i,activeConversationId:n}=(0,b.useChatContext)(),{editMessageAndGenerateBotResponse:a}=(0,I.useMessageContext)(),[r,c]=(0,t.useState)(e.content);return l?(0,s.jsxs)("div",{children:[(0,s.jsx)(T.Textarea,{value:r,onChange:e=>c(e.target.value),rows:3,className:"w-full"}),(0,s.jsxs)("div",{className:"flex justify-end mt-2 space-x-2",children:[(0,s.jsx)(p.Button,{size:"xs",variant:"outline",onClick:()=>o(null),children:"Cancel"}),(0,s.jsx)(p.Button,{size:"xs",variant:"default",onClick:()=>{let s=i[n].messages.findIndex(s=>s.message_id===e.message_id);-1!==s&&(a({index:s,content:r,messageId:e.message_id,planStepId:e.plan_step_id}),o(null))},children:"Send"})]})]}):(0,s.jsx)("div",{className:"flex flex-col w-full",children:(0,s.jsx)("div",{className:"flex flex-row items-center justify-between w-full",children:(0,s.jsx)("span",{className:"whitespace-pre-wrap",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(D,{image_urls:e.image_urls}),(0,s.jsx)(M,{attachments:e.attachments}),(0,s.jsx)("div",{className:"dark:[&_*]:text-white [&_*]:my-0 prose prose-p:leading-relaxed prose-pre:p-0 prose-pre:bg-transparent prose-pre:text-black whitespace-normal break-words text-wrap max-w-none",children:(0,s.jsx)(k.default,{remarkPlugins:[[S.default,{singleDollarTextMath:!1}]],rehypePlugins:[C.default],children:(0,E.formatMarkdownContent)(e.content)})})]})})})})};var O=e.i(88653),q=e.i(972520),F=e.i(643531),$=e.i(664659),z=e.i(546387),U=e.i(658041),B=e.i(299023),H=e.i(107233),V=e.i(330325),G=e.i(37727),Q=e.i(522016),W=e.i(213248),J=e.i(910758);function K(e){let s=e.level||"column";return"schema"===s?e.schema_name||"":"table"===s?e.table_name||"":e.column_name||""}function Y(e){let s=e.level||"column",t=e.schema_name||"",l=e.table_name||"";return"schema"===s?"":"table"===s?t:`${t}/${l}`}function X({messageId:e,messageContent:o}){let i,{getAccessTokenSilently:n}=(0,L.useAuth0)(),{learningUpdates:a}=(0,J.useLearningContext)(),{dataConnections:r}=(0,b.useChatContext)(),c=a.get(e),d=c,u=!!c;if(c?.connector_name&&(i=c.connector_name),!d&&o)try{let s=JSON.parse(o),t={},l=[];if(s.learning_updates)try{let e=JSON.parse(s.learning_updates);e&&"object"==typeof e&&(t=e,l=Object.keys(t))}catch(e){console.warn("Failed to parse learning_updates:",e)}l.length>0&&(d={connection_id:s.connection_id||"",julius_id:"",message_id:e,updated_keys:l,full:t},u=!1),i=s.connector_name}catch(e){console.warn("Failed to parse messageContent:",e)}let m=!u,h=d?.connection_id,f=(0,t.useMemo)(()=>i||(h&&r?.[h]?.name?r[h].name:"Connector"),[i,h,r]),x=(0,t.useMemo)(()=>d?function(e){if(!e||"object"!=typeof e)return[];let s=[],t=e.add,l=e.update,o=e.delete;return Array.isArray(t)&&t.forEach(e=>{if(!e||"object"!=typeof e)return;let t=e.uuid||"";t&&s.push({id:t,type:"add",level:e.level||"column",itemName:K(e),path:Y(e),learning:e.learning||"",reviewStatus:e.review_status||null})}),Array.isArray(l)&&l.forEach(e=>{if(!e||"object"!=typeof e)return;let t=e.uuid||"";t&&s.push({id:t,type:"update",level:e.level||"column",itemName:K(e),path:Y(e),learning:e.learning||"",oldLearning:e.old_learning||e.learning||"",reviewStatus:e.review_status||null})}),Array.isArray(o)&&o.forEach(e=>{if(!e||"object"!=typeof e)return;let t=e.uuid||"";t&&s.push({id:t,type:"delete",level:e.level||"column",itemName:K(e),path:Y(e),learning:e.learning||"",reviewStatus:e.review_status||null})}),s}(d.full):[],[d]),g=(0,t.useMemo)(()=>{let e={add:0,update:0,delete:0};return x.forEach(s=>e[s.type]++),e},[x]),[j,v]=(0,t.useState)(!1),[y,A]=(0,t.useState)(null),[_,N]=(0,t.useState)(new Map),[k,C]=(0,t.useState)(null),[S,T]=(0,t.useState)(!1),[I,E]=(0,t.useState)(!1),P=(0,t.useRef)(null),M=(0,t.useCallback)(()=>{if(P.current){let{scrollTop:e,scrollHeight:s,clientHeight:t}=P.current;E(e+t>=s-20)}},[]);(0,t.useEffect)(()=>{!h||m||(async()=>{try{let e=await n(),s=await (0,W.getAutoapprovalMode)({accessToken:e,connectionId:h});A(s.autoapproval_enabled)}catch(e){console.warn("Failed to fetch auto-approval mode:",e),A(!0)}})()},[h,n,m]);let D=(0,t.useCallback)(e=>{if(_.has(e.id))return _.get(e.id);let s=e.reviewStatus||null;return y&&null===s&&!S?"approved":s},[_,y,S]),R=(0,t.useCallback)(async(e,s)=>{let t=D(s),l=_.get(e);if(C(null),"rejected"===t){N(s=>{let t=new Map(s);return t.set(e,null),t});try{let s=await n();await (0,W.revertLearningToPending)({accessToken:s,learningId:e})}catch(s){console.error("Failed to revert learning:",s),N(s=>new Map(s).set(e,l??"rejected"))}}else{N(s=>new Map(s).set(e,"rejected"));try{let s=await n();await (0,W.rejectLearning)({accessToken:s,learningId:e})}catch(s){console.error("Failed to reject learning:",s),N(s=>{let t=new Map(s);return void 0!==l?t.set(e,l):t.delete(e),t})}}},[D,n,_]),X=(0,t.useCallback)(async(e,s)=>{let t=D(s),l=_.get(e);if(C(null),"approved"===t){N(s=>{let t=new Map(s);return t.set(e,null),t});try{let s=await n();await (0,W.revertLearningToPending)({accessToken:s,learningId:e})}catch(s){console.error("Failed to revert learning:",s),N(s=>new Map(s).set(e,l??"approved"))}}else{N(s=>new Map(s).set(e,"approved"));try{let s=await n();await (0,W.approveLearning)({accessToken:s,learningId:e})}catch(s){console.error("Failed to approve learning:",s),N(s=>{let t=new Map(s);return void 0!==l?t.set(e,l):t.delete(e),t})}}},[D,n,_]),Z=(0,t.useCallback)(async()=>{if("approved"===k||y&&null===k&&!S){let e=x.map(e=>e.id),s=new Map(_);x.forEach(e=>s.set(e.id,null)),N(s),C(null),T(!0);try{let s=await n();await (0,W.batchRevertLearnings)({accessToken:s,learningIds:e})}catch(s){console.error("Failed to undo approve all:",s);let e=new Map(_);x.forEach(s=>e.set(s.id,"approved")),N(e),C("approved"),T(!1)}return}let e=x.map(e=>e.id),s=new Map(_);x.forEach(e=>s.set(e.id,"approved")),N(s),C("approved"),T(!1);try{let s=await n();await (0,W.batchApproveLearnings)({accessToken:s,learningIds:e})}catch(e){console.error("Failed to approve all learnings:",e),N(new Map),C(null)}},[x,k,y,S,_,n]),ee=(0,t.useCallback)(async()=>{if("rejected"===k){let e=x.map(e=>e.id),s=new Map(_);x.forEach(e=>s.set(e.id,null)),N(s),C(null);try{let s=await n();await (0,W.batchRevertLearnings)({accessToken:s,learningIds:e})}catch(s){console.error("Failed to undo reject all:",s);let e=new Map(_);x.forEach(s=>e.set(s.id,"rejected")),N(e),C("rejected")}return}let e=x.map(e=>e.id),s=new Map(_);x.forEach(e=>s.set(e.id,"rejected")),N(s),C("rejected");try{let s=await n();await (0,W.batchRejectLearnings)({accessToken:s,learningIds:e})}catch(e){console.error("Failed to reject all learnings:",e),N(new Map),C(null)}},[x,k,_,n]);return d&&0!==x.length?(0,s.jsx)(O.AnimatePresence,{children:(0,s.jsxs)(l.m.div,{className:"min-w-0 flex-1 flex flex-col",layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",stiffness:200,damping:15,mass:.5},children:[(0,s.jsxs)("button",{onClick:()=>v(!j),className:"w-fit flex items-center gap-1.5 text-muted-foreground hover:text-foreground transition-colors text-sm",children:[(0,s.jsx)("span",{className:"muted-foreground font-medium",children:"Updated learnings"}),(0,s.jsx)("span",{className:"text-muted-secondary",children:f}),(0,s.jsxs)("div",{className:"flex items-center gap-[6px]",children:[(g.add>0||g.update>0)&&(0,s.jsxs)("span",{className:"flex items-center font-medium text-green-600 dark:text-green-400",children:["+",g.add+g.update]}),(g.delete>0||g.update>0)&&(0,s.jsxs)("span",{className:"flex items-center font-medium text-red-600 dark:text-red-400",children:["-",g.delete+g.update]})]}),(0,s.jsx)($.ChevronDown,{className:(0,w.cn)("w-4 h-4 transition-transform",j?"rotate-180 opacity-100":"opacity-0 group-hover:opacity-100")})]}),(0,s.jsx)(O.AnimatePresence,{children:j&&(0,s.jsx)(l.m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"overflow-hidden",children:(0,s.jsxs)("div",{className:"mt-2 border border-border rounded-lg bg-background overflow-hidden",style:{boxShadow:"0px 2px 10px 0px #0000000D"},children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{ref:P,onScroll:M,className:"divide-y divide-border max-h-[280px] overflow-y-auto scrollbar-on-hover",children:x.map(e=>{let t=function(e){switch(e){case"schema":return U.Database;case"table":return V.Table2;default:return z.Columns3}}(e.level),l=D(e);return(0,s.jsx)("div",{className:"px-3 py-2.5",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(t,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"}),(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.itemName}),e.path&&(0,s.jsx)("span",{className:"text-muted-foreground",children:e.path})]}),("update"===e.type||"delete"===e.type)&&(0,s.jsxs)("div",{className:"flex items-start gap-2 pl-6",children:[(0,s.jsx)(B.Minus,{className:"w-3.5 h-3.5 text-muted-foreground/60 flex-shrink-0 mt-0.5"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground/60",children:e.oldLearning||e.learning})]}),("add"===e.type||"update"===e.type)&&(0,s.jsxs)("div",{className:"flex items-start gap-2 pl-6",children:[(0,s.jsx)(H.Plus,{className:"w-3.5 h-3.5 text-foreground flex-shrink-0 mt-0.5"}),(0,s.jsx)("p",{className:"text-sm text-foreground",children:e.learning})]})]}),!m&&(0,s.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,s.jsx)(p.Button,{variant:"outline",size:"icon",onClick:()=>R(e.id,e),className:(0,w.cn)("border-border","rejected"===l&&"bg-muted"),title:"rejected"===l?"Undo reject":"Reject",children:(0,s.jsx)(G.X,{className:"w-4 h-4"})}),(0,s.jsx)(p.Button,{variant:"outline",size:"icon",onClick:()=>X(e.id,e),className:(0,w.cn)("border-border","approved"===l&&"bg-muted"),title:"approved"===l?"Undo approve":"Approve",children:(0,s.jsx)(F.Check,{className:"w-4 h-4"})})]})]})},e.id)})}),(0,s.jsx)("div",{className:(0,w.cn)("absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-background to-transparent pointer-events-none transition-opacity",I?"opacity-0":"opacity-100")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-t border-border bg-muted/50",children:[h&&(0,s.jsxs)(Q.default,{href:`/data-connectors/${h}/review-learnings`,className:"flex items-center gap-1.5 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[(0,s.jsx)("span",{children:"Review all learnings"}),(0,s.jsx)(q.ArrowRight,{className:"w-3.5 h-3.5"})]}),!m&&(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,s.jsxs)("button",{onClick:ee,className:(0,w.cn)("flex items-center gap-1 px-2 py-0.5 text-sm rounded border transition-colors","rejected"===k?"bg-muted border-border text-foreground":"border-border hover:bg-muted"),children:[(0,s.jsx)(G.X,{className:"w-3.5 h-3.5"}),"rejected"===k?"Undo":"Reject all"]}),(0,s.jsxs)("button",{onClick:Z,className:(0,w.cn)("flex items-center gap-1 px-2 py-0.5 text-sm rounded border transition-colors","approved"===k||y&&null===k&&!S?"bg-muted border-border text-foreground":"border-border hover:bg-muted"),children:[(0,s.jsx)(F.Check,{className:"w-3.5 h-3.5"}),"approved"===k||y&&null===k&&!S?"Undo":"Approve all"]})]})]})]})})})]},"learning-indicator")}):null}var Z=e.i(255248);let ee=async(e,s,t)=>{let l=await fetch(`${v.BASE_API}/shared/message/${e}/${s}`,{headers:{Authorization:`Bearer ${t}`}});return await l.json()},es=async(e,s,t,l)=>{let o=await fetch(`${v.BASE_API}/shared/message/${e}/${s}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({is_public:t})});if(!o.ok)throw Error((await o.json()).error||"Failed to update HTML privacy");return o.json()};var et=e.i(954616),el=e.i(266027),eo=e.i(912598);let ei=(e,s)=>{let l,{getAccessTokenSilently:o}=(0,L.useAuth0)(),i=(0,eo.useQueryClient)(),n=(0,t.useRef)(0),a=(0,el.useQuery)({queryKey:["htmlPublicSettings",e,s],queryFn:async()=>{let t=await o(),l=await ee(e,s,t),n=i.getQueryData(["htmlPublicSettings",e,s]),a="boolean"==typeof l.is_public?l.is_public:n?.is_public??!1,r="string"==typeof l.shared_html_id&&l.shared_html_id.length>0?l.shared_html_id:n?.shared_html_id??null;return{...l,is_public:a,shared_html_id:r}}}),r=(0,et.useMutation)({mutationFn:async t=>es(e,s,t,await o()),onMutate:async t=>{await i.cancelQueries({queryKey:["htmlPublicSettings",e,s]});let l=i.getQueryData(["htmlPublicSettings",e,s]),o=++n.current;return i.setQueryData(["htmlPublicSettings",e,s],e=>({...e,is_public:t})),{previous:l,seq:o}},onError:(t,l,o)=>{o?.previous&&o.seq===n.current&&i.setQueryData(["htmlPublicSettings",e,s],o.previous)},onSuccess:(t,l,o)=>{if(o?.seq!==n.current)return;let a=i.getQueryData(["htmlPublicSettings",e,s]),r={...a,...t,is_public:l,shared_html_id:t?.shared_html_id??a?.shared_html_id??null};i.setQueryData(["htmlPublicSettings",e,s],()=>r)}});return{isPublic:(l=a.data,!!l?.is_public),isLoading:a.isLoading,isError:a.isError,data:a.data,updatePublicSettings:(e,s)=>r.mutate(e,{onSuccess:e=>{s?.onSuccess?.(e)},onError:e=>s?.onError?.(e)})}};var en=e.i(844343),ea=e.i(364573),er=e.i(500),ec=e.i(997625),ed=e.i(604570),eu=e.i(846696),em=e.i(630374),eh=e.i(23750),ef=e.i(319036);let ex=({children:e,messageId:o,htmlIndex:i,conversationId:n})=>{let[a,r]=(0,t.useState)(!1),[c,d]=(0,t.useState)(!1),{isPublic:u,updatePublicSettings:m,data:h}=ei(o,i),f=h?.shared_html_id,x=f?`${window.location.protocol}//${window.location.host}/s/html/${f}?utm_source=share&utm_campaign=html&utm_medium=referral`:null,g=f?`${v.BASE_API}/shared/html/${f}/embed`:null,b=e=>{let s=e||x;s&&((0,en.default)(s),r(!0),setTimeout(()=>r(!1),5e3))},j=e=>{m(e,{onSuccess:s=>{if(e&&s?.shared_html_id){let e=`${window.location.protocol}//${window.location.host}/s/html/${s.shared_html_id}?utm_source=share&utm_campaign=html&utm_medium=referral`;eu.toast.success("Link Copied. Your Insight is now public!"),b(e),ed.default.capture("share:html:clicked")}else e||(eu.toast.warning("Your Insight is now private!"),ed.default.capture("unshare:html:clicked"))},onError:e=>{eu.toast.error("Failed to update Insight privacy"),console.error("Failed to update Insight privacy:",e),ed.default.capture("share:html:failed")}})};return(0,s.jsxs)(em.Dialog,{open:c,onOpenChange:e=>{d(e),e&&!u&&j(!0)},children:[(0,s.jsx)(em.DialogTrigger,{asChild:!0,children:e}),(0,s.jsxs)(em.DialogContent,{children:[(0,s.jsxs)(em.DialogTitle,{className:"flex flex-row gap-2 items-center",children:[(0,s.jsx)(Z.Share,{className:"flex-shrink-0 w-4 h-4"})," Share Insight"]}),(0,s.jsx)(em.DialogDescription,{children:"Sharing makes your Insight viewable by anyone with the link."}),(0,s.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,s.jsx)("span",{children:"Make this Insight public:"}),(0,s.jsx)(ef.Switch,{checked:u,onCheckedChange:j})]}),(0,s.jsx)(O.AnimatePresence,{children:u&&(0,s.jsxs)(l.m.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"w-full flex relative flex-row overflow-hidden border border-input rounded-xl",children:[(0,s.jsx)(eh.Input,{id:"link",value:x||"fetching your shareable link...",readOnly:!0,className:"pr-36 pl-3 w-full h-9 font-mono font-medium border-none focus:ring-offset-0 focus:outline-none focus-visible:ring-0 focus-visible:outline-none"}),(0,s.jsxs)("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex gap-1",children:[(0,s.jsxs)(p.Button,{"data-event":"share_link_copy",variant:"ghost",onClick:()=>b(x||void 0),disabled:!x,className:a?"bg-accent":void 0,size:"sm",children:[a?(0,s.jsx)(ea.ClipboardCheckIcon,{className:"w-4 h-4 text-green-500"}):(0,s.jsx)(er.ClipboardCopyIcon,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"ml-1 text-xs",children:"link"})]}),(0,s.jsxs)(p.Button,{"data-event":"share_embed_copy",variant:"ghost",onClick:()=>b(g||void 0),disabled:!g,size:"sm",children:[(0,s.jsx)(ec.Code2,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"ml-1 text-xs",children:"embed"})]})]})]})})]})]})},ep=(0,c.default)(()=>e.A(134431),{loadableGenerated:{modules:[296835]},ssr:!1}),eg=({htmlContent:e,showHeader:l=!0,messageId:o=null,htmlIndex:i=null,conversationId:n=null})=>{let a=(0,t.useRef)(null),r=(0,t.useRef)(`iframe-${Math.random().toString(36).substr(2,9)}`),c=/className='mux-player'/.test(e),d=(0,t.useCallback)(e=>{e.data.height&&e.data.iframeId===r.current&&a.current&&(a.current.style.height=`${e.data.height}px`)},[]);(0,t.useEffect)(()=>(window.addEventListener("message",d),()=>{window.removeEventListener("message",d)}),[d]),(0,t.useEffect)(()=>{let e=a.current;return()=>{if(e&&e.contentWindow)try{e.contentWindow.dispatchEvent(new Event("unload"))}catch(e){console.error(e)}}},[]);let u=`
    <html>
      <head>
        <style>
          body { margin: 0; }
        </style>
      </head>
      <body>
        ${e}
        <script>
          (function() {
            const iframeId = '${r.current}';
            let rafId = null;
            let lastHeight = -1;

            function sendHeight() {
              const body = document.body;
              const html = document.documentElement;

              const height = Math.max(
                body.scrollHeight,
                body.offsetHeight,
                html.clientHeight,
                html.scrollHeight,
                html.offsetHeight
              );

              if (height !== lastHeight) {
                window.parent.postMessage({height: height, iframeId: iframeId}, '*');
                lastHeight = height;
              }
              rafId = requestAnimationFrame(sendHeight);
            }

            function init() {
              sendHeight(); // Initial height send

              const observer = new MutationObserver(() => {
                if (rafId === null) {
                  rafId = requestAnimationFrame(sendHeight);
                }
              });

              observer.observe(document.body, {
                childList: true,
                subtree: true,
                attributes: true,
                characterData: true
              });

              window.addEventListener('resize', () => {
                if (rafId === null) {
                  rafId = requestAnimationFrame(sendHeight);
                }
              });

              // Cleanup function
              window.addEventListener('unload', () => {
                if (rafId !== null) {
                  cancelAnimationFrame(rafId);
                }
                observer.disconnect();
              });
            }

            // Use 'DOMContentLoaded' instead of 'load' for earlier execution
            if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', init);
            } else {
              init();
            }
          })();
        </script>
      </body>
    </html>
  `;if(c){let t=e.match(/id='([^"]+)'/);if(t&&t[1])return(0,s.jsx)(ep,{playbackId:t[1],controls:!0,autoPlay:!1,style:{width:"100%",height:"100%"}})}return(0,s.jsx)(eb,{content:e,showHeader:l,messageId:o,htmlIndex:i,conversationId:n,children:(0,s.jsx)("iframe",{ref:a,sandbox:"allow-scripts allow-modals allow-popups allow-popups-to-escape-sandbox allow-forms allow-downloads",className:"w-full h-full border-0",title:"Rendered HTML content",srcDoc:u})})},eb=({children:e,content:t,showHeader:l,messageId:o=null,htmlIndex:i=null,conversationId:n=null})=>{let a=v.FEATURE_FLAGS.SHAREABLE_HTML&&o&&void 0!==i&&n,{isPublic:r}=ei(o,i),c=r&&a;return(0,s.jsxs)("div",{"data-cy":"rendered-html-content",className:"border rounded-lg overflow-hidden my-3 bg-white",children:[l&&(0,s.jsx)("div",{className:"flex justify-end items-center p-2 bg-gray-100 dark:bg-neutral-900 dark:border-neutral-900 text-foreground",children:(0,s.jsx)("div",{className:"flex items-center space-x-2",children:a&&(0,s.jsx)(ex,{messageId:o,htmlIndex:i,conversationId:n,children:(0,s.jsxs)("button",{className:"p-1 px-2 hover:bg-message rounded inline-flex items-center gap-1","aria-label":"Share HTML content",title:c?"HTML is public":"Share HTML",children:[(0,s.jsx)(Z.Share,{className:`size-3.5 ${c?"text-blue-500":"text-foreground"}`}),(0,s.jsx)("span",{className:"text-sm",children:"Share"})]})})})}),(0,s.jsx)("div",{className:"h-full overflow-auto",children:e})]})};var ej=e.i(463059);let ev=t.default.memo(function({children:e,as:o="p",className:i,duration:n=2,spread:a=2,runOnce:r=!1}){let c=l.m.create(o),d=(0,t.useMemo)(()=>e.length*a,[e,a]);return(0,s.jsx)(c,{className:(0,w.cn)("relative inline-block bg-[length:250%_100%,auto] bg-clip-text","text-transparent [--base-color:#a1a1aa] [--base-gradient-color:#f1f1f1]","[background-repeat:no-repeat,padding-box] [--bg:linear-gradient(90deg,#0000_calc(50%-var(--spread)),var(--base-gradient-color),#0000_calc(50%+var(--spread)))]","dark:[--base-color:#71717a] dark:[--base-gradient-color:#ffffff] dark:[--bg:linear-gradient(90deg,#0000_calc(50%-var(--spread)),var(--base-gradient-color),#0000_calc(50%+var(--spread)))]",i),initial:{backgroundPosition:r?"150% center":"100% center"},animate:{backgroundPosition:r?"-150% center":"0% center"},transition:{repeat:r?0:1/0,duration:n,ease:"easeInOut"},style:{"--spread":`${d}px`,backgroundImage:"var(--bg), linear-gradient(var(--base-color), var(--base-color))"},children:e})});var ey=e.i(808451),ew=e.i(765066),eA=e.i(842405);let e_=e=>{if(e)return"string"!=typeof e?"text":e?.startsWith("<table>")?"table":e.startsWith("[JULIUS_TABLE]")?"julius_table":"text"},eN=(0,ey.debounce)(async e=>eA.client.refetchQueries({queryKey:(0,ew.getGlobalVariablesQueryKey)(e)}),1e4),ek=(e,s)=>{let t=e?.outputs_dict||{},l=Object.keys(t),o={},i=[];for(let e=0;e<l.length;e++){let s=l[e],n=e_(t[s]);if("text"===n){let o=e+1;if(o<l.length){let e=e_(t[l.at(o)]);e&&"text"!==e||i.push(s)}else i.push(s)}else if("table"===n||"julius_table"===n||"html"===n){o[n]||(o[n]=[]);let i=[],a=e-1;if(a>=0){let e=l.at(a);"text"===e_(t[e])&&i.push([e])}i.push([s]),o[n].push(i)}}for(let s in i.length>0&&(o.text=[i]),e?.image_urls_dict||{})o.image||(o.image=[]),o.image.push([s]);return(e?.html_elements&&(o.html=[["html_elements"]]),0===Object.keys(o).length)?void 0:(eN(s),o)},eC=e=>{if(e)return"julius_table"===e?"Table":e},eS=(e,s)=>{let t=document.querySelector(`[data-type="${e}"][data-index="${s}"]`);t&&t?.scrollIntoView({behavior:"smooth",block:"nearest"})};var eT=e.i(991578);let eI=e=>{if(e)return e.replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")},eE=e=>{let s=(0,f.safeParseJSON)(e)||{};if(s&&"object"==typeof s){let e=eI(s.executable_code||s.python||s.r_code||s.code||s.string||s.html_code||s.sql||s.gaql);if(e)return e}let t=(0,eT.getPartialArgValue)(e,"html_code"),l=(0,eT.getPartialArgValue)(e,"code"),o=(0,eT.getPartialArgValue)(e,"sql"),i=(0,eT.getPartialArgValue)(e,"gaql");return eI(t||l||o||i||void 0)},eP=(e,s)=>{let t=(e.tool_title||"").trim();if(t)return t;let l=(e.content||"").toString();if(l&&l.trim()){let e=l.split(/\r?\n/).map(e=>e.replace(/\{?\s*outputs_dict\s*\[\s*['"][^'"]+['"]\s*\]\s*\}?/gi,"").replace(/^\s+/,"")).filter(e=>e.trim().length>0),s=e[0]?.trim();if(s)return s.length>120?s.slice(0,117)+"â€¦":s}let o=e.function_call?.name||"";if(!o)return s?"Thinking about next steps":"Thought about next steps";if("schema_analysis"===o)return"Reading tables";let i=eT.toolNameButtonDetails[o];return i?s?i.presentButtonText:i.pastButtonText:eT.codeFunctionNames.includes(o)?s?"Running Code":"Ran Code":o},eM=e=>{let s=[];for(let t=0;t<(e?.length||0);t++){let l=e[t];if(l&&(l.thinking_call&&s.push({id:`thinking-${l.message_id}`,kind:"thinking",title:l.thinking_call?.arguments?.title||"Thinking",content:l.thinking_call?.arguments?.content,messageId:l.message_id,inProgress:l.thinking_call?.arguments?.status!=="complete"}),l.function_call)){let o=e[t+1],i=!o,n=eE(l.function_call?.arguments),a=o&&"function"===o.role&&o.content?(0,f.safeParseJSON)(o.content):void 0;s.push({id:`tool-${l.message_id}`,kind:"tool",title:eP(l,!!i),content:n,messageId:l.message_id,name:l.function_call.name,inProgress:!!i,outputsResponse:a})}}return s};var eL=e.i(435488);e.i(110534),e.i(67182);let eD={python:"python",r:"r",sql:"sql",html:"html"},eR=({item:l,isActive:o,namePrefix:i="callstack",fontSize:n=10})=>{let a=(0,t.useRef)(null),r=(0,t.useRef)(null),{theme:c}=(0,j.useUserContext)(),[d,u]=(0,t.useState)(void 0);return(0,t.useEffect)(()=>()=>{try{let e=a.current?.editor;e&&r.current&&(e.off("change",r.current),r.current=null)}catch{}},[l.id]),(0,t.useEffect)(()=>{(async s=>{if(!s)return u("txt");let t=eD[s]||s;try{await e.f({"ace-builds/src-noconflict/mode-python":{id:()=>550894,module:()=>e.A(550894)},"ace-builds/src-noconflict/mode-r":{id:()=>77412,module:()=>e.A(77412)},"ace-builds/src-noconflict/mode-sql":{id:()=>976485,module:()=>e.A(976485)},"ace-builds/src-noconflict/mode-html":{id:()=>31590,module:()=>e.A(31590)},"ace-builds/src-noconflict/mode-abap.js":{id:()=>85143,module:()=>e.A(85143)},"ace-builds/src-noconflict/mode-abap":{id:()=>85143,module:()=>e.A(85143)},"ace-builds/src-noconflict/mode-abc.js":{id:()=>168441,module:()=>e.A(168441)},"ace-builds/src-noconflict/mode-abc":{id:()=>168441,module:()=>e.A(168441)},"ace-builds/src-noconflict/mode-actionscript.js":{id:()=>889876,module:()=>e.A(889876)},"ace-builds/src-noconflict/mode-actionscript":{id:()=>889876,module:()=>e.A(889876)},"ace-builds/src-noconflict/mode-ada.js":{id:()=>212154,module:()=>e.A(212154)},"ace-builds/src-noconflict/mode-ada":{id:()=>212154,module:()=>e.A(212154)},"ace-builds/src-noconflict/mode-alda.js":{id:()=>130548,module:()=>e.A(130548)},"ace-builds/src-noconflict/mode-alda":{id:()=>130548,module:()=>e.A(130548)},"ace-builds/src-noconflict/mode-apache_conf.js":{id:()=>543911,module:()=>e.A(543911)},"ace-builds/src-noconflict/mode-apache_conf":{id:()=>543911,module:()=>e.A(543911)},"ace-builds/src-noconflict/mode-apex.js":{id:()=>60379,module:()=>e.A(60379)},"ace-builds/src-noconflict/mode-apex":{id:()=>60379,module:()=>e.A(60379)},"ace-builds/src-noconflict/mode-applescript.js":{id:()=>232391,module:()=>e.A(232391)},"ace-builds/src-noconflict/mode-applescript":{id:()=>232391,module:()=>e.A(232391)},"ace-builds/src-noconflict/mode-aql.js":{id:()=>986186,module:()=>e.A(986186)},"ace-builds/src-noconflict/mode-aql":{id:()=>986186,module:()=>e.A(986186)},"ace-builds/src-noconflict/mode-asciidoc.js":{id:()=>569936,module:()=>e.A(569936)},"ace-builds/src-noconflict/mode-asciidoc":{id:()=>569936,module:()=>e.A(569936)},"ace-builds/src-noconflict/mode-asl.js":{id:()=>575021,module:()=>e.A(575021)},"ace-builds/src-noconflict/mode-asl":{id:()=>575021,module:()=>e.A(575021)},"ace-builds/src-noconflict/mode-assembly_arm32.js":{id:()=>392935,module:()=>e.A(392935)},"ace-builds/src-noconflict/mode-assembly_arm32":{id:()=>392935,module:()=>e.A(392935)},"ace-builds/src-noconflict/mode-assembly_x86.js":{id:()=>663268,module:()=>e.A(663268)},"ace-builds/src-noconflict/mode-assembly_x86":{id:()=>663268,module:()=>e.A(663268)},"ace-builds/src-noconflict/mode-astro.js":{id:()=>445632,module:()=>e.A(445632)},"ace-builds/src-noconflict/mode-astro":{id:()=>445632,module:()=>e.A(445632)},"ace-builds/src-noconflict/mode-autohotkey.js":{id:()=>270522,module:()=>e.A(270522)},"ace-builds/src-noconflict/mode-autohotkey":{id:()=>270522,module:()=>e.A(270522)},"ace-builds/src-noconflict/mode-basic.js":{id:()=>734926,module:()=>e.A(734926)},"ace-builds/src-noconflict/mode-basic":{id:()=>734926,module:()=>e.A(734926)},"ace-builds/src-noconflict/mode-batchfile.js":{id:()=>710026,module:()=>e.A(710026)},"ace-builds/src-noconflict/mode-batchfile":{id:()=>710026,module:()=>e.A(710026)},"ace-builds/src-noconflict/mode-bibtex.js":{id:()=>316870,module:()=>e.A(316870)},"ace-builds/src-noconflict/mode-bibtex":{id:()=>316870,module:()=>e.A(316870)},"ace-builds/src-noconflict/mode-c9search.js":{id:()=>624341,module:()=>e.A(624341)},"ace-builds/src-noconflict/mode-c9search":{id:()=>624341,module:()=>e.A(624341)},"ace-builds/src-noconflict/mode-c_cpp.js":{id:()=>9074,module:()=>e.A(9074)},"ace-builds/src-noconflict/mode-c_cpp":{id:()=>9074,module:()=>e.A(9074)},"ace-builds/src-noconflict/mode-cirru.js":{id:()=>391978,module:()=>e.A(391978)},"ace-builds/src-noconflict/mode-cirru":{id:()=>391978,module:()=>e.A(391978)},"ace-builds/src-noconflict/mode-clojure.js":{id:()=>265811,module:()=>e.A(265811)},"ace-builds/src-noconflict/mode-clojure":{id:()=>265811,module:()=>e.A(265811)},"ace-builds/src-noconflict/mode-clue.js":{id:()=>380245,module:()=>e.A(380245)},"ace-builds/src-noconflict/mode-clue":{id:()=>380245,module:()=>e.A(380245)},"ace-builds/src-noconflict/mode-cobol.js":{id:()=>546317,module:()=>e.A(546317)},"ace-builds/src-noconflict/mode-cobol":{id:()=>546317,module:()=>e.A(546317)},"ace-builds/src-noconflict/mode-coffee.js":{id:()=>335298,module:()=>e.A(335298)},"ace-builds/src-noconflict/mode-coffee":{id:()=>335298,module:()=>e.A(335298)},"ace-builds/src-noconflict/mode-coldfusion.js":{id:()=>661517,module:()=>e.A(661517)},"ace-builds/src-noconflict/mode-coldfusion":{id:()=>661517,module:()=>e.A(661517)},"ace-builds/src-noconflict/mode-crystal.js":{id:()=>261644,module:()=>e.A(261644)},"ace-builds/src-noconflict/mode-crystal":{id:()=>261644,module:()=>e.A(261644)},"ace-builds/src-noconflict/mode-csharp.js":{id:()=>869223,module:()=>e.A(869223)},"ace-builds/src-noconflict/mode-csharp":{id:()=>869223,module:()=>e.A(869223)},"ace-builds/src-noconflict/mode-csound_document.js":{id:()=>502159,module:()=>e.A(502159)},"ace-builds/src-noconflict/mode-csound_document":{id:()=>502159,module:()=>e.A(502159)},"ace-builds/src-noconflict/mode-csound_orchestra.js":{id:()=>232907,module:()=>e.A(232907)},"ace-builds/src-noconflict/mode-csound_orchestra":{id:()=>232907,module:()=>e.A(232907)},"ace-builds/src-noconflict/mode-csound_score.js":{id:()=>817488,module:()=>e.A(817488)},"ace-builds/src-noconflict/mode-csound_score":{id:()=>817488,module:()=>e.A(817488)},"ace-builds/src-noconflict/mode-csp.js":{id:()=>707516,module:()=>e.A(707516)},"ace-builds/src-noconflict/mode-csp":{id:()=>707516,module:()=>e.A(707516)},"ace-builds/src-noconflict/mode-css.js":{id:()=>85930,module:()=>e.A(85930)},"ace-builds/src-noconflict/mode-css":{id:()=>85930,module:()=>e.A(85930)},"ace-builds/src-noconflict/mode-csv.js":{id:()=>161907,module:()=>e.A(161907)},"ace-builds/src-noconflict/mode-csv":{id:()=>161907,module:()=>e.A(161907)},"ace-builds/src-noconflict/mode-curly.js":{id:()=>431115,module:()=>e.A(431115)},"ace-builds/src-noconflict/mode-curly":{id:()=>431115,module:()=>e.A(431115)},"ace-builds/src-noconflict/mode-cuttlefish.js":{id:()=>928328,module:()=>e.A(928328)},"ace-builds/src-noconflict/mode-cuttlefish":{id:()=>928328,module:()=>e.A(928328)},"ace-builds/src-noconflict/mode-d.js":{id:()=>670108,module:()=>e.A(670108)},"ace-builds/src-noconflict/mode-d":{id:()=>670108,module:()=>e.A(670108)},"ace-builds/src-noconflict/mode-dart.js":{id:()=>625236,module:()=>e.A(625236)},"ace-builds/src-noconflict/mode-dart":{id:()=>625236,module:()=>e.A(625236)},"ace-builds/src-noconflict/mode-diff.js":{id:()=>319264,module:()=>e.A(319264)},"ace-builds/src-noconflict/mode-diff":{id:()=>319264,module:()=>e.A(319264)},"ace-builds/src-noconflict/mode-django.js":{id:()=>159323,module:()=>e.A(159323)},"ace-builds/src-noconflict/mode-django":{id:()=>159323,module:()=>e.A(159323)},"ace-builds/src-noconflict/mode-dockerfile.js":{id:()=>267565,module:()=>e.A(267565)},"ace-builds/src-noconflict/mode-dockerfile":{id:()=>267565,module:()=>e.A(267565)},"ace-builds/src-noconflict/mode-dot.js":{id:()=>128991,module:()=>e.A(128991)},"ace-builds/src-noconflict/mode-dot":{id:()=>128991,module:()=>e.A(128991)},"ace-builds/src-noconflict/mode-drools.js":{id:()=>598411,module:()=>e.A(598411)},"ace-builds/src-noconflict/mode-drools":{id:()=>598411,module:()=>e.A(598411)},"ace-builds/src-noconflict/mode-edifact.js":{id:()=>938636,module:()=>e.A(938636)},"ace-builds/src-noconflict/mode-edifact":{id:()=>938636,module:()=>e.A(938636)},"ace-builds/src-noconflict/mode-eiffel.js":{id:()=>538045,module:()=>e.A(538045)},"ace-builds/src-noconflict/mode-eiffel":{id:()=>538045,module:()=>e.A(538045)},"ace-builds/src-noconflict/mode-ejs.js":{id:()=>61154,module:()=>e.A(61154)},"ace-builds/src-noconflict/mode-ejs":{id:()=>61154,module:()=>e.A(61154)},"ace-builds/src-noconflict/mode-elixir.js":{id:()=>120844,module:()=>e.A(120844)},"ace-builds/src-noconflict/mode-elixir":{id:()=>120844,module:()=>e.A(120844)},"ace-builds/src-noconflict/mode-elm.js":{id:()=>746295,module:()=>e.A(746295)},"ace-builds/src-noconflict/mode-elm":{id:()=>746295,module:()=>e.A(746295)},"ace-builds/src-noconflict/mode-erlang.js":{id:()=>566398,module:()=>e.A(566398)},"ace-builds/src-noconflict/mode-erlang":{id:()=>566398,module:()=>e.A(566398)},"ace-builds/src-noconflict/mode-flix.js":{id:()=>710108,module:()=>e.A(710108)},"ace-builds/src-noconflict/mode-flix":{id:()=>710108,module:()=>e.A(710108)},"ace-builds/src-noconflict/mode-forth.js":{id:()=>893709,module:()=>e.A(893709)},"ace-builds/src-noconflict/mode-forth":{id:()=>893709,module:()=>e.A(893709)},"ace-builds/src-noconflict/mode-fortran.js":{id:()=>690983,module:()=>e.A(690983)},"ace-builds/src-noconflict/mode-fortran":{id:()=>690983,module:()=>e.A(690983)},"ace-builds/src-noconflict/mode-fsharp.js":{id:()=>22024,module:()=>e.A(22024)},"ace-builds/src-noconflict/mode-fsharp":{id:()=>22024,module:()=>e.A(22024)},"ace-builds/src-noconflict/mode-fsl.js":{id:()=>379068,module:()=>e.A(379068)},"ace-builds/src-noconflict/mode-fsl":{id:()=>379068,module:()=>e.A(379068)},"ace-builds/src-noconflict/mode-ftl.js":{id:()=>149985,module:()=>e.A(149985)},"ace-builds/src-noconflict/mode-ftl":{id:()=>149985,module:()=>e.A(149985)},"ace-builds/src-noconflict/mode-gcode.js":{id:()=>551075,module:()=>e.A(551075)},"ace-builds/src-noconflict/mode-gcode":{id:()=>551075,module:()=>e.A(551075)},"ace-builds/src-noconflict/mode-gherkin.js":{id:()=>390972,module:()=>e.A(390972)},"ace-builds/src-noconflict/mode-gherkin":{id:()=>390972,module:()=>e.A(390972)},"ace-builds/src-noconflict/mode-gitignore.js":{id:()=>186730,module:()=>e.A(186730)},"ace-builds/src-noconflict/mode-gitignore":{id:()=>186730,module:()=>e.A(186730)},"ace-builds/src-noconflict/mode-glsl.js":{id:()=>997108,module:()=>e.A(997108)},"ace-builds/src-noconflict/mode-glsl":{id:()=>997108,module:()=>e.A(997108)},"ace-builds/src-noconflict/mode-gobstones.js":{id:()=>804317,module:()=>e.A(804317)},"ace-builds/src-noconflict/mode-gobstones":{id:()=>804317,module:()=>e.A(804317)},"ace-builds/src-noconflict/mode-golang.js":{id:()=>462666,module:()=>e.A(462666)},"ace-builds/src-noconflict/mode-golang":{id:()=>462666,module:()=>e.A(462666)},"ace-builds/src-noconflict/mode-graphqlschema.js":{id:()=>83076,module:()=>e.A(83076)},"ace-builds/src-noconflict/mode-graphqlschema":{id:()=>83076,module:()=>e.A(83076)},"ace-builds/src-noconflict/mode-groovy.js":{id:()=>150953,module:()=>e.A(150953)},"ace-builds/src-noconflict/mode-groovy":{id:()=>150953,module:()=>e.A(150953)},"ace-builds/src-noconflict/mode-haml.js":{id:()=>783312,module:()=>e.A(783312)},"ace-builds/src-noconflict/mode-haml":{id:()=>783312,module:()=>e.A(783312)},"ace-builds/src-noconflict/mode-handlebars.js":{id:()=>173800,module:()=>e.A(173800)},"ace-builds/src-noconflict/mode-handlebars":{id:()=>173800,module:()=>e.A(173800)},"ace-builds/src-noconflict/mode-haskell.js":{id:()=>942475,module:()=>e.A(942475)},"ace-builds/src-noconflict/mode-haskell":{id:()=>942475,module:()=>e.A(942475)},"ace-builds/src-noconflict/mode-haskell_cabal.js":{id:()=>973755,module:()=>e.A(973755)},"ace-builds/src-noconflict/mode-haskell_cabal":{id:()=>973755,module:()=>e.A(973755)},"ace-builds/src-noconflict/mode-haxe.js":{id:()=>987746,module:()=>e.A(987746)},"ace-builds/src-noconflict/mode-haxe":{id:()=>987746,module:()=>e.A(987746)},"ace-builds/src-noconflict/mode-hjson.js":{id:()=>119167,module:()=>e.A(119167)},"ace-builds/src-noconflict/mode-hjson":{id:()=>119167,module:()=>e.A(119167)},"ace-builds/src-noconflict/mode-html.js":{id:()=>31590,module:()=>e.A(31590)},"ace-builds/src-noconflict/mode-html_elixir.js":{id:()=>534977,module:()=>e.A(534977)},"ace-builds/src-noconflict/mode-html_elixir":{id:()=>534977,module:()=>e.A(534977)},"ace-builds/src-noconflict/mode-html_ruby.js":{id:()=>140790,module:()=>e.A(140790)},"ace-builds/src-noconflict/mode-html_ruby":{id:()=>140790,module:()=>e.A(140790)},"ace-builds/src-noconflict/mode-ini.js":{id:()=>927759,module:()=>e.A(927759)},"ace-builds/src-noconflict/mode-ini":{id:()=>927759,module:()=>e.A(927759)},"ace-builds/src-noconflict/mode-io.js":{id:()=>887205,module:()=>e.A(887205)},"ace-builds/src-noconflict/mode-io":{id:()=>887205,module:()=>e.A(887205)},"ace-builds/src-noconflict/mode-ion.js":{id:()=>143437,module:()=>e.A(143437)},"ace-builds/src-noconflict/mode-ion":{id:()=>143437,module:()=>e.A(143437)},"ace-builds/src-noconflict/mode-jack.js":{id:()=>481520,module:()=>e.A(481520)},"ace-builds/src-noconflict/mode-jack":{id:()=>481520,module:()=>e.A(481520)},"ace-builds/src-noconflict/mode-jade.js":{id:()=>526510,module:()=>e.A(526510)},"ace-builds/src-noconflict/mode-jade":{id:()=>526510,module:()=>e.A(526510)},"ace-builds/src-noconflict/mode-java.js":{id:()=>105251,module:()=>e.A(105251)},"ace-builds/src-noconflict/mode-java":{id:()=>105251,module:()=>e.A(105251)},"ace-builds/src-noconflict/mode-javascript.js":{id:()=>395377,module:()=>e.A(395377)},"ace-builds/src-noconflict/mode-javascript":{id:()=>395377,module:()=>e.A(395377)},"ace-builds/src-noconflict/mode-jexl.js":{id:()=>726931,module:()=>e.A(726931)},"ace-builds/src-noconflict/mode-jexl":{id:()=>726931,module:()=>e.A(726931)},"ace-builds/src-noconflict/mode-json.js":{id:()=>704269,module:()=>e.A(704269)},"ace-builds/src-noconflict/mode-json":{id:()=>704269,module:()=>e.A(704269)},"ace-builds/src-noconflict/mode-json5.js":{id:()=>171958,module:()=>e.A(171958)},"ace-builds/src-noconflict/mode-json5":{id:()=>171958,module:()=>e.A(171958)},"ace-builds/src-noconflict/mode-jsoniq.js":{id:()=>180808,module:()=>e.A(180808)},"ace-builds/src-noconflict/mode-jsoniq":{id:()=>180808,module:()=>e.A(180808)},"ace-builds/src-noconflict/mode-jsp.js":{id:()=>769994,module:()=>e.A(769994)},"ace-builds/src-noconflict/mode-jsp":{id:()=>769994,module:()=>e.A(769994)},"ace-builds/src-noconflict/mode-jssm.js":{id:()=>82973,module:()=>e.A(82973)},"ace-builds/src-noconflict/mode-jssm":{id:()=>82973,module:()=>e.A(82973)},"ace-builds/src-noconflict/mode-jsx.js":{id:()=>514800,module:()=>e.A(514800)},"ace-builds/src-noconflict/mode-jsx":{id:()=>514800,module:()=>e.A(514800)},"ace-builds/src-noconflict/mode-julia.js":{id:()=>296342,module:()=>e.A(296342)},"ace-builds/src-noconflict/mode-julia":{id:()=>296342,module:()=>e.A(296342)},"ace-builds/src-noconflict/mode-kotlin.js":{id:()=>277386,module:()=>e.A(277386)},"ace-builds/src-noconflict/mode-kotlin":{id:()=>277386,module:()=>e.A(277386)},"ace-builds/src-noconflict/mode-latex.js":{id:()=>16790,module:()=>e.A(16790)},"ace-builds/src-noconflict/mode-latex":{id:()=>16790,module:()=>e.A(16790)},"ace-builds/src-noconflict/mode-latte.js":{id:()=>349081,module:()=>e.A(349081)},"ace-builds/src-noconflict/mode-latte":{id:()=>349081,module:()=>e.A(349081)},"ace-builds/src-noconflict/mode-less.js":{id:()=>231864,module:()=>e.A(231864)},"ace-builds/src-noconflict/mode-less":{id:()=>231864,module:()=>e.A(231864)},"ace-builds/src-noconflict/mode-liquid.js":{id:()=>924337,module:()=>e.A(924337)},"ace-builds/src-noconflict/mode-liquid":{id:()=>924337,module:()=>e.A(924337)},"ace-builds/src-noconflict/mode-lisp.js":{id:()=>635998,module:()=>e.A(635998)},"ace-builds/src-noconflict/mode-lisp":{id:()=>635998,module:()=>e.A(635998)},"ace-builds/src-noconflict/mode-livescript.js":{id:()=>839371,module:()=>e.A(839371)},"ace-builds/src-noconflict/mode-livescript":{id:()=>839371,module:()=>e.A(839371)},"ace-builds/src-noconflict/mode-logiql.js":{id:()=>355204,module:()=>e.A(355204)},"ace-builds/src-noconflict/mode-logiql":{id:()=>355204,module:()=>e.A(355204)},"ace-builds/src-noconflict/mode-logtalk.js":{id:()=>490976,module:()=>e.A(490976)},"ace-builds/src-noconflict/mode-logtalk":{id:()=>490976,module:()=>e.A(490976)},"ace-builds/src-noconflict/mode-lsl.js":{id:()=>493850,module:()=>e.A(493850)},"ace-builds/src-noconflict/mode-lsl":{id:()=>493850,module:()=>e.A(493850)},"ace-builds/src-noconflict/mode-lua.js":{id:()=>149810,module:()=>e.A(149810)},"ace-builds/src-noconflict/mode-lua":{id:()=>149810,module:()=>e.A(149810)},"ace-builds/src-noconflict/mode-luapage.js":{id:()=>622468,module:()=>e.A(622468)},"ace-builds/src-noconflict/mode-luapage":{id:()=>622468,module:()=>e.A(622468)},"ace-builds/src-noconflict/mode-lucene.js":{id:()=>702385,module:()=>e.A(702385)},"ace-builds/src-noconflict/mode-lucene":{id:()=>702385,module:()=>e.A(702385)},"ace-builds/src-noconflict/mode-makefile.js":{id:()=>747094,module:()=>e.A(747094)},"ace-builds/src-noconflict/mode-makefile":{id:()=>747094,module:()=>e.A(747094)},"ace-builds/src-noconflict/mode-markdown.js":{id:()=>667925,module:()=>e.A(667925)},"ace-builds/src-noconflict/mode-markdown":{id:()=>667925,module:()=>e.A(667925)},"ace-builds/src-noconflict/mode-mask.js":{id:()=>32988,module:()=>e.A(32988)},"ace-builds/src-noconflict/mode-mask":{id:()=>32988,module:()=>e.A(32988)},"ace-builds/src-noconflict/mode-matlab.js":{id:()=>503254,module:()=>e.A(503254)},"ace-builds/src-noconflict/mode-matlab":{id:()=>503254,module:()=>e.A(503254)},"ace-builds/src-noconflict/mode-maze.js":{id:()=>235460,module:()=>e.A(235460)},"ace-builds/src-noconflict/mode-maze":{id:()=>235460,module:()=>e.A(235460)},"ace-builds/src-noconflict/mode-mediawiki.js":{id:()=>429876,module:()=>e.A(429876)},"ace-builds/src-noconflict/mode-mediawiki":{id:()=>429876,module:()=>e.A(429876)},"ace-builds/src-noconflict/mode-mel.js":{id:()=>429250,module:()=>e.A(429250)},"ace-builds/src-noconflict/mode-mel":{id:()=>429250,module:()=>e.A(429250)},"ace-builds/src-noconflict/mode-mips.js":{id:()=>816718,module:()=>e.A(816718)},"ace-builds/src-noconflict/mode-mips":{id:()=>816718,module:()=>e.A(816718)},"ace-builds/src-noconflict/mode-mixal.js":{id:()=>436040,module:()=>e.A(436040)},"ace-builds/src-noconflict/mode-mixal":{id:()=>436040,module:()=>e.A(436040)},"ace-builds/src-noconflict/mode-mushcode.js":{id:()=>807390,module:()=>e.A(807390)},"ace-builds/src-noconflict/mode-mushcode":{id:()=>807390,module:()=>e.A(807390)},"ace-builds/src-noconflict/mode-mysql.js":{id:()=>877006,module:()=>e.A(877006)},"ace-builds/src-noconflict/mode-mysql":{id:()=>877006,module:()=>e.A(877006)},"ace-builds/src-noconflict/mode-nasal.js":{id:()=>974210,module:()=>e.A(974210)},"ace-builds/src-noconflict/mode-nasal":{id:()=>974210,module:()=>e.A(974210)},"ace-builds/src-noconflict/mode-nginx.js":{id:()=>658726,module:()=>e.A(658726)},"ace-builds/src-noconflict/mode-nginx":{id:()=>658726,module:()=>e.A(658726)},"ace-builds/src-noconflict/mode-nim.js":{id:()=>125429,module:()=>e.A(125429)},"ace-builds/src-noconflict/mode-nim":{id:()=>125429,module:()=>e.A(125429)},"ace-builds/src-noconflict/mode-nix.js":{id:()=>111342,module:()=>e.A(111342)},"ace-builds/src-noconflict/mode-nix":{id:()=>111342,module:()=>e.A(111342)},"ace-builds/src-noconflict/mode-nsis.js":{id:()=>229698,module:()=>e.A(229698)},"ace-builds/src-noconflict/mode-nsis":{id:()=>229698,module:()=>e.A(229698)},"ace-builds/src-noconflict/mode-nunjucks.js":{id:()=>221198,module:()=>e.A(221198)},"ace-builds/src-noconflict/mode-nunjucks":{id:()=>221198,module:()=>e.A(221198)},"ace-builds/src-noconflict/mode-objectivec.js":{id:()=>394877,module:()=>e.A(394877)},"ace-builds/src-noconflict/mode-objectivec":{id:()=>394877,module:()=>e.A(394877)},"ace-builds/src-noconflict/mode-ocaml.js":{id:()=>982032,module:()=>e.A(982032)},"ace-builds/src-noconflict/mode-ocaml":{id:()=>982032,module:()=>e.A(982032)},"ace-builds/src-noconflict/mode-odin.js":{id:()=>388381,module:()=>e.A(388381)},"ace-builds/src-noconflict/mode-odin":{id:()=>388381,module:()=>e.A(388381)},"ace-builds/src-noconflict/mode-partiql.js":{id:()=>80045,module:()=>e.A(80045)},"ace-builds/src-noconflict/mode-partiql":{id:()=>80045,module:()=>e.A(80045)},"ace-builds/src-noconflict/mode-pascal.js":{id:()=>473174,module:()=>e.A(473174)},"ace-builds/src-noconflict/mode-pascal":{id:()=>473174,module:()=>e.A(473174)},"ace-builds/src-noconflict/mode-perl.js":{id:()=>439558,module:()=>e.A(439558)},"ace-builds/src-noconflict/mode-perl":{id:()=>439558,module:()=>e.A(439558)},"ace-builds/src-noconflict/mode-pgsql.js":{id:()=>961098,module:()=>e.A(961098)},"ace-builds/src-noconflict/mode-pgsql":{id:()=>961098,module:()=>e.A(961098)},"ace-builds/src-noconflict/mode-php.js":{id:()=>510660,module:()=>e.A(510660)},"ace-builds/src-noconflict/mode-php":{id:()=>510660,module:()=>e.A(510660)},"ace-builds/src-noconflict/mode-php_laravel_blade.js":{id:()=>193850,module:()=>e.A(193850)},"ace-builds/src-noconflict/mode-php_laravel_blade":{id:()=>193850,module:()=>e.A(193850)},"ace-builds/src-noconflict/mode-pig.js":{id:()=>785033,module:()=>e.A(785033)},"ace-builds/src-noconflict/mode-pig":{id:()=>785033,module:()=>e.A(785033)},"ace-builds/src-noconflict/mode-plain_text.js":{id:()=>265274,module:()=>e.A(265274)},"ace-builds/src-noconflict/mode-plain_text":{id:()=>265274,module:()=>e.A(265274)},"ace-builds/src-noconflict/mode-plsql.js":{id:()=>646531,module:()=>e.A(646531)},"ace-builds/src-noconflict/mode-plsql":{id:()=>646531,module:()=>e.A(646531)},"ace-builds/src-noconflict/mode-powershell.js":{id:()=>793456,module:()=>e.A(793456)},"ace-builds/src-noconflict/mode-powershell":{id:()=>793456,module:()=>e.A(793456)},"ace-builds/src-noconflict/mode-praat.js":{id:()=>125846,module:()=>e.A(125846)},"ace-builds/src-noconflict/mode-praat":{id:()=>125846,module:()=>e.A(125846)},"ace-builds/src-noconflict/mode-prisma.js":{id:()=>868318,module:()=>e.A(868318)},"ace-builds/src-noconflict/mode-prisma":{id:()=>868318,module:()=>e.A(868318)},"ace-builds/src-noconflict/mode-prolog.js":{id:()=>552378,module:()=>e.A(552378)},"ace-builds/src-noconflict/mode-prolog":{id:()=>552378,module:()=>e.A(552378)},"ace-builds/src-noconflict/mode-properties.js":{id:()=>135480,module:()=>e.A(135480)},"ace-builds/src-noconflict/mode-properties":{id:()=>135480,module:()=>e.A(135480)},"ace-builds/src-noconflict/mode-protobuf.js":{id:()=>625637,module:()=>e.A(625637)},"ace-builds/src-noconflict/mode-protobuf":{id:()=>625637,module:()=>e.A(625637)},"ace-builds/src-noconflict/mode-prql.js":{id:()=>686557,module:()=>e.A(686557)},"ace-builds/src-noconflict/mode-prql":{id:()=>686557,module:()=>e.A(686557)},"ace-builds/src-noconflict/mode-puppet.js":{id:()=>665821,module:()=>e.A(665821)},"ace-builds/src-noconflict/mode-puppet":{id:()=>665821,module:()=>e.A(665821)},"ace-builds/src-noconflict/mode-python.js":{id:()=>550894,module:()=>e.A(550894)},"ace-builds/src-noconflict/mode-qml.js":{id:()=>18512,module:()=>e.A(18512)},"ace-builds/src-noconflict/mode-qml":{id:()=>18512,module:()=>e.A(18512)},"ace-builds/src-noconflict/mode-r.js":{id:()=>77412,module:()=>e.A(77412)},"ace-builds/src-noconflict/mode-raku.js":{id:()=>667365,module:()=>e.A(667365)},"ace-builds/src-noconflict/mode-raku":{id:()=>667365,module:()=>e.A(667365)},"ace-builds/src-noconflict/mode-razor.js":{id:()=>716595,module:()=>e.A(716595)},"ace-builds/src-noconflict/mode-razor":{id:()=>716595,module:()=>e.A(716595)},"ace-builds/src-noconflict/mode-rdoc.js":{id:()=>653746,module:()=>e.A(653746)},"ace-builds/src-noconflict/mode-rdoc":{id:()=>653746,module:()=>e.A(653746)},"ace-builds/src-noconflict/mode-red.js":{id:()=>2780,module:()=>e.A(2780)},"ace-builds/src-noconflict/mode-red":{id:()=>2780,module:()=>e.A(2780)},"ace-builds/src-noconflict/mode-redshift.js":{id:()=>72181,module:()=>e.A(72181)},"ace-builds/src-noconflict/mode-redshift":{id:()=>72181,module:()=>e.A(72181)},"ace-builds/src-noconflict/mode-rhtml.js":{id:()=>680732,module:()=>e.A(680732)},"ace-builds/src-noconflict/mode-rhtml":{id:()=>680732,module:()=>e.A(680732)},"ace-builds/src-noconflict/mode-robot.js":{id:()=>842217,module:()=>e.A(842217)},"ace-builds/src-noconflict/mode-robot":{id:()=>842217,module:()=>e.A(842217)},"ace-builds/src-noconflict/mode-rst.js":{id:()=>323259,module:()=>e.A(323259)},"ace-builds/src-noconflict/mode-rst":{id:()=>323259,module:()=>e.A(323259)},"ace-builds/src-noconflict/mode-ruby.js":{id:()=>224067,module:()=>e.A(224067)},"ace-builds/src-noconflict/mode-ruby":{id:()=>224067,module:()=>e.A(224067)},"ace-builds/src-noconflict/mode-rust.js":{id:()=>5076,module:()=>e.A(5076)},"ace-builds/src-noconflict/mode-rust":{id:()=>5076,module:()=>e.A(5076)},"ace-builds/src-noconflict/mode-sac.js":{id:()=>513232,module:()=>e.A(513232)},"ace-builds/src-noconflict/mode-sac":{id:()=>513232,module:()=>e.A(513232)},"ace-builds/src-noconflict/mode-sass.js":{id:()=>378923,module:()=>e.A(378923)},"ace-builds/src-noconflict/mode-sass":{id:()=>378923,module:()=>e.A(378923)},"ace-builds/src-noconflict/mode-scad.js":{id:()=>580887,module:()=>e.A(580887)},"ace-builds/src-noconflict/mode-scad":{id:()=>580887,module:()=>e.A(580887)},"ace-builds/src-noconflict/mode-scala.js":{id:()=>887992,module:()=>e.A(887992)},"ace-builds/src-noconflict/mode-scala":{id:()=>887992,module:()=>e.A(887992)},"ace-builds/src-noconflict/mode-scheme.js":{id:()=>540373,module:()=>e.A(540373)},"ace-builds/src-noconflict/mode-scheme":{id:()=>540373,module:()=>e.A(540373)},"ace-builds/src-noconflict/mode-scrypt.js":{id:()=>7217,module:()=>e.A(7217)},"ace-builds/src-noconflict/mode-scrypt":{id:()=>7217,module:()=>e.A(7217)},"ace-builds/src-noconflict/mode-scss.js":{id:()=>451443,module:()=>e.A(451443)},"ace-builds/src-noconflict/mode-scss":{id:()=>451443,module:()=>e.A(451443)},"ace-builds/src-noconflict/mode-sh.js":{id:()=>203109,module:()=>e.A(203109)},"ace-builds/src-noconflict/mode-sh":{id:()=>203109,module:()=>e.A(203109)},"ace-builds/src-noconflict/mode-sjs.js":{id:()=>294612,module:()=>e.A(294612)},"ace-builds/src-noconflict/mode-sjs":{id:()=>294612,module:()=>e.A(294612)},"ace-builds/src-noconflict/mode-slim.js":{id:()=>134246,module:()=>e.A(134246)},"ace-builds/src-noconflict/mode-slim":{id:()=>134246,module:()=>e.A(134246)},"ace-builds/src-noconflict/mode-smarty.js":{id:()=>349403,module:()=>e.A(349403)},"ace-builds/src-noconflict/mode-smarty":{id:()=>349403,module:()=>e.A(349403)},"ace-builds/src-noconflict/mode-smithy.js":{id:()=>116638,module:()=>e.A(116638)},"ace-builds/src-noconflict/mode-smithy":{id:()=>116638,module:()=>e.A(116638)},"ace-builds/src-noconflict/mode-snippets.js":{id:()=>92085,module:()=>e.A(92085)},"ace-builds/src-noconflict/mode-snippets":{id:()=>92085,module:()=>e.A(92085)},"ace-builds/src-noconflict/mode-soy_template.js":{id:()=>733253,module:()=>e.A(733253)},"ace-builds/src-noconflict/mode-soy_template":{id:()=>733253,module:()=>e.A(733253)},"ace-builds/src-noconflict/mode-space.js":{id:()=>452268,module:()=>e.A(452268)},"ace-builds/src-noconflict/mode-space":{id:()=>452268,module:()=>e.A(452268)},"ace-builds/src-noconflict/mode-sparql.js":{id:()=>85189,module:()=>e.A(85189)},"ace-builds/src-noconflict/mode-sparql":{id:()=>85189,module:()=>e.A(85189)},"ace-builds/src-noconflict/mode-sql.js":{id:()=>976485,module:()=>e.A(976485)},"ace-builds/src-noconflict/mode-sqlserver.js":{id:()=>995750,module:()=>e.A(995750)},"ace-builds/src-noconflict/mode-sqlserver":{id:()=>995750,module:()=>e.A(995750)},"ace-builds/src-noconflict/mode-stylus.js":{id:()=>678097,module:()=>e.A(678097)},"ace-builds/src-noconflict/mode-stylus":{id:()=>678097,module:()=>e.A(678097)},"ace-builds/src-noconflict/mode-svg.js":{id:()=>391074,module:()=>e.A(391074)},"ace-builds/src-noconflict/mode-svg":{id:()=>391074,module:()=>e.A(391074)},"ace-builds/src-noconflict/mode-swift.js":{id:()=>821835,module:()=>e.A(821835)},"ace-builds/src-noconflict/mode-swift":{id:()=>821835,module:()=>e.A(821835)},"ace-builds/src-noconflict/mode-tcl.js":{id:()=>449342,module:()=>e.A(449342)},"ace-builds/src-noconflict/mode-tcl":{id:()=>449342,module:()=>e.A(449342)},"ace-builds/src-noconflict/mode-terraform.js":{id:()=>90,module:()=>e.A(90)},"ace-builds/src-noconflict/mode-terraform":{id:()=>90,module:()=>e.A(90)},"ace-builds/src-noconflict/mode-tex.js":{id:()=>167718,module:()=>e.A(167718)},"ace-builds/src-noconflict/mode-tex":{id:()=>167718,module:()=>e.A(167718)},"ace-builds/src-noconflict/mode-text.js":{id:()=>7633,module:()=>e.A(7633)},"ace-builds/src-noconflict/mode-text":{id:()=>7633,module:()=>e.A(7633)},"ace-builds/src-noconflict/mode-textile.js":{id:()=>88683,module:()=>e.A(88683)},"ace-builds/src-noconflict/mode-textile":{id:()=>88683,module:()=>e.A(88683)},"ace-builds/src-noconflict/mode-toml.js":{id:()=>558159,module:()=>e.A(558159)},"ace-builds/src-noconflict/mode-toml":{id:()=>558159,module:()=>e.A(558159)},"ace-builds/src-noconflict/mode-tsv.js":{id:()=>261104,module:()=>e.A(261104)},"ace-builds/src-noconflict/mode-tsv":{id:()=>261104,module:()=>e.A(261104)},"ace-builds/src-noconflict/mode-tsx.js":{id:()=>458267,module:()=>e.A(458267)},"ace-builds/src-noconflict/mode-tsx":{id:()=>458267,module:()=>e.A(458267)},"ace-builds/src-noconflict/mode-turtle.js":{id:()=>528765,module:()=>e.A(528765)},"ace-builds/src-noconflict/mode-turtle":{id:()=>528765,module:()=>e.A(528765)},"ace-builds/src-noconflict/mode-twig.js":{id:()=>633478,module:()=>e.A(633478)},"ace-builds/src-noconflict/mode-twig":{id:()=>633478,module:()=>e.A(633478)},"ace-builds/src-noconflict/mode-typescript.js":{id:()=>342429,module:()=>e.A(342429)},"ace-builds/src-noconflict/mode-typescript":{id:()=>342429,module:()=>e.A(342429)},"ace-builds/src-noconflict/mode-vala.js":{id:()=>180022,module:()=>e.A(180022)},"ace-builds/src-noconflict/mode-vala":{id:()=>180022,module:()=>e.A(180022)},"ace-builds/src-noconflict/mode-vbscript.js":{id:()=>948675,module:()=>e.A(948675)},"ace-builds/src-noconflict/mode-vbscript":{id:()=>948675,module:()=>e.A(948675)},"ace-builds/src-noconflict/mode-velocity.js":{id:()=>325580,module:()=>e.A(325580)},"ace-builds/src-noconflict/mode-velocity":{id:()=>325580,module:()=>e.A(325580)},"ace-builds/src-noconflict/mode-verilog.js":{id:()=>773599,module:()=>e.A(773599)},"ace-builds/src-noconflict/mode-verilog":{id:()=>773599,module:()=>e.A(773599)},"ace-builds/src-noconflict/mode-vhdl.js":{id:()=>626942,module:()=>e.A(626942)},"ace-builds/src-noconflict/mode-vhdl":{id:()=>626942,module:()=>e.A(626942)},"ace-builds/src-noconflict/mode-visualforce.js":{id:()=>688106,module:()=>e.A(688106)},"ace-builds/src-noconflict/mode-visualforce":{id:()=>688106,module:()=>e.A(688106)},"ace-builds/src-noconflict/mode-vue.js":{id:()=>546363,module:()=>e.A(546363)},"ace-builds/src-noconflict/mode-vue":{id:()=>546363,module:()=>e.A(546363)},"ace-builds/src-noconflict/mode-wollok.js":{id:()=>505813,module:()=>e.A(505813)},"ace-builds/src-noconflict/mode-wollok":{id:()=>505813,module:()=>e.A(505813)},"ace-builds/src-noconflict/mode-xml.js":{id:()=>428050,module:()=>e.A(428050)},"ace-builds/src-noconflict/mode-xml":{id:()=>428050,module:()=>e.A(428050)},"ace-builds/src-noconflict/mode-xquery.js":{id:()=>246574,module:()=>e.A(246574)},"ace-builds/src-noconflict/mode-xquery":{id:()=>246574,module:()=>e.A(246574)},"ace-builds/src-noconflict/mode-yaml.js":{id:()=>891933,module:()=>e.A(891933)},"ace-builds/src-noconflict/mode-yaml":{id:()=>891933,module:()=>e.A(891933)},"ace-builds/src-noconflict/mode-zeek.js":{id:()=>785853,module:()=>e.A(785853)},"ace-builds/src-noconflict/mode-zeek":{id:()=>785853,module:()=>e.A(785853)},"ace-builds/src-noconflict/mode-zig.js":{id:()=>328698,module:()=>e.A(328698)},"ace-builds/src-noconflict/mode-zig":{id:()=>328698,module:()=>e.A(328698)}}).import(`ace-builds/src-noconflict/mode-${t}`),u(t)}catch(e){u("txt")}})("create_html_component"===l.name||"modify_html_component"===l.name?"html":"bigquery_query"===l.name||"postgres_query"===l.name||"snowflake_query"===l.name||"google_ads_query"===l.name?"sql":"python")},[l]),(0,s.jsx)("div",{className:(0,w.cn)("relative opacity-50 flex-shrink-0 py-0.5",o?"h-full":"h-fit"),children:(0,s.jsx)(eL.default,{ref:a,mode:d,theme:"dark"===c?"cloud9_night":"cloud9_day",name:`${i}_code_${l.messageId}`,value:l.content||"",readOnly:!0,width:"100%",minLines:1,maxLines:6,fontSize:n,showPrintMargin:!1,showGutter:!1,highlightActiveLine:!1,editorProps:{$blockScrolling:!0},setOptions:{wrap:!0,displayIndentGuides:!1,showFoldWidgets:!1,useWorker:!1,scrollPastEnd:!1},className:"!bg-transparent ace-transparent h-full",onLoad:e=>{try{e.gotoLine(e.session.getLength(),0,!0);let s=()=>{l.inProgress&&e.scrollToLine(1/0,!0,!0,()=>{})};r.current=s,e.on("change",s)}catch{}}})})};var eO=e.i(475254);let eq=(0,eO.default)("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);var eF=e.i(589342),e$=e.i(758472),ez=e.i(22165),eU=e.i(794527),eB=e.i(373375),eH=e.i(743687),eV=e.i(269035),eG=e.i(805387),eQ=e.i(178583),eW=e.i(473708);let eJ={table:ez.TableProperties,julius_table:V.Table2,image:eW.Image,text:eQ.FileText,html:e$.Code},eK={table:"View table",julius_table:"View table",image:"View image",text:"View text",html:"View HTML"},eY=(0,t.forwardRef)(({type:e,onClick:t,active:l,...o},i)=>{let n=eJ[e];return(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsxs)("button",{ref:i,onClick:t,"data-event":"code-output-item-click",className:(0,w.cn)("group/item inline-flex flex-row relative rounded-lg items-center min-w-[164px]","bg-gray-100 border border-gray-200  transition-colors focus:outline-none focus:ring-none duration-200 overflow-hidden","dark:bg-neutral-800 dark:border-neutral-700",l?"border-gray-600 dark:border-neutral-400":" hover:border-gray-300 dark:hover:border-neutral-600"),...o,children:[(0,s.jsx)("div",{className:(0,w.cn)("flex items-center justify-center h-full w-14 transition-colors bg-gray-200 px-2 border-r border-gray-200 ","dark:bg-neutral-900 dark:border-neutral-700 ",l?"border-gray-400 dark:border-neutral-400":"group-hover/item:border-gray-300 group-hover/item:dark:border-neutral-600"),children:(0,s.jsx)(n,{size:24,className:(0,w.cn)("text-muted-secondary",l&&"text-muted-foreground"),absoluteStrokeWidth:!0})}),(0,s.jsxs)("div",{className:"flex flex-col h-full items-start p-2 flex-1",children:[(0,s.jsx)("span",{className:"text-foreground text-sm font-medium capitalize",children:eC(e)}),(0,s.jsx)("span",{className:"text-xs font-light text-muted-foreground",children:"Click to view"})]})]})}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsx)("p",{children:eK[e]})})]})});function eX({children:e,collection:l,responseObj:o,messageId:i,conversationId:n}){let[a,r]=(0,t.useState)(null),{totalLength:c,currentContent:d}=(0,t.useMemo)(()=>{if(!a)return{totalLength:0,currentContent:null};let{type:e,index:s}=a,t=l[e][s];return{totalLength:Object.values(l).reduce((e,s)=>e+s.length,0),currentContent:t.map(s=>"table"===e||"julius_table"===e||"text"===e?(0,f.replaceOutputsAndImagesFromGlobalDicts)(`{outputs_dict['${s}']}`,i):"image"===e?(0,f.replaceOutputsAndImagesFromGlobalDicts)(`{image_url_dict['${s}']}`,i):"html"===e?o.html_elements:"")}},[a,l,i,o]),u=e=>{if(!a)return;let{type:s,index:t}=a;if(1===e&&l[s][t+1]){r({type:s,index:t+1}),eS(s,t+1);return}if(-1===e&&t>0){r({type:s,index:t-1}),eS(s,t-1);return}let o=Object.keys(l),i=o.indexOf(s),n=(o.length+i+e)%o.length,c=o[n],d=1===e?0:l[c].length-1;r({type:c,index:d}),eS(c,d)};return(0,s.jsxs)(eU.Drawer.Root,{direction:"right",handleOnly:!0,autoFocus:!0,onOpenChange:e=>{e&&ed.default.capture("code-output-drawer-open",{type:a?.type}),e||r(null)},children:[e({select:r,state:a}),(0,s.jsxs)(eU.Drawer.Portal,{children:[(0,s.jsx)(eU.Drawer.Overlay,{className:"fixed inset-0 bg-black/40"}),(0,s.jsx)(eU.Drawer.Content,{className:"right-2 top-2 bottom-2 fixed z-10 outline-none max-w-screen-lg flex overflow-hidden",style:{"--initial-transform":"calc(100% + 8px)",width:"calc(100% - 16px)"},children:(0,s.jsxs)("div",{className:" bg-sidesecondary h-full w-full grow flex flex-col border border-input rounded-2xl overflow-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 px-4",children:[c>1&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(p.Button,{size:"icon",variant:"outline","data-event":"code-output-previous-item-click",className:"flex flex-shrink-0 items-center justify-center rounded-full w-9 h-9 active:scale-95",onClick:()=>u(-1),children:(0,s.jsx)(eB.ChevronLeft,{size:16,className:"w-5 h-5"})})}),(0,s.jsx)(g.TooltipContent,{children:"Previous"})]}),(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(p.Button,{size:"icon",variant:"outline","data-event":"code-output-next-item-click",className:"flex flex-shrink-0 items-center justify-center rounded-full w-9 h-9 p-0 active:scale-95",onClick:()=>u(1),children:(0,s.jsx)(ej.ChevronRight,{size:16,className:"w-5 h-5"})})}),(0,s.jsx)(g.TooltipContent,{children:"Next"})]})]}),(0,s.jsx)("div",{className:"flex flex-nowrap overflow-x-auto gap-2 w-full py-3",children:Object.entries(l).map(([e,t])=>t.map((t,l)=>(0,s.jsx)(eY,{"data-type":e,"data-index":l,active:a?.type===e&&a?.index===l,type:e,onClick:()=>r({type:e,index:l})},t.join("-"))))}),(0,s.jsx)(eU.Drawer.Close,{asChild:!0,children:(0,s.jsx)(p.Button,{size:"icon",variant:"outline",className:"flex flex-shrink-0 items-center justify-center rounded-full w-9 h-9 p-0 active:scale-95",children:(0,s.jsx)(G.X,{size:16,className:"w-5 h-5"})})})]}),(0,s.jsx)(eV.Separator,{}),(0,s.jsx)(eG.VisuallyHidden,{children:(0,s.jsxs)("div",{className:"p-5 rounded-b border-t border-input rounded-2xl bg-background",children:[(0,s.jsx)("div",{className:"flex items-center justify-between ",children:(0,s.jsxs)(eH.DrawerTitle,{className:"px-4 text-2xl capitalize",children:[eC(a?.type)," Output"]})}),(0,s.jsxs)(eH.DrawerDescription,{children:[a?.type," output content"]})]})}),(0,s.jsx)("div",{className:"flex flex-1 flex-col overflow-auto w-full p-4 pt-1 bg-background",children:d&&d.map((e,t)=>Array.isArray(e)?e.map((e,t)=>(0,s.jsx)(eg,{htmlContent:e,showHeader:!0,messageId:i,htmlIndex:t,conversationId:n},t)):(0,s.jsx)(x.default,{text:e,showCaret:!1,searchResults:!1},t))})]})})]})]})}let eZ={table:ez.TableProperties,julius_table:V.Table2,image:eF.ChartNoAxesCombined,text:eq,html:e$.Code},e0=({responseObj:e,messageId:o="",collection:i,renderMode:n="type_counts",chipVariant:a="card",orderedItems:r,className:c})=>{let{activeConversationId:d}=(0,b.useChatContext)(),u=(0,t.useMemo)(()=>i||(e?ek(e,d):void 0),[d,i,e]);if((0,t.useMemo)(()=>r,[r]),!u)return null;let m=(0,w.cn)("inline-flex items-center gap-1","card"===a?"p-1.5 rounded-md bg-background dark:bg-message/50 hover:bg-message shadow-subtle text-xs border border-border text-muted-secondary":"p-1 rounded-md text-[11px] hover:bg-message text-sm font-normal text-muted-secondary");return(0,s.jsx)(eX,{collection:u,responseObj:e,messageId:o,conversationId:d,children:({select:e,state:t})=>(0,s.jsx)("div",{className:(0,w.cn)(`flex w-fit ${"card"===a?"gap-1":"gap-0"}`,c),children:"type_counts"===n&&Object.entries(u).map(([t,o],i)=>{let n=eZ[t],a=o?.length||0;return(0,s.jsx)(eU.Drawer.Trigger,{asChild:!0,children:(0,s.jsxs)("button",{onClick:()=>e({type:t,index:0}),className:m,children:[(0,s.jsx)(n,{size:13,className:"text-muted-secondary"}),(0,s.jsx)(O.AnimatePresence,{initial:!1,mode:"wait",children:(0,s.jsx)("div",{className:"relative overflow-hidden",children:(0,s.jsx)(l.m.span,{initial:{y:8,opacity:0,filter:"blur(2px)"},animate:{y:0,opacity:1,filter:"blur(0px)"},exit:{y:-8,opacity:0,filter:"blur(2px)"},transition:{duration:.25,ease:"easeOut"},className:"flex pr-0.5 leading-none block",children:(0,s.jsx)("span",{children:a})},`${t}-${a}`)})})]})},`${t}-${i}`)})})})},e1=({item:e,isActive:l})=>{let o=(0,t.useRef)(null),i=(0,t.useRef)(!1);return((0,t.useEffect)(()=>{i.current=!1},[e.id]),(0,t.useEffect)(()=>{if("thinking"!==e.kind)return;let s=o.current;if(!s||!e.inProgress)return;s.scrollHeight>s.clientHeight+1?(i.current=!0,s.scrollTop=s.scrollHeight):(i.current=!1,s.scrollTop=0);let t=new MutationObserver(()=>{if(e.inProgress&&o.current){if(!i.current){o.current.scrollHeight>o.current.clientHeight+1&&(i.current=!0,o.current.scrollTop=o.current.scrollHeight);return}o.current.scrollTop=o.current.scrollHeight}});return t.observe(s,{childList:!0,subtree:!0,characterData:!0}),()=>t.disconnect()},[e.id,e.inProgress]),e.content)?(0,s.jsx)("div",{ref:o,className:(0,w.cn)("relative opacity-50 hidden-scrollbar",l?"h-full overflow-y-auto":"max-h-24 overflow-y-auto"),"data-thinking-scroller":!0,children:(0,s.jsx)("div",{className:"text-[12px] text-muted-foreground whitespace-pre-wrap break-words",children:e.content})}):null},e2=({rowKey:e,item:l,isActive:o,hasNextItem:i,isExternallyExpanded:n,onHeaderToggle:a})=>{let[r,c]=(0,t.useState)(!1),d=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{if(o){c(!0),d.current=!0;return}!o&&i&&d.current&&(c(!1),d.current=!1)},[o,i]),(0,t.useEffect)(()=>{o||c(n)},[n,o]),(0,s.jsxs)("div",{className:(0,w.cn)("w-full py-1 flex-shrink-0"),"data-callstack-item":!0,children:[(0,s.jsxs)("div",{role:"button",tabIndex:0,className:(0,w.cn)("flex w-full items-center justify-start gap-2 text-left cursor-pointer select-none"),onClick:()=>a(e),children:[(0,s.jsx)("div",{className:"flex items-center gap-2 min-w-0 max-w-full",children:(0,s.jsx)("span",{className:"text-sm truncate text-muted-secondary pl-0",children:l.title})}),(0,s.jsx)("div",{className:"flex items-center gap-2",onClick:e=>e.stopPropagation(),children:l.outputsResponse&&(0,s.jsx)(e0,{responseObj:l.outputsResponse,messageId:l.messageId,chipVariant:"ghost",renderMode:"type_counts"})})]}),r?(0,s.jsx)("div",{className:(0,w.cn)("mt-1 pl-0 min-h-0 max-h-[150px] overflow-auto"),children:"tool"===l.kind?(0,s.jsx)(eR,{item:l,isActive:o}):"thinking"===l.kind&&l.content?(0,s.jsx)(e1,{item:l,isActive:o}):null}):null]})},e5=(0,t.memo)(({messages:e})=>{let l=(0,t.useMemo)(()=>eM(e||[]),[e]),[o,i]=(0,t.useState)(null),n=(0,t.useRef)(null);return l&&0!==l.length?(0,s.jsx)("div",{ref:n,"aria-label":"Call stack scroll region",className:"flex flex-col w-full min-h-0 !h-fit h-[180px] max-h-[250px] overflow-y-auto overscroll-contain [-webkit-overflow-scrolling:touch] hidden-scrollbar",children:l.map((e,t)=>{let n=l.length-1,a=l[n]?.id,r=e.id,c=t===n&&e.inProgress,d=o===r;return(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(e2,{rowKey:r,item:e,isActive:c,hasNextItem:t<n,isExternallyExpanded:d,onHeaderToggle:e=>{c&&e===a||i(s=>s===e?null:e)}})},r)})}):null});e5.displayName="CallStackList";let e3=(0,t.memo)(({messages:e,variant:o="stream",isActive:i=!1})=>{let{activeConversationId:n,isGenerating:a,generatingStatusMessage:r}=(0,b.useChatContext)(),c=(0,t.useMemo)(()=>eM(e||[]),[e]),d=c.length-1,u=c.findLastIndex?c.findLastIndex(e=>e.inProgress):(()=>{for(let e=c.length-1;e>=0;e--)if(c[e].inProgress)return e;return -1})(),m=c[u>=0?u:d],h=!!r?.stream_result,f=(0,t.useRef)(!1),[x,p]=(0,t.useState)(!1);(0,t.useEffect)(()=>{i&&a&&!f.current&&(f.current=!0,p(!0)),a||(f.current=!1,p(!1))},[i,a]);let g=!!(i&&x&&!h),[j,v]=(0,t.useState)(!1),y=c.length,{aggregatedCollection:A,keyToMessageId:_,orderedItems:N,combinedResponseObj:k}=(0,t.useMemo)(()=>{let e={},s={},t=[],l=[];for(let o of c){if(!o.outputsResponse)continue;o.outputsResponse.html_elements&&l.push(...o.outputsResponse.html_elements);let i=ek(o.outputsResponse,n);if(i)for(let[l,n]of Object.entries(i))for(let i of n){let n=e[l]||(e[l]=[]);n.push(i);let a=n.length-1;for(let e of(t.push({type:l,keys:i,index:a}),i))s[e]=o.messageId}}return{aggregatedCollection:e,keyToMessageId:s,orderedItems:t,combinedResponseObj:c[0]?.outputsResponse?{...c[0].outputsResponse,html_elements:l}:void 0}},[c,n]),C=g?m?.title||"Thinking":`Ran ${y} steps`;return(0,s.jsxs)("div",{className:"w-full overflow-hidden",children:[(0,s.jsx)("div",{className:"relative overflow-hidden w-full justify-between gap-2 flex items-center min-w-0 px-0 py-1",children:(0,s.jsxs)("div",{className:"flex items-center w-full gap-0 !select-none",children:[(0,s.jsx)(O.AnimatePresence,{initial:!1,mode:"popLayout",children:(0,s.jsx)(l.m.div,{initial:{y:24,opacity:0},animate:{y:0,opacity:1},exit:{y:-24,opacity:0},transition:{type:"spring",duration:.2,bounce:0},className:"group flex items-center gap-2 min-w-0 h-6 justify-between cursor-pointer",onClick:()=>v(e=>!e),"aria-expanded":j,children:(0,s.jsx)("span",{className:"flex items-center gap-2 relative overflow-hidden text-sm truncate font-medium text-muted-foreground",children:g?(0,s.jsx)(ev,{as:"span",className:"truncate",duration:1.6,spread:2,children:C}):(0,s.jsx)("span",{className:"truncate",children:C})})},m?.id)}),"stream"===o&&A&&Object.keys(A).length>0&&(0,s.jsx)(e0,{collection:A,getMessageIdForKey:e=>_[e]||m?.messageId,renderMode:"type_counts",chipVariant:"ghost",orderedItems:N,responseObj:k,className:"flex flex-shrink-0 ml-1.5"}),(0,s.jsx)("div",{className:"flex items-center justify-center overflow-hidden w-4 cursor-pointer",onClick:()=>v(e=>!e),children:(0,s.jsx)(ej.ChevronRight,{className:(0,w.cn)("w-3.5 h-3.5 text-muted-secondary opacity-0 group-hover:opacity-100 ease-out transition-all duration-100",j?"rotate-90":"")})})]})}),(0,s.jsx)(O.AnimatePresence,{initial:!1,children:"stream"===o&&!j&&g&&m&&(0,s.jsx)(l.m.div,{initial:{height:0},animate:{height:100},exit:{height:0},transition:{type:"tween",duration:.1},className:"w-full flex flex-col overflow-hidden",children:(0,s.jsx)("div",{className:"pl-0 min-h-0 flex-1 overflow-hidden select-none",children:"tool"===m.kind?(0,s.jsx)(eR,{item:m,isActive:!0}):"thinking"===m.kind&&m.content?(0,s.jsx)(e1,{item:m,isActive:!0}):null})},m.id||"progress")}),(0,s.jsx)(O.AnimatePresence,{children:j&&(c&&0!==c.length?(0,s.jsx)(l.m.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"tween",duration:.2},className:"px-0 bg-background rounded-lg",children:(0,s.jsx)(e5,{messages:e||[]})}):null)}),"output_counts"===o&&(0,s.jsx)(O.AnimatePresence,{children:A&&Object.keys(A).length>0&&!j&&(0,s.jsx)(e0,{collection:A,getMessageIdForKey:e=>_[e]||m?.messageId,renderMode:"type_counts",chipVariant:"card",orderedItems:N})})]})});e3.displayName="SingleCallStack";var e8=e.i(409797),e6=e.i(54131),e4=e.i(626754);let e7=({message:e})=>{let{toggleMessageCollapse:o}=(0,b.useChatContext)(),n=e?.thinking_call?.arguments?.status,[a,r]=(0,t.useState)(!0),c=e?.thinking_call?.arguments?.content;return(0,t.useEffect)(()=>{"complete"===n&&r(!0)},[n]),(0,s.jsxs)("div",{className:(0,w.cn)("box-content mb-3",!a&&"border-border"),children:[(0,s.jsx)("button",{className:(0,w.cn)("flex flex-row w-full gap-2 group justify-between items-center text-muted-foreground outline-0 text-xs","started"===n&&"animate-pulse",a?"rounded-[11px]":"rounded-t-xl"),onClick:()=>{let s=!a;r(s),o&&o(e.message_id,s)},children:(0,s.jsx)("div",{className:"flex flex-row items-center gap-3 truncate flex-1",children:(0,s.jsx)("div",{className:"flex flex-col items-start gap-1 flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 w-full",children:[(0,s.jsx)("div",{className:"pl-[5px] pr-0.5",children:(()=>{switch(n){case"not-started":case"started":return(0,s.jsx)(i.Eye,{className:"w-3.5 h-3.5 text-muted-secondary"});default:return(0,s.jsx)(i.Eye,{className:"w-3.5 h-3.5 text-muted-foreground"})}})()}),(0,s.jsx)("span",{className:(0,w.cn)("text-sm font-normal truncate","started"===n&&"animate-pulse"),children:e?.thinking_call?.arguments?.title}),(0,s.jsx)("div",{className:"flex flex-row items-center gap-2 opacity-0 group-hover:opacity-100",children:a?(0,s.jsx)(e8.ChevronDownIcon,{size:16,className:(0,w.cn)("transition duration-300 text-muted-secondary")}):(0,s.jsx)(e6.ChevronUpIcon,{size:16,className:(0,w.cn)("transition duration-300 text-muted-secondary")})})]})})})}),(0,s.jsx)(O.AnimatePresence,{initial:!1,children:!a&&c&&(0,s.jsx)(l.m.div,{className:"relative overflow-hidden",initial:{height:0},animate:{height:"auto",transition:{duration:.3,ease:"easeInOut"}},exit:{height:0,transition:{duration:.3,ease:"easeInOut"}},children:(0,s.jsx)("div",{className:"py-1",children:(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsx)("div",{className:"pl-6 whitespace-pre-wrap break-words",children:(0,s.jsx)(e4.default,{overrideClassName:"text-sm text-muted-secondary",text:c})})})})})})]})};var e9=e.i(63209),se=e.i(531278),ss=e.i(555436),st=e.i(150509),sl=e.i(671428),so=e.i(174886),si=e.i(741929),sn=e.i(788699),sa=e.i(431343);let sr=(0,eO.default)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var sc=e.i(314141),sd=e.i(556703);e.i(481908),e.i(472792),e.i(283942),e.i(443001);let su=(0,t.memo)(({code:e,codeType:l,messageId:o,isOwner:i,isInProgress:n,toolExplanation:a,fetchingToolExplanation:r})=>{let c=(0,t.useRef)(null),{data:u}=(0,y.useUserInformation)(),[m,h]=(0,t.useState)(!1),[f,x]=(0,t.useState)(e),[v,w]=(0,t.useState)(f),{isGenerating:A}=(0,b.useChatContext)(),{theme:_}=(0,j.useUserContext)();(0,t.useEffect)(()=>{x(e)},[e]);let{editCodeAndGenerateBotResponse:N}=(0,I.useMessageContext)(),k=(0,y.useUpdateUserPreferences)(),C=(0,d.usePathname)(),S=C.includes("/notebooks")||C.includes("/s/notebooks");return(0,t.useEffect)(()=>{let e=c.current,s=()=>{A&&e.editor.scrollToLine(1/0,!0,!0,()=>{})};return e&&e.editor&&e.editor.on("change",s),()=>{e&&e.editor&&e.editor.off("change",s)}},[A]),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-start gap-2 md:flex-row px-3 py-2 md:justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:["r"===l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sd.default,{className:"w-5 h-5"}),(0,s.jsx)("h1",{className:"text-sm font-medium",children:"R"})]}),"python"===l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sc.default,{className:"w-5 h-5"}),(0,s.jsx)("h1",{className:"text-sm font-medium",children:"Python"})]}),"html"===l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(si.FileCode,{className:"w-5 h-5"}),(0,s.jsx)("h1",{className:"text-sm font-medium",children:"HTML"})]})]}),(0,s.jsx)(g.TooltipProvider,{delayDuration:300,children:(0,s.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[!n&&i&&!S&&(0,s.jsxs)("div",{className:"flex flex-row gap-1 justify-center items-center",children:[u?.preferences?.disable_code_autorun&&(0,s.jsx)(p.Button,{size:"xs",variant:"outline",className:"p-1 text-xs",onClick:()=>{eu.toast.info("Autorun code enabled"),k.mutate({disable_code_autorun:!1}),N({content:f,message_id:o}),h(!1)},children:"Enable Autorun Code"}),m?(0,s.jsx)(sm,{autorunCodeOff:u?.preferences?.disable_code_autorun,setEditorContent:x,setEditingCode:h,editorContent:f,messageId:o,lastEditorContent:v}):(0,s.jsx)(sh,{setEditingCode:h,onEditCodeClick:()=>{w(f),h(!0)},editorContent:f,messageId:o})]}),(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{onClick:()=>{(0,en.default)(f),eu.toast.success("Code copied to clipboard")},className:"flex items-center justify-center cursor-pointer text-muted-foreground hover:text-foreground p-1.5 rounded-md transition-colors",children:(0,s.jsx)(so.Copy,{className:"w-4 h-4"})})}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsx)("p",{children:"Copy code"})})]})]})})]}),(0,s.jsx)("div",{className:"bg-message",children:(0,s.jsx)(eL.default,{ref:c,mode:"python",theme:"dark"===_?"cloud9_night":"cloud9_day",name:`code_editor_${o}`,editorProps:{$blockScrolling:!0},value:f,onChange:x,readOnly:!m,fontSize:13,lineHeight:20,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!1,maxLines:10,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2},onLoad:e=>{e.renderer.setScrollMargin(8,8,0,0);let s=e.session.getLength()-1;e.gotoLine(s,0,!0)},width:"100%",height:"100%",className:"min-w-[1rem] min-h-[1rem] border-y border-border ace-transparent"})}),r?(0,s.jsx)(sl.Skeleton,{className:"h-4 w-full"}):a?(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Code Explanation"}),(0,s.jsx)(sf,{text:a,maxLines:2})]}):(0,s.jsx)("div",{className:"h-4 w-full"})]})}),sm=({autorunCodeOff:e,setEditingCode:t,setEditorContent:l,lastEditorContent:o,editorContent:i,messageId:n})=>{let{editCodeAndGenerateBotResponse:a}=(0,I.useMessageContext)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{type:"button",className:"flex gap-1.5 items-center cursor-pointer text-muted-foreground hover:text-foreground hover:bg-foreground/5 px-2 py-1.5 rounded-md transition-colors text-sm","data-event":"clicked_save_edit_code",onClick:()=>{a({content:i,message_id:n}),t(!1)},children:[(0,s.jsx)(sa.Play,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:e?"Run":"Save & Run"})]}),!e&&(0,s.jsxs)("button",{type:"button",className:"flex gap-1.5 items-center cursor-pointer text-muted-foreground hover:text-foreground hover:bg-foreground/5 px-2 py-1.5 rounded-md transition-colors text-sm","data-event":"clicked_cancel_edit_code",onClick:()=>{l(o),t(!1)},children:[(0,s.jsx)(G.X,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Cancel"})]})]})},sh=({setEditingCode:e,editorContent:t,messageId:l,onEditCodeClick:o})=>{let{editCodeAndGenerateBotResponse:i}=(0,I.useMessageContext)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{onClick:()=>{i({content:t,message_id:l}),e(!1)},className:"flex items-center justify-center cursor-pointer text-muted-foreground hover:text-foreground hover:bg-foreground/5 p-1.5 rounded-md transition-colors","data-event":"clicked_edit_code",children:(0,s.jsx)(sr,{className:"w-4 h-4"})})}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsx)("p",{children:"Rerun code"})})]}),(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{onClick:o,className:"flex items-center justify-center cursor-pointer text-muted-foreground hover:text-foreground hover:bg-foreground/5 p-1.5 rounded-md transition-colors","data-event":"clicked_edit_code",children:(0,s.jsx)(sn.Pencil,{className:"w-4 h-4"})})}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsx)("p",{children:"Edit code"})})]})]})},sf=({text:e,maxLines:l=1})=>{let[o,i]=(0,t.useState)(!1),n=(0,t.useRef)(null),[a,r]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let e=()=>{n.current&&r(n.current.scrollHeight>n.current.clientHeight)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[e]),(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsx)("div",{ref:n,className:`overflow-hidden text-sm text-muted-foreground transition-all duration-300 ease-in-out whitespace-pre-wrap ${o?"":`line-clamp-${l}`}`,children:e}),a&&(0,s.jsx)("button",{onClick:()=>i(!o),className:"text-sm text-blue-500 hover:underline focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex-shrink-0",children:o?"Show Less":"Show More"})]})},sx=(0,eO.default)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);var sp=e.i(98991),sg=e.i(10708),sb=e.i(62870);e.i(176078);let sj="__none__";function sv({open:e,onOpenChange:l,sql:o,connectionName:i,messageId:n}){let a=(0,d.useRouter)(),r=(0,d.useSearchParams)().get("id"),c=(0,d.useParams)(),u=(0,t.useMemo)(()=>{if(c&&"object"==typeof c&&"teamId"in c){let e=c.teamId;return Array.isArray(e)?"string"==typeof e[0]?e[0]:void 0:"string"==typeof e?e:void 0}},[c]),{dataConnections:m}=(0,b.useChatContext)(),{theme:h}=(0,j.useUserContext)(),f=(0,t.useMemo)(()=>o?o.replace(/\\([nrt'"\\])/g,(e,s)=>{switch(s){case"n":return"\n";case"r":return"\r";case"t":return"	";case"'":return"'";case'"':return'"';case"\\":return"\\";default:return"\\"+s}}):"",[o]),[x,g]=(0,t.useState)(""),[v,y]=(0,t.useState)(""),[w,A]=(0,t.useState)(sj),_=(0,sp.useCreateDashboardPanel)(),N=(0,sp.useAddPanelToDashboard)(),{data:k,isLoading:C}=(0,sp.useDashboards)({teamId:u,enabled:e}),S=(0,t.useMemo)(()=>{if(!i||!m)return;let e=Object.values(m).find(e=>e.name===i||e.id===i);return e?.id},[i,m]);(0,t.useEffect)(()=>{e&&!x&&g(i?`${i} Query`:`SQL Query ${new Date().toLocaleDateString()}`)},[e,i,x]),(0,t.useEffect)(()=>{e||(g(""),y(""),A(sj))},[e]);let I=_.isPending||N.isPending,E=(0,t.useCallback)(async()=>{let e;if(I)return;if(!x.trim())return void eu.toast.error("Please enter a tile name");if(!f.trim())return void eu.toast.error("No SQL query available");try{e=await _.mutateAsync({team_id:u,name:x.trim(),query_sql:f,description:v.trim()||void 0,connection_id:S,origin_conv_id:r||void 0})}catch(s){console.error("Failed to create tile:",s);let e=s instanceof Error?s.message:"Failed to create tile. Please try again.";eu.toast.error(e);return}if(w&&w!==sj)try{await N.mutateAsync({dashboardId:w,panelId:e.id,teamId:u})}catch(o){console.error("Failed to add tile to dashboard:",o),l(!1);let s=u?`/team/${u}/tiles`:"/tiles",t=`${s}/${e.id}`;eu.toast.error("Tile created, but failed to add to dashboard.",{action:{label:"View Tile",onClick:()=>a.push(t)}});return}l(!1);let s=u?`/team/${u}/tiles`:"/tiles",t=`${s}/${e.id}`;eu.toast.success("Tile created successfully!",{action:{label:"View Tile",onClick:()=>a.push(t)}})},[I,x,f,v,u,S,r,w,_,N,l,a]),P=(0,t.useCallback)(e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),E())},[E]);return(0,s.jsx)(em.Dialog,{open:e,onOpenChange:l,children:(0,s.jsxs)(em.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",onKeyDown:P,children:[(0,s.jsxs)(em.DialogHeader,{children:[(0,s.jsx)(em.DialogTitle,{children:"Create Dashboard Tile"}),(0,s.jsx)(em.DialogDescription,{children:"Save this SQL query as a reusable dashboard tile."})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(sg.Label,{children:"SQL Query"}),(0,s.jsx)("div",{className:"rounded-md border border-input overflow-hidden",children:(0,s.jsx)(eL.default,{mode:"sql",theme:"dark"===h?"cloud9_night":"cloud9_day",name:`sql_preview_${n}`,value:f,readOnly:!0,fontSize:13,lineHeight:20,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!1,maxLines:10,minLines:3,setOptions:{showLineNumbers:!0,tabSize:2},width:"100%",className:"min-h-[60px]",wrapEnabled:!0})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)(sg.Label,{htmlFor:"tile-name",children:["Tile Name ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(eh.Input,{id:"tile-name",value:x,onChange:e=>g(e.target.value),placeholder:"Enter a name for this tile",disabled:I})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(sg.Label,{htmlFor:"tile-description",children:"Description (optional)"}),(0,s.jsx)(T.Textarea,{id:"tile-description",value:v,onChange:e=>y(e.target.value),placeholder:"Add a description for this tile",disabled:I,rows:2})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(sg.Label,{htmlFor:"dashboard-select",children:"Add to Dashboard (optional)"}),(0,s.jsxs)(sb.Select,{value:w,onValueChange:A,disabled:I||C,children:[(0,s.jsx)(sb.SelectTrigger,{id:"dashboard-select",children:(0,s.jsx)(sb.SelectValue,{placeholder:"Select a dashboard..."})}),(0,s.jsxs)(sb.SelectContent,{children:[(0,s.jsx)(sb.SelectItem,{value:sj,children:"Don't add to dashboard"}),k?.map(e=>(0,s.jsx)(sb.SelectItem,{value:e.id,children:e.name},e.id))]})]}),C&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Loading dashboards..."})]})]}),(0,s.jsxs)(em.DialogFooter,{children:[(0,s.jsx)(p.Button,{type:"button",variant:"ghost",onClick:()=>l(!1),disabled:I,children:"Cancel"}),(0,s.jsx)(p.Button,{onClick:E,disabled:I||!x.trim(),children:I?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(se.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Tile"})]})]})})}function sy({messageId:e,sql:l,connectionName:o}){let[i,n]=(0,t.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{onClick:()=>n(!0),className:"p-1 rounded hover:bg-accent transition-colors cursor-pointer","aria-label":"Save as Dashboard Tile",children:(0,s.jsx)(sx,{size:16})})}),(0,s.jsx)(g.TooltipContent,{children:"Save as Dashboard Tile"})]}),(0,s.jsx)(sv,{open:i,onOpenChange:n,sql:l,connectionName:o,messageId:e})]})}var sw=e.i(416913);let sA=({messageId:e,connectorInputs:t,theme:l})=>t?(0,s.jsx)("div",{className:"w-full overflow-hidden border-y border-border bg-message",children:(0,s.jsx)(eL.default,{mode:"sql",theme:"dark"===l?"cloud9_night":"cloud9_day",name:`code_editor_${e}`,editorProps:{$blockScrolling:!0},value:String(t).replace(/\\n/g,"\n"),onChange:()=>{},readOnly:!0,fontSize:13,lineHeight:20,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!1,maxLines:10,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2},onLoad:e=>{e.renderer.setScrollMargin(8,8,0,0)},width:"100%",className:"min-h-[2rem] ace-transparent",wrapEnabled:!0})}):null,s_=({mcpArguments:e,theme:t})=>e?(0,s.jsx)("div",{className:"w-full overflow-hidden border-y border-border bg-message p-3",children:(0,s.jsx)(sw.JsonViewer,{value:(0,f.safeParseJSON)(e)||e,theme:t,style:{background:"transparent"},rootName:!1,defaultInspectDepth:1,displayDataTypes:!1,enableClipboard:!0})}):null,sN=({name:e,mcpArguments:t,theme:l,messageId:o,connectorInputs:i})=>{let n=e.startsWith("mcp_");return"mcp_list_tools"===e?null:n?(0,s.jsx)(s_,{mcpArguments:t,theme:l}):(0,s.jsx)(sA,{messageId:o,connectorInputs:i,theme:l})};var sk=e.i(503116),sC=e.i(471512);let sS=({messageId:e})=>{let t=(0,d.useSearchParams)(),{mutateAsync:l,isPending:o}=(0,sC.useConvertMessageToCron)(),i=v.isDevelopment?"http://localhost:3000":"https://julius.ai",n=t.get("id");return n?(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{disabled:o,onClick:()=>{eu.toast.promise(l({conversationId:n,messageId:e}),{loading:"Scheduling query...",success:e=>({message:"Query scheduled successfully!",action:{label:"View Plan",onClick:()=>window.open(`${i}/notebooks/${e}`,"_blank")}}),error:"Failed to schedule query. Please try again."})},className:"p-1 rounded hover:bg-gray-300 dark:hover:bg-neutral-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:o?(0,s.jsx)(se.Loader2,{size:16,className:"animate-spin"}):(0,s.jsx)(sk.Clock,{size:16})})}),(0,s.jsx)(g.TooltipContent,{children:"Schedule this query to run daily"})]}):null};function sT({messageId:e,exploreQuestion:o,functionResponse:i,isInProgress:n,isCollapsed:a,toggleMessageCollapse:r,streamingExploreEvents:c}){let[d,u]=(0,t.useState)({}),[m,h]=(0,t.useState)(null),[x,p]=(0,t.useState)(!1),g=(0,t.useRef)(null),b=(0,t.useRef)(!1),j=(0,t.useRef)(n),v=i?(0,f.safeParseJSON)(i):null,y=v?.explore_events,A=n?c:y;(0,t.useEffect)(()=>{let e=g.current;e&&A?.length&&e.scrollHeight-e.scrollTop-e.clientHeight<50&&(e.scrollTop=e.scrollHeight)},[A]),(0,t.useEffect)(()=>{!j.current||n||b.current||a||r(e,!0),j.current=n},[n,a,e,r]);let _=n?"Exploring schema":"Explored schema",N=o&&o.length>60?o.substring(0,60)+"...":o;return(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsxs)("button",{className:"flex items-center gap-1.5 px-1 py-1 text-muted-foreground text-sm hover:text-foreground transition-colors",onClick:()=>{a&&(b.current=!0),r(e,!a)},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[(0,s.jsx)(ss.Search,{className:"w-4 h-4"}),(0,s.jsxs)("span",{className:(0,w.cn)("font-medium",n&&"animate-pulse"),children:[_,":"]}),(0,s.jsx)("span",{className:"truncate max-w-[300px]",children:N||"loading..."}),(0,s.jsx)(e8.ChevronDownIcon,{className:(0,w.cn)("w-3 h-3 flex-shrink-0 transition-all ml-auto",!a||x?"opacity-100":"opacity-0",a&&"-rotate-90")})]}),(0,s.jsx)(O.AnimatePresence,{initial:!1,children:!a&&(0,s.jsx)(l.m.div,{className:"overflow-hidden",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:(0,s.jsxs)("div",{ref:g,className:"pl-4 border-l-2 border-border ml-2 mt-1 mb-2 space-y-1 max-h-[250px] overflow-y-auto",children:[n&&!A?.length&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(se.Loader2,{className:"w-3 h-3 animate-spin"}),(0,s.jsx)("span",{children:"Searching..."})]}),A?.map((e,t)=>{if("text"===e.type){let l=n&&t===A.length-1;return(0,s.jsxs)("div",{className:"py-1 text-sm text-muted-foreground whitespace-pre-wrap",children:[e.content,l&&(0,s.jsx)("span",{className:"animate-pulse",children:"â–Œ"})]},`text-${t}`)}if("tool"===e.type){let o="schema_grep"===e.tool,i=o?"Grep":"Search",n=e.input&&e.input.length>40?e.input.substring(0,40)+"...":e.input,a=d[t]??!1;return e.running?(0,s.jsxs)("div",{className:"flex items-center gap-1.5 py-0.5 text-sm text-muted-foreground",children:[(0,s.jsx)(se.Loader2,{className:"w-3 h-3 animate-spin flex-shrink-0"}),(0,s.jsxs)("span",{className:"font-medium flex-shrink-0",children:[i,":"]}),(0,s.jsx)("span",{className:"truncate",children:n})]},`tool-${t}`):(0,s.jsxs)("div",{children:[(0,s.jsxs)("button",{className:"flex items-center gap-1.5 py-0.5 text-sm text-muted-foreground hover:text-foreground transition-colors w-full text-left",onClick:()=>{u(e=>({...e,[t]:!e[t]}))},onMouseEnter:()=>h(t),onMouseLeave:()=>h(null),children:[(0,s.jsxs)("span",{className:"font-medium flex-shrink-0",children:[i,":"]}),(0,s.jsx)("span",{className:(0,w.cn)("truncate",o&&"font-mono"),children:n}),(0,s.jsx)(e8.ChevronDownIcon,{className:(0,w.cn)("w-3 h-3 flex-shrink-0 transition-all",a||m===t?"opacity-100":"opacity-0",!a&&"-rotate-90")})]}),(0,s.jsx)(O.AnimatePresence,{initial:!1,children:a&&(0,s.jsx)(l.m.div,{className:"overflow-hidden",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:(0,s.jsx)("div",{className:"ml-4 pl-2 pr-2 py-1 text-xs text-muted-foreground max-h-[150px] overflow-y-auto font-mono whitespace-pre-wrap",children:e.output||"No results"})})})]},`tool-${t}`)}return null})]})})})]})}e.i(296343);let sI=(0,t.memo)(({messageId:e,name:o,argsStr:i,existingToolExplanation:n,existingToolTitle:a,existingOneLineErrorExplanation:r,isOwner:c,isCollapsed:d,toggleMessageCollapse:u,isInProgress:m,error:h,hasFnMessage:x,functionResponse:p,streamingExploreEvents:g})=>{let b=eT.codeFunctionNames.includes(o),{theme:y}=(0,j.useUserContext)(),A="create_html_component"===o||"modify_html_component"===o,_=(0,t.useMemo)(()=>{let e="run_r_code"===o||"troubleshoot_r_errors_streaming"===o||"fix_r_header"===o;return A?"html":e?"r":"python"},[o,A,b]),{argumentsObj:N,code:k}=(0,t.useMemo)(()=>({argumentsObj:(0,f.safeParseJSON)(i),code:"html"===_?(0,eT.getPartialArgValue)(i,"html_code"):(0,eT.getPartialArgValue)(i,"code")}),[i,_]),C=N?.filenames,S=(0,eT.getPartialArgValue)(i,"instructions"),T="look_at_images"===o,I=(0,eT.getPartialArgValue)(i,"input_filename"),E=(0,eT.getPartialArgValue)(i,"output_filename"),P=(0,eT.getPartialArgValue)(i,"summarizing_instructions"),M="document_to_text_analysis"===o,L=(0,eT.getPartialArgValue)(i,"improved_query"),D="search_internet"===o,R=(0,eT.getPartialArgValue)(i,"pattern"),q=(0,eT.getPartialArgValue)(i,"path"),F=(0,eT.getPartialArgValue)(i,"query"),$="schema_grep"===o,z="semantics_search_schema"===o,U="read_google_sheet_metadata"===o,B="read_google_sheet"===o,H="update_google_sheet"===o,V="append_google_sheet"===o,G=(0,eT.getPartialArgValue)(i,"connection_name"),Q=(0,eT.getPartialArgValue)(i,"range"),W=(0,eT.getPartialArgValue)(i,"question"),J="explore_schema_agent"===o,K=(0,eT.getPartialArgValue)(i,"problem"),Y="solve_equation_step_by_step"===o,X=(0,eT.getPartialArgValue)(i,{google_ads_query:"gaql"}[o]??"sql"),Z=(0,eT.getPartialArgValue)(i,"connection_name"),ee=null!=o&&("bigquery_query"===o||"postgres_query"===o||"snowflake_query"===o||"google_ads_query"===o||"sql_server_query"===o||"mysql_query"===o||"vertica_query"===o||"databricks_query"===o||o.startsWith("mcp_")),es="schema_analysis"===o,et=(0,eT.getPartialArgValue)(i,"tool_arguments"),el=N&&"object"==typeof N&&(N?.executable_code||N?.python||N?.r_code||N?.code),eo=N&&"object"==typeof N&&N?.connection_name&&ee,ei=m&&!x&&(el||eo||(b||A)&&!!k||Z&&ee),en=!!(0,t.useMemo)(()=>N?N.executable_code||N.python||N.r_code||N.code:null,[N])&&!a&&!n&&c,{data:ea,isLoading:er}=(0,st.useToolExplanationQuery)({messageId:e,enabled:en}),ed=a||ea?.tool_title||"",eu=n||ea?.tool_explanation||"",em=!!h&&!r,{data:eh}=(0,st.useOneLineErrorExplanationQuery)({messageId:e,errors:h?[h]:[],enabled:em}),ef=r||eh?.explanation||"",ex=eT.toolNameButtonDetails[o]??void 0,ep=ex?.Icon??ec.Code2,eg=(0,t.useMemo)(()=>{if(ed)return ed;if(es)return"Looking at relevant tables";let e=Z&&!Z.startsWith("{");if(ee&&e)return m?`Querying ${Z}`:`Queried ${Z}`;let s=m?"Generating Code":"Generated Code";return(m?ex?.presentButtonText:ex?.pastButtonText)??s},[ed,es,ee,Z,m,ex]);if($||z){let t=$?q?`${R} ${q}`:R:F,o=$?m?"Grepping":"Grepped":m?"Searching":"Searched",i=p?(0,f.safeParseJSON)(p):null,n=i?.output||i?.errors?.join("\n")||null;return(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsxs)("button",{className:"flex items-center gap-1.5 text-muted-foreground text-sm hover:text-foreground transition-colors",onClick:()=>u(e,!d),children:[(0,s.jsx)("span",{className:(0,w.cn)("font-medium shrink-0",m&&"animate-pulse"),children:o}),(0,s.jsx)("span",{className:"truncate min-w-0",children:t||"loading..."})]}),(0,s.jsx)(O.AnimatePresence,{initial:!1,children:!d&&(0,s.jsx)(l.m.div,{className:"overflow-hidden",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:(0,s.jsx)("div",{className:"pl-2 pr-2 py-1 text-xs text-muted-foreground max-h-[150px] overflow-y-auto font-mono whitespace-pre-wrap",children:n||(m?"Loading...":"No results")})})})]})}if(J)return(0,s.jsx)(sT,{messageId:e,exploreQuestion:W,functionResponse:p,isInProgress:m,isCollapsed:d,toggleMessageCollapse:u,streamingExploreEvents:g});if(U||B||H||V){let e={read_google_sheet_metadata:{present:"Looking at",past:"Looked at"},read_google_sheet:{present:"Reading from",past:"Read from"},update_google_sheet:{present:"Updating",past:"Updated"},append_google_sheet:{present:"Appending to",past:"Appended to"}}[o]||{present:"Processing",past:"Processed"},t=m?e.present:e.past,l=!U&&Q;return(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-muted-foreground text-sm",children:[(0,s.jsx)("span",{className:(0,w.cn)("font-medium shrink-0",m&&"animate-pulse"),children:t}),(0,s.jsxs)("span",{className:"truncate min-w-0 text-muted-foreground/70",children:[G||"Google Sheet",l&&(0,s.jsxs)("span",{children:[" Â· ",Q]})]})]})})}return(0,s.jsxs)("div",{className:(0,w.cn)("border border-gray-200 bg-gray-100 dark:bg-neutral-900 dark:border-input box-content",d?"rounded-xl border-b-1":"rounded-t-xl border-b-0",A&&"rounded-b-xl border-b-1",!x&&"border-b-1 rounded-b-xl mb-3 overflow-hidden"),children:[(0,s.jsx)("div",{className:(0,w.cn)("flex gap-2 justify-between sm:flex-row flex-col",ef?"sm:items-start lg:text-center":""),children:(0,s.jsxs)("div",{"data-event":"chat_finished_working","data-cy":"tool-call-collapsible-button",className:(0,w.cn)("flex flex-row w-full p-3 gap-2 justify-between items-center text-muted-foreground outline-0 text-xs",m&&"animate-pulse",d?"rounded-[11px]":"rounded-t-xl"),children:[(0,s.jsxs)("button",{className:"flex flex-row items-center gap-2 truncate hover:bg-gray-200 dark:hover:bg-neutral-700 -m-2 p-2 rounded-lg transition-colors",onClick:()=>u(e,!d),children:[(0,s.jsx)(ep,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"text-sm max-w-full truncate",children:eg})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[ee&&!o.startsWith("mcp_")&&v.FEATURE_FLAGS.SEPARATE_DASHBOARDS&&(0,s.jsx)(sy,{messageId:e,sql:X||"",connectionName:Z||""}),ee&&!o.startsWith("mcp_")&&v.FEATURE_FLAGS.QUERY_SCHEDULE_BUTTON&&(0,s.jsx)(sS,{messageId:e}),"mcp_list_tools"!==o&&(0,s.jsx)("button",{className:"p-1 rounded hover:bg-gray-300 dark:hover:bg-neutral-600 transition-colors",onClick:()=>u(e,!d),children:(0,s.jsx)(e8.ChevronDownIcon,{size:16,className:(0,w.cn)("transition duration-300",!d&&"rotate-180")})}),h&&(0,s.jsx)(e9.AlertCircle,{className:"w-4 h-4 text-muted-foreground"})]})]})}),(0,s.jsx)(O.AnimatePresence,{initial:!1,children:!d&&(0,s.jsxs)(l.m.div,{className:"relative overflow-hidden",initial:{height:0},animate:{height:"auto"},exit:{height:0},children:[ef&&(0,s.jsx)("span",{className:"px-3 text-muted-foreground text-xs break-words",children:ef}),(b||A)&&_&&(0,s.jsx)(su,{messageId:e,code:k,codeType:_,isOwner:c,toolExplanation:eu,fetchingToolExplanation:er,isInProgress:m}),T&&(0,s.jsxs)("div",{className:"flex flex-col p-1 gap-0.5",children:[C&&Array.isArray(C)&&C.length>0&&C?.map((e,t)=>(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e},t)),(0,s.jsxs)("span",{className:"text-xs italic mt-1 text-muted-foreground",children:["Instructions: ",S]})]}),M&&(0,s.jsxs)("div",{className:"flex flex-col p-2 gap-0.5",children:[I&&E&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[I," â†’ ",E]}),(0,s.jsxs)("span",{className:"text-xs italic mt-1 text-muted-foreground",children:["Instructions: ",P]})]}),D&&(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 text-muted-foreground",children:[(0,s.jsx)(ss.Search,{className:"flex-shrink-0 w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs",children:L})]}),Y&&(0,s.jsx)("div",{className:"flex flex-col p-1 gap-0.5",children:(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:K})}),ee&&(0,s.jsx)(sN,{name:o,mcpArguments:et,theme:y,messageId:e,connectorInputs:X}),es&&(0,s.jsx)("div",{className:"flex flex-col p-3 max-h-[400px] overflow-y-auto",children:(0,s.jsx)(e4.default,{text:N?.content})})]})}),ei&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[(0,s.jsx)(se.Loader2,{className:"w-3.5 h-3.5 animate-spin"}),(0,s.jsx)("span",{className:"animate-pulse",children:"Running code"})]}),(0,s.jsx)(sl.Skeleton,{className:"h-8 w-full"})]})]})});sI.displayName="ToolCall";var sE=e.i(488031);let sP=({responseObj:e,messageId:l})=>{let{activeConversationId:o}=(0,b.useChatContext)(),i=(0,t.useMemo)(()=>ek(e,o),[o,e]);return i&&i?(0,s.jsx)("div",{className:"flex items-center gap-2 opacity-80 transition-opacity shrink-0",children:(0,s.jsx)(eX,{collection:i,responseObj:e,messageId:l,conversationId:o,children:({select:e,state:t})=>(0,s.jsx)("div",{className:"flex flex-wrap gap-2 w-full",children:Object.entries(i).map(([l,o])=>o.map((o,i)=>(0,s.jsx)(eU.Drawer.Trigger,{asChild:!0,children:(0,s.jsx)(eY,{type:l,onClick:()=>e({type:l,index:i}),active:t?.index===i&&t?.type===l})},o.join("-"))))})})}):null};var sM=e.i(113347);let sL=({messageId:e,responseObj:l,isAttachedToToolCall:o=!1,isCollapsed:i=!1,onExpand:n})=>{let a=(0,t.useMemo)(()=>Object.values(l?.outputs_dict||{}).filter(e=>"string"==typeof e&&e.startsWith("[JULIUS_TABLE]")),[l]);return 0===a.length?null:(0,s.jsx)("div",{className:(0,w.cn)("flex flex-col gap-3 last:mb-3",o&&i&&"-mt-[10px]"),children:a.map((t,l)=>(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsx)(sM.InlineEditableDataframe,{dataframeString:t,juliusMessageId:e,juliusDfSelectorIndex:l+1,showViewFullButton:!0,isAttachedToToolCall:o,isCollapsed:i,onExpand:n,maxVisibleRows:5})},l))})},sD=({error:e,maxLength:l=100})=>{let[o,i]=(0,t.useState)(!1),n=e.length>l,a=o||!n?e:e.slice(0,l).trim()+"...";return(0,s.jsxs)("div",{onClick:()=>i(!o),className:"p-1 transition-all duration-300 ease-in-out overflow-hidden text-xs cursor-pointer rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 text-muted-foreground",children:[(0,s.jsx)("pre",{className:"inline whitespace-pre-wrap break-words",children:a}),n&&(0,s.jsx)("span",{className:"text-blue-500 hover:text-blue-700 ml-1 font-medium",children:o?"Show less":"Show more"})]})},sR=({text:e,maxLength:l=100,variant:o="text",className:i=""})=>{let[n,a]=(0,t.useState)(!1),r=e?.length>l,c=n||!r?e:e.slice(0,l).trim()+"...";return(0,s.jsxs)("div",{onClick:()=>a(!n),className:(0,w.cn)("p-1 transition-all duration-300 ease-in-out overflow-hidden text-xs cursor-pointer rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800","pre"===o&&"text-muted-foreground",i),children:["pre"===o?(0,s.jsx)("pre",{className:"inline whitespace-pre-wrap break-words rounded-xl",children:c}):(0,s.jsx)("p",{className:"inline rounded-xl",children:c}),r&&(0,s.jsx)("span",{className:"text-blue-500 hover:text-blue-700 ml-1 font-medium",children:n?"Show less":"Show more"})]})},sO=(0,t.memo)(({messageId:e,toolCallMessageId:o,name:i,isCollapsed:n,responseStr:a,addSearchResultsToDict:r,addErrorToDict:c,previousMessageWasFunctionCall:d,toggleMessageCollapse:u})=>{let{activeConversationId:m}=(0,b.useChatContext)(),h=(0,t.useMemo)(()=>(0,f.safeParseJSON)(a)||{},[a]),x=(0,t.useMemo)(()=>h?.errors&&Array.isArray(h.errors)?h?.errors:[],[h]);(0,t.useEffect)(()=>{x.length>0&&x.at(0)&&c(e,x.at(0))},[h,x,c,e]),(0,t.useEffect)(()=>{"search_internet"===i&&r(e,h?.sources)},[i,h,r,e]);let p=(0,t.useMemo)(()=>x.length>0?(0,s.jsx)("div",{children:x.map((e,t)=>(0,s.jsx)(sD,{error:e,maxLength:300},t))}):null,[x]),g=(0,t.useMemo)(()=>{if(!h||"look_at_images"===i)return null;if("search_internet"===i){let e=h?.sources||[];return e.length>0?(0,s.jsxs)("div",{className:"flex flex-col transition-all duration-300 ease-in-out overflow-hidden",children:[e.map((e,t)=>(0,s.jsx)("div",{className:"p-1 text-xs text-muted-foreground",children:(0,s.jsxs)(Q.default,{target:"_blank",href:e.link,className:"flex gap-2 text-xs font-light",children:[(0,s.jsx)("img",{src:e.favicon,className:"flex-shrink-0 w-4 h-4"}),(0,s.jsx)("span",{className:"flex items-center",children:e.title})]})},t)),p]}):(0,s.jsxs)("div",{className:"flex gap-2 flex-col justify-center items-center text-xs text-muted-foreground text-center",children:[(0,s.jsx)(sE.BookText,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Oops, I was unable to gather sources for you."})]})}if("solve_equation_step_by_step"===i)return(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)(sR,{text:h?.outputs?.[0],maxLength:300}),p]});let e="document_to_text_analysis"===i?h?.outputs?.[0]:null;return e?(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)(sR,{text:e,maxLength:300}),p]}):(0,eT.areAllFieldsEmptyLists)(h)?null:p},[p,i,h]),j=(0,t.useMemo)(()=>h&&h.html_elements?.length>0?(0,s.jsx)("div",{className:"py-3",children:h.html_elements?.map((t,l)=>(0,s.jsx)(eg,{htmlContent:t,messageId:e,htmlIndex:l,conversationId:m},l))}):null,[h]),v=eT.codeFunctionNames.includes(i)&&(Object.hasOwn(h,"outputs_dict")||Object.hasOwn(h,"image_urls_dict"))||Object.hasOwn(h,"html_elements"),y=null!=i&&("bigquery_query"===i||"postgres_query"===i||"snowflake_query"===i||"google_ads_query"===i||"sql_server_query"===i||"mysql_query"===i||"vertica_query"===i||"databricks_query"===i||i.startsWith("mcp_"))&&Object.keys(h?.outputs_dict||{}).length>0;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.AnimatePresence,{initial:!1,children:!n&&g&&(0,s.jsx)(l.m.div,{className:(0,w.cn)("overflow-hidden","last:pb-3"),initial:{height:0},animate:{height:"auto"},exit:{height:0},transition:{type:"tween",ease:"linear"},children:(0,s.jsx)("div",{className:(0,w.cn)("border border-gray-200 border-t-0 rounded-b-xl bg-gray-100 p-3 dark:bg-neutral-900 dark:border-input",!d&&"mt-0 rounded-t-xl border-t"),children:g})})}),y&&(0,s.jsx)(sL,{messageId:e,responseObj:h,isAttachedToToolCall:d,isCollapsed:n,onExpand:()=>o&&u?.(o,!1)}),v&&!y&&(0,s.jsx)("div",{className:(0,w.cn)("overflow-hidden border-gray-200 border rounded-xl rounded-t-none border-t-0 bg-gray-100 p-3 dark:bg-neutral-900 dark:border-input last:mb-3",d?n?"-mt-[10px]":"":"rounded-t-xl border-t"),children:(0,s.jsx)(sP,{messageId:e,responseObj:h})}),j]})});sO.displayName="ToolResponse";let sq=(0,c.default)(()=>e.A(346668).then(e=>e.JsonViewer),{loadableGenerated:{modules:[465516]},ssr:!1}),sF=e=>{switch(e){case"workflow_step":return(0,s.jsx)("div",{className:"flex-shrink-0 mt-1 w-8 h-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:(0,s.jsx)(r.Workflow,{})});case"user":return(0,s.jsx)("div",{className:"flex-shrink-0 mt-1 w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white font-bold",children:(0,s.jsx)(a.User2,{})});case"ai":return(0,s.jsx)("div",{className:"flex-shrink-0 mt-1 w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white font-bold",children:(0,s.jsx)(o.Bot,{})});default:return(0,s.jsx)("div",{className:"flex-shrink-0 mt-1 w-8 h-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"?"})}},s$=e=>{switch(e){case"user":return(0,s.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-green-500 flex items-center justify-center text-white font-bold",children:"U"});case"system":return(0,s.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"S"});case"assistant":return(0,s.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-primary flex items-center justify-center text-white font-bold",children:"A"});case"function":return(0,s.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-purple-500 flex items-center justify-center text-white font-bold",children:"F"});default:return(0,s.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"?"})}};e.s(["MessageGroup",0,({group:e,isOwner:o,isWorkflowMessage:a=!1,id:r=null,dummyMessage:c})=>{let k,C,S,T,I,{isGenerating:E,activeConversationId:P,generatingStatusMessage:M,setShowTryAdvancedReasoning:L,memoizedReplaceOutputsAndImagesFromGlobalDicts:D,toggleMessageCollapse:O,toolPreferences:q}=(0,b.useChatContext)(),F=(0,d.usePathname)(),{theme:$,debugMode:z,setDebuggingMessage:U}=(0,j.useUserContext)();["userInput","skeleton","markdown","workflowAgent"].some(s=>s===e.role)?C=e:"workflow_step"===e.role?S=e:"system"!==e.role&&(k=e?.message_list);let{troubleshootMessage:B}=(0,u.useDebugAPI)(),[H,V]=(0,t.useReducer)(f.messageGroupReducer,f.initialState),G=(0,t.useCallback)((e,s)=>{V({type:"ADD_SEARCH_RESULTS",messageId:e,searchResults:s})},[V]),Q=(0,t.useCallback)((e,s)=>{V({type:"ADD_ERROR",messageId:e,error:s})},[V]),W=(0,t.useRef)(new Set),J=!!Array.isArray(k)&&k.some(e=>e?.function_call||e?.role==="function"||e?.thinking_call),{data:K}=(0,y.useUserInformation)(),Y=(T=K?.preferences,(I=q?.tool_display_mode||T?.tool_display_mode)||(I=T?.hide_code?"collapse_code":"show_code"),v.FEATURE_FLAGS.CALL_STACK||"call_stack_stream"!==I&&"call_stack_counts"!==I||(I=T?.hide_code?"collapse_code":"show_code"),I),Z="call_stack_stream"===Y||"call_stack_counts"===Y,ee=!!Array.isArray(k)&&k.some(e=>!e?.completed_at),es=a?ee:!!e?.is_last_group,et=Z&&(J||"user"!==e.role&&(a?ee:E&&es)),el=Z&&J,eo="call_stack_counts"===Y?"output_counts":"stream";(0,t.useEffect)(()=>{k&&Array.isArray(k)&&k.forEach((e,s)=>{let t=s===k.length-1;e.thinking_call?.name!=="schema_analysis"||t||W.current.has(e.message_id)||(O(e.message_id,!0),W.current.add(e.message_id));let l=e.function_call?.name;"schema_grep"!==l&&"semantics_search_schema"!==l||W.current.has(e.message_id)||(O(e.message_id,!0),W.current.add(e.message_id))})},[k,O]);let ei=(0,t.useMemo)(()=>{if(!Z||!Array.isArray(k))return[];let e=[],s=[];for(let t=0;t<k.length;t++){let l=k[t],o=k[t+1];"assistant"===l.role&&(l.content||l.display)&&!l.thinking_call&&s.length>0&&(e.push(s),s=[]),s.push(l),l.function_call&&o?.content&&(s.push(o),t++)}return s.length>0&&e.push(s),e},[Z,k]),en=(0,t.useMemo)(()=>!!et&&0!==ei.length&&ei.every(e=>{let s=e[0];return!s?.content&&!s?.display&&!s?.function_call&&!s?.thinking_call}),[ei,et]),ea=(0,t.useMemo)(()=>!!Array.isArray(k)&&(!et||!(ei.length>0))&&k.some((s,t)=>{let l=t===k.length-1&&e.is_last_group;return!!(E&&l)&&("assistant"===s.role||s.role===m.WorkflowRole.agent)&&!s.function_call&&!s.thinking_call&&(!!s.content||!!s.display)}),[ei.length,e.is_last_group,k,E,et]),er=(0,t.useMemo)(()=>Array.isArray(k)?k[k.length-1]:void 0,[k]),ec=(0,t.useMemo)(()=>E&&e.is_last_group&&er?.role==="assistant"&&!er?.content&&!er?.display&&!er?.function_call&&!er?.thinking_call,[e.is_last_group,E,er]),ed=(0,t.useMemo)(()=>!!Array.isArray(k)&&k.some(e=>e?.thinking_call),[k]),eu=E&&e.is_last_group&&er?.role==="function",em=!c&&E&&e.is_last_group&&"user"!==e.role&&(!et||en)&&!ea&&(!J||eu||ec)&&!ed;return z?"workflow_step"===e.role?(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row w-full",children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:sF(e.role)}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("span",{children:["Group role: ",e.role]}),(0,s.jsx)("span",{className:"text-xs",children:"This value is just used to group messages in the UI"})]})})]}),(0,s.jsx)("div",{className:"flex-1 w-full ml-4",children:(0,s.jsx)("div",{className:"min-h-14 w-full flex flex-col self-start gap-0.5 p-4 rounded-xl px-4 py-1 bg-gray-50 dark:bg-neutral-800",children:(0,s.jsx)("span",{className:"text-muted-foreground",children:e.content})})})]}):(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row w-full",children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:sF(e.role)}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("span",{children:["Group role: ",e.role]}),(0,s.jsx)("span",{className:"text-xs",children:"This value is just used to group together messages in the UI"})]})})]}),(0,s.jsx)("div",{className:"flex-1 w-full ml-4 sm:w-[90%]",children:(0,s.jsx)("div",{className:"min-h-10 w-full flex flex-col gap-0.5 rounded-xl px-4 py-1 bg-gray-50 dark:bg-neutral-800 border border-gray-100 dark:border-neutral-700",children:(0,s.jsx)("div",{className:"text-muted-foreground flex flex-col divide-y-2 gap-1",children:k?.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:s$(e.role)}),(0,s.jsx)(g.TooltipContent,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("span",{children:["Message role: ",e.role]}),(0,s.jsx)("span",{className:"text-xs",children:"Actual message role used in the backend"})]})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[e.content&&"function"===e.role&&(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Function Call Response"}),(0,s.jsx)("div",{className:"border border-border rounded-xl bg-message overflow-hidden",children:(0,s.jsx)(sq,{value:(0,f.safeParseJSON)(e.content)||e.content,theme:"dark"===$?"dark":"light",style:{padding:"8px",background:"transparent"},rootName:!1,defaultInspectDepth:1})})]}),e.content&&"function"!==e.role&&(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Content"}),(0,s.jsx)("span",{className:"whitespace-pre-wrap break-words text-wrap",children:e.content})]}),e.function_call&&(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Function Call Request"}),(0,s.jsx)("div",{className:"border border-border rounded-xl bg-message overflow-hidden",children:(0,s.jsx)(sq,{value:(0,f.safeParseJSON)(e.function_call)||e.function_call,rootName:!1,defaultInspectDepth:1,theme:"dark"===$?"dark":"light",style:{padding:"8px",background:"transparent"}})})]}),(0,s.jsxs)("div",{className:"flex justify-between w-full",children:[(0,s.jsx)("span",{className:"text-2xs",children:(0,f.getLocaleDateTimeString)(e.completed_at)}),"assistant"===e.role&&(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(p.Button,{size:"icon",asChild:!0,variant:"ghost",onClick:s=>{s.preventDefault(),U({conversationId:P,messageId:e.message_id})},children:(0,s.jsx)(i.Eye,{className:"w-5 h-5 hover:cursor-pointer"})})}),(0,s.jsx)(g.TooltipContent,{children:"See what the AI saw when generating this message"})]}),(0,s.jsxs)(g.Tooltip,{children:[(0,s.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(p.Button,{size:"icon",asChild:!0,variant:"ghost",onClick:s=>{s.preventDefault(),B(e.message_id)},children:(0,s.jsx)(n.Save,{className:"w-5 h-5 hover:cursor-pointer"})})}),(0,s.jsx)(g.TooltipContent,{children:"Rerun the message with a different model"})]})]})]})]})]},`chat-message-${e.message_id}`))})})})]}):(0,s.jsxs)("div",{id:r,className:(0,w.cn)("flex flex-col w-full group ",!a&&"resizable-chat-width"),children:[C&&"markdown"!==C.role&&(0,s.jsx)("div",{className:"flex justify-center",children:C.component}),!S&&!C&&"system"!==e.role&&(0,s.jsx)(N.default,{Header:!a&&(0,s.jsx)(A.AvatarDisplay,{messageRole:e.role,isOwner:o}),children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-full",children:[et&&ei.map((l,o)=>{let i=l[0],n="assistant"===i.role&&(i.content||i.display)&&!i.thinking_call,a=e.is_last_group&&o===ei.length-1,r=n&&(l.length>1||i.function_call&&1==l.length)||!n,c=n&&i.function_call?l.map((e,s)=>0===s?{...e,content:"",display:""}:e):l;return(0,s.jsxs)(t.Fragment,{children:[n&&(0,s.jsx)(x.default,{showViewFullButton:!0,text:D(i.content||i.display,i.message_id),showCaret:E&&o===ei.length-1&&!r,searchResults:void 0}),r&&(0,s.jsx)(e3,{messages:c,variant:eo,isActive:a})]},i.message_id||i.id)}),k?.map((t,l)=>{if(!t)return console.error("--- activeConversationId ---",P),console.error("--- !message ---",t,k),null;let i=l===k.length-1,n=i&&e.is_last_group,r=E&&n,c=e.is_last_group&&"user"!==t.role&&M?.stream_result,d=k.at(l-1),u=d&&d.message_id!==t.message_id&&d.function_call&&"schema_analysis"!==d.function_call.name;return(0,s.jsxs)(_.default,{message:t,children:[("user"===t.role||"user-input"===t.role)&&(0,s.jsx)(R,{message:t,editingUserMessage:H.editingUserMessage,setEditingUserMessage:e=>V({type:"SET_EDITING_USER_MESSAGE",messageId:e})}),("assistant"===t.role||t.role===m.WorkflowRole.agent)&&(0,s.jsxs)(s.Fragment,{children:[(t.content||t.display)&&!(et&&ei.length>0)&&(0,s.jsx)("div",{className:(0,w.cn)(u?"border-l border-r border-gray-200 bg-gray-100 dark:bg-neutral-900 dark:border-neutral-900 ":""),children:(0,s.jsx)("span",{className:"text-sm whitespace-pre-wrap",children:(0,s.jsx)(x.default,{showViewFullButton:!0,text:"/models"===F||"/ai-chatbot"===F?t.content:D(t.content||t.display,t.message_id),showCaret:r&&!t.function_call,searchResults:H.messageIdsToSearchResults[k[l-1]?.message_id]})})}),!el&&t.function_call&&(0,s.jsx)(sI,{messageId:t.message_id,name:t.function_call?.name,argsStr:t.function_call?.arguments,isCollapsed:t.isCollapsed,toggleMessageCollapse:O,isInProgress:r,isOwner:o,error:H.messageIdToError[k[l+1]?.message_id],existingToolTitle:t.tool_title,existingToolExplanation:t.tool_explanation,existingOneLineErrorExplanation:t.one_line_error_explanation,hasFnMessage:!!k.at(l+1)&&"function"===k[l+1].role,functionResponse:k[l+1]?.role==="function"?k[l+1]?.content:void 0,streamingExploreEvents:r?M?.explore_events:void 0}),!el&&t.thinking_call&&(0,s.jsx)(e7,{message:t}),c&&!el&&t.function_call?.name!=="explore_schema_agent"&&(0,s.jsx)("div",{className:"py-2 flex justify-start mt-1 w-full",children:(0,s.jsx)("span",{className:"text-xs text-muted-foreground animate-pulse",children:M.stream_content})})]}),"function"===t.role&&!el&&(0,s.jsx)(sO,{messageId:t.message_id,toolCallMessageId:d?.message_id,name:t.name,isCollapsed:d?.isCollapsed,responseStr:t.content,previousMessageWasFunctionCall:u,addSearchResultsToDict:G,addErrorToDict:Q,toggleMessageCollapse:O}),t.response?.html_elements?.map((e,l)=>(0,s.jsx)("div",{className:"py-2",children:(0,s.jsx)(eg,{htmlContent:e,messageId:t.message_id,htmlIndex:l,conversationId:P})},l)),P&&!a&&"learning_update"===t.flags&&(0,s.jsx)(X,{messageContent:t.content,messageId:t.message_id}),i&&!H.editingUserMessage&&(0,s.jsxs)(s.Fragment,{children:[P&&!a&&"learning_update"!==t.flags&&(0,s.jsx)(X,{messageId:t.message_id}),(0,s.jsxs)("div",{className:"flex justify-between pt-3 w-full",children:[(0,s.jsx)(h.ChatMessageActions,{isUserMessage:"user"===e.role,setEditingUserMessage:e=>V({type:"SET_EDITING_USER_MESSAGE",messageId:e}),setShowTryAdvancedReasoning:L,messageContent:t.content,messageId:t.message_id,isOwner:o,isLastAtomicMessage:n}),t.completed_at&&(0,s.jsx)("span",{className:"ml-auto text-2xs opacity-0 transition-opacity duration-200 text-muted-foreground group-hover:opacity-100",children:(0,f.getLocaleDateTimeString)(t.completed_at)})]})]})]},k.first_message_id||t.message_id||l)}),em&&(0,s.jsxs)("div",{className:"inline-flex w-fit text-muted-foreground text-sm gap-0.5 whitespace-nowrap",children:[(0,s.jsx)(l.m.span,{className:"whitespace-nowrap animate-pulse overflow-hidden w-fit",animate:{width:["0%","100%"]},transition:{repeat:1/0,duration:1,repeatDelay:2,repeatType:"reverse"},children:"Thinking..."}),(0,s.jsx)("span",{style:{animation:"blink 1s step-start infinite"},children:"â–"})]}),c&&(0,s.jsxs)("div",{className:"inline-flex w-fit text-muted-foreground text-sm gap-0.5 whitespace-nowrap",children:[(0,s.jsx)(l.m.span,{className:"whitespace-nowrap animate-pulse overflow-hidden w-fit",animate:{width:["0%","100%"]},transition:{repeat:1/0,duration:1,repeatDelay:2,repeatType:"reverse"},children:"Thinking..."}),(0,s.jsx)("span",{style:{animation:"blink 1s step-start infinite"},children:"â–"})]})]})})]})},"getMessageRoleIcon",0,s$],835324)}]);

//# debugId=5910ef93-83af-38b6-8656-54561595f5d0
//# sourceMappingURL=b55f93c9ca47f86a.js.map