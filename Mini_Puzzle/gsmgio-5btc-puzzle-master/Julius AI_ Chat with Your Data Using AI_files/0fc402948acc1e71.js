;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="f7c0e8bc-51f8-a2d2-4fde-e63dadb302c6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,931231,e=>{"use strict";var t=e.i(247167),s=e.i(843476),a=e.i(271645),n=e.i(52563),r=e.i(431343),l=e.i(770703),o=e.i(618566),i=e.i(604570),c=e.i(846696);e.i(971804);var d=e.i(511108),u=e.i(544216),m=e.i(767601),h=e.i(672883),f=e.i(934357),p=e.i(630374),x=e.i(959143),g=e.i(367944),b=e.i(910758),y=e.i(210677),v=e.i(653770),j=e.i(616525),w=e.i(394073),N=e.i(11573),k=e.i(647631),_=e.i(620949),S=e.i(75510),C=e.i(647163);let E=()=>{let[e,t]=(0,a.useState)(!0),n=w.FEATURE_FLAGS.MAINTENANCE_MESSAGE||"Julius will be conducting maintenance soon. Please save all work in case of reduced performance.";return e?(0,s.jsx)("div",{className:"fixed bottom-4 left-4 bg-red-50 border border-red-200 rounded-lg shadow-lg p-4 z-50 max-w-md",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-md text-red-800",children:n}),(0,s.jsx)("button",{onClick:()=>{t(!1)},className:"ml-4 text-red-500 hover:text-red-700 focus:outline-none",children:"✕"})]})}):null};var A=e.i(88653),P=e.i(824511),T=e.i(595468),L=e.i(961356),L=L,D=e.i(531278),I=e.i(323441),F=e.i(37727),U=e.i(657688),O=e.i(522016),G=e.i(264082),R=e.i(565489),M=e.i(351908),$=e.i(475254);let B=(0,$.default)("bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);var z=e.i(664659);e.i(655900);var W=e.i(730267);let q=(0,$.default)("squirrel",[["path",{d:"M15.236 22a3 3 0 0 0-2.2-5",key:"21bitc"}],["path",{d:"M16 20a3 3 0 0 1 3-3h1a2 2 0 0 0 2-2v-2a4 4 0 0 0-4-4V4",key:"oh0fg0"}],["path",{d:"M18 13h.01",key:"9veqaj"}],["path",{d:"M18 6a4 4 0 0 0-4 4 7 7 0 0 0-7 7c0-5 4-5 4-10.5a4.5 4.5 0 1 0-9 0 2.5 2.5 0 0 0 5 0C7 10 3 11 3 17c0 2.8 2.2 5 5 5h10",key:"980v8a"}]]),H=[{displayName:"Marketing Campaign",name:"demos/marketing_campaign.csv",path:"demos/marketing_campaign.csv",icon:W.LineChart},{displayName:"Sleep Health and Lifestyle Dataset",name:"demos/Sleep_health_and_lifestyle_dataset.csv",path:"demos/Sleep_health_and_lifestyle_dataset.csv",icon:B},{displayName:"2018 Central Park Squirrel Census - Squirrel Data",name:"demos/2018_Central_Park_Squirrel_Census_-_Squirrel_Data.csv",path:"demos/2018_Central_Park_Squirrel_Census_-_Squirrel_Data.csv",icon:q}];var V=e.i(968224),X=e.i(643531),J=e.i(728231);function Q({featured:e=!1,title:t,subtitle:a,monthlyPrice:n,yearlyPrice:r,monthlySuffix:l,yearlySuffix:o,featuresEyebrow:c,features:d,ctaText:u,ctaHref:m="/settings/subscription",onCtaClick:h,annualTotal:f,currencySymbol:p="$"}){let{setUserOnboarding:x}=(0,k.useUserOnboarding)(),g="Free"===t?"Free for everyone":"Enterprise"===t?"Billed annually":f&&f>0?(0,s.jsxs)(s.Fragment,{children:["Billed annually at"," ",(0,s.jsxs)("strong",{className:"font-medium text-card-foreground",children:[p,Math.floor(f)]})," ","a year"]}):null,b=`${m}${m.includes("?")?"&":"?"}tier=${t}`;return(0,s.jsxs)("div",{className:`pricing-card ${e?"border-primary border-2 shadow-2xl":"border-muted-foreground/20 has-[.cta-button:hover]:border-muted-foreground border shadow-lg"} transition duration-200 relative xl:max-w-[340px] flex px-3 py-5 flex-col items-start rounded-xl bg-background w-full h-full`,children:[e&&(0,s.jsx)("div",{className:"absolute top-0 right-4 -translate-y-1/2 bg-primary rounded-full px-2 py-0.5 text-white font-medium text-xs",children:"RECOMMENDED"}),(0,s.jsx)("p",{className:"text-card-foreground text-xl font-medium leading-[1em] tracking-[-0.02em]",children:t}),(0,s.jsx)("p",{className:"sr-only",children:a}),(0,s.jsxs)("div",{className:"mt-3 mb-4 text-muted-foreground text-sm font-normal leading-[1em] tracking-[-0.015em]",children:[(0,s.jsx)("div",{className:"monthly-price",children:(0,s.jsxs)("div",{className:"flex items-baseline gap-0.5",children:[(0,s.jsx)("p",{className:"text-card-foreground text-3xl font-semibold tracking-[-0.02em]",children:n})," ",(0,s.jsx)("div",{className:"font-medium text-muted-foreground",children:l&&(0,s.jsx)("p",{children:l})})]})}),r&&(0,s.jsxs)("div",{className:"yearly-price",children:[(0,s.jsxs)("div",{className:"flex items-baseline gap-0.5",children:[(0,s.jsx)("span",{className:"text-card-foreground text-3xl font-semibold tracking-[-0.02em]",children:r}),o&&(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:o})]}),g&&(0,s.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:g})]})]}),"Pro"===t?(0,s.jsx)(O.default,{href:b,className:"cta-button transition-all duration-200 ease-in-out hover:scale-[101%] hover:brightness-105 shadow-sm cursor-pointer flex py-2.5 justify-center items-center gap-2.5 rounded-lg bg-primary w-full",onClick:s=>{i.default.capture("pricing_card_cta_clicked",{title:t,ctaText:u,featured:e,href:b}),x("payment"),h&&(s.preventDefault(),h(t))},children:(0,s.jsx)("p",{className:"text-white text-sm font-semibold leading-[1.4em]",children:u})}):(0,s.jsx)(O.default,{href:b,className:"bg-primary-foreground cta-button transition-all duration-200 ease-in-out hover:bg-sidesecondary shadow-sm cursor-pointer flex py-2.5 justify-center items-center gap-2.5 rounded-lg border border-border w-full",onClick:s=>{i.default.capture("pricing_card_cta_clicked",{title:t,ctaText:u,featured:e,href:b}),x("payment"),h&&(s.preventDefault(),h(t))},children:(0,s.jsx)("p",{className:"text-card-foreground text-sm font-semibold leading-[1.4em]",children:u})}),(0,s.jsxs)("div",{className:"mt-4 pb-4",children:[c&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-2.5",children:c}),(0,s.jsx)("div",{className:"flex flex-col gap-1.5",children:d.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(X.Check,{width:12,height:12,className:"size-4 shrink-0 text-green-600"}),e.tooltip?(0,s.jsxs)(J.Tooltip,{delayDuration:0,children:[(0,s.jsx)(J.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("span",{className:"underline decoration-dotted underline-offset-4 decoration-muted-secondary text-card-foreground text-sm font-normal leading-[1.4em] cursor-help",children:e.text})}),(0,s.jsx)(J.TooltipContent,{side:"top",className:"max-w-[200px]",children:e.tooltip})]}):(0,s.jsx)("span",{className:"text-card-foreground text-sm font-normal leading-[1.4em]",children:e.text})]},t))})]})]})}function Z({frequencies:e,pricingCards:t,selectedFrequency:n,onFrequencyChange:r,onStartFree:l,compact:o=!1,className:i,onPurchase:c}){let d=`
    .pricing-section:has(#pricing-yearly:checked) .monthly-price { display: none; }
    .pricing-section:has(#pricing-yearly:checked) .yearly-price { display: block; }
    .pricing-section:has(#pricing-yearly:checked) .monthly-suffix { display: none; }
    .pricing-section:has(#pricing-yearly:checked) .yearly-suffix { display: block; }
    .pricing-section:has(#pricing-yearly:checked) .yearly-discount { display: inline-block; }

    .pricing-section:has(#pricing-monthly:checked) .monthly-price { display: block; }
    .pricing-section:has(#pricing-monthly:checked) .yearly-price { display: none; }
    .pricing-section:has(#pricing-monthly:checked) .monthly-suffix { display: block; }
    .pricing-section:has(#pricing-monthly:checked) .yearly-suffix { display: none; }
    .pricing-section:has(#pricing-monthly:checked) .yearly-discount { display: none; }

    .yearly-price { display: none; }
    .yearly-suffix { display: none; }
    .yearly-discount { display: none; }
  `,u=2===t.length?"xl:grid-cols-2":3===t.length?"xl:grid-cols-3":(t.length,"xl:grid-cols-4"),m=(0,a.useRef)(null),h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=()=>{let e=m.current?.offsetHeight??0;h.current&&h.current.style.setProperty("--pricing-header-h",`${e}px`)};e();let t=new ResizeObserver(e);m.current&&t.observe(m.current);let s=()=>e();return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),t.disconnect()}},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{id:"pricing",ref:h,className:`pricing-section flex flex-col items-center ${i??""}`,children:[(0,s.jsx)("div",{ref:m,className:"w-full px-4 md:px-6 lg:px-8 sticky top-0 z-10 bg-white/80 dark:bg-background/80 backdrop-blur",children:(0,s.jsx)("form",{className:`${o?"mt-10":"mt-8 md:mt-10 lg:mt-14"} grid grid-cols-2 items-stretch p-[1px] rounded-full text-center font-semibold ring-1 ring-inset ring-muted-foreground/20 w-full lg:w-fit mx-auto`,children:e.map(e=>(0,s.jsxs)("label",{htmlFor:`pricing-${e.value}`,className:"cursor-pointer rounded-lg relative",children:[(0,s.jsx)("input",{type:"radio",id:`pricing-${e.value}`,name:"pricing",className:"sr-only peer",checked:n===e.value,onChange:()=>r(e.value)}),(0,s.jsxs)("span",{className:"text-xs md:text-sm flex h-full gap-3 items-center justify-center px-2 sm:px-3 md:px-4 py-1 lg:py-1.5 text-black dark:text-white peer-checked:bg-[hsl(var(--gray500)/0.08)] dark:peer-checked:bg-[hsl(var(--gray500)/0.14)] peer-checked:shadow-sm rounded-full border-transparent font-normal transition-all",children:[e.label,"yearly"===e.value&&(0,s.jsxs)("span",{className:"px-1 sm:px-2 py-1 text-xs font-semibold rounded-full dark:bg-[#006ED6]/20 bg-[#006ED6]/10 text-[#006ED6]",children:[" ","SAVE -20%"," "]})]})]},e.value))})}),(0,s.jsx)("div",{className:`pricing-cards ${o?"mt-4":"mt-4 lg:mt-6"} grid grid-cols-1 sm:grid-cols-2 ${u} items-stretch justify-items-center gap-4 xl:gap-3 w-full max-w-5xl xl:max-w-[1500px] px-4 md:px-6 lg:px-8 overflow-y-auto max-h-[calc(100svh-var(--pricing-header-h,0px))]`,children:t.map((e,t)=>(0,s.jsx)(Q,{...e,onCtaClick:"Free"===e.title?()=>l?.():c?()=>c(e.title):void 0},t))})]}),(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:d}})]})}var K=e.i(671590);let Y=[{name:"Lite",id:"tier-lite",href:"https://buy.stripe.com/aEUg0dcGWfJo0ikaEV",firstLine:"Everything in Free, and:",price:{US:200,CA:270,GB:157,IN:15e3,PE:750,EURO:186,AU:290,NZ:380},description:"For professionals looking to make data-driven decisions quickly without specialized staff.",features:[{text:"250 messages/month"},{text:"Unlimited access to Plus models",tooltip:"Access to GPT 4.1 and 4o; o4-mini and o3-mini; Claude 3.7 and 3.5 Sonnet"},{text:"Saved prompts"},{text:"Access to Advanced Reasoning"},{text:"16 GB of RAM"},{text:"7-day file storage"}]},{name:"Standard",id:"tier-standard",href:"https://buy.stripe.com/aEU7tHgXc1Sy0ik14n",firstLine:"Everything in Plus, and:",price:{US:450,CA:600,GB:342.5,IN:36420,PE:1600,EURO:400,AU:650,NZ:700},description:"For companies that need to collaborate across departments and automate manual workflows.",features:[{text:"Unlimited messages"},{text:"Unlimited access to Pro models",tooltip:"Access to Plus models, o3, and Claude 4.5 Sonnet"},{text:"Unlimited file storage formats",tooltip:"Upload any file format to Julius"},{text:"Access to Julius Teams"},{text:"32 GB of RAM"},{text:"10-day file storage"},{text:"Live collaboration"},{text:"User roles & permissions"},{text:"Snowflake, BigQuery, and Postgres data connectors"},{text:"Priority support"}],mostPopular:!0},{name:"Pro",id:"tier-pro",href:"https://buy.stripe.com/cN229n4aqap49SU28s",firstLine:"Everything in Pro, and:",price:{US:2e3,CA:2800,GB:4700,IN:18e4,PE:7e3,EURO:1700,AU:3e3,NZ:3500},description:"For AI power users who need the latest and most powerful models, and maximum context.",features:[{text:"Higher output limits for all tasks"},{text:"Larger context window",tooltip:"5x more context window than Pro"},{text:"Early access to advanced and unreleased features"},{text:"Max members-only Slack channel with members from the Julius team"},{text:"Priority access at high traffic times"}]}],ee=[{name:"Lite",id:"tier-lite",href:"https://buy.stripe.com/aEU8xL5eu7cSfde8wM",firstLine:"Everything in Free, and:",price:{US:20,CA:27,GB:15.7,IN:1500,PE:75,EURO:18.6,AU:29,NZ:38},description:"For professionals looking to make data-driven decisions quickly without specialized staff.",features:[{text:"250 messages/month"},{text:"Unlimited access to Plus models",tooltip:"Access to GPT 4.1 and 4o; o4-mini and o3-mini; Claude 3.7 and 3.5 Sonnet"},{text:"Saved prompts"},{text:"Access to Advanced Reasoning"},{text:"16 GB of RAM"},{text:"7-day file storage"}]},{name:"Standard",id:"tier-standard",href:"https://buy.stripe.com/00g9BPayO2WC7KM4gy",firstLine:"Everything in Plus, and:",price:{US:45,CA:60,GB:34.25,IN:3542,PE:160,EURO:40,AU:65,NZ:70},description:"For companies that need to collaborate across departments and automate manual workflows.",features:[{text:"Unlimited messages"},{text:"Unlimited access to Pro models",tooltip:"Access to Plus models, o3, and Claude 4.5 Sonnet"},{text:"Unlimited file storage formats",tooltip:"Upload any file format to Julius"},{text:"Access to Julius Teams"},{text:"32 GB of RAM"},{text:"10-day file storage"},{text:"Live collaboration"},{text:"User roles & permissions"},{text:"Snowflake, BigQuery, and Postgres data connectors"},{text:"Priority support"}],mostPopular:!0},{name:"Pro",id:"tier-pro",href:"https://buy.stripe.com/4gw15j36mbt83uwdRb",firstLine:"Everything in Pro, and:",price:{US:200,CA:280,GB:470,IN:18e3,PE:700,EURO:170,AU:300,NZ:350},description:"For AI power users who need the latest and most powerful models, and maximum context.",features:[{text:"Higher output limits for all tasks"},{text:"Larger context window",tooltip:"5x more context window than Pro"},{text:"Early access to advanced and unreleased features"},{text:"Max members-only Slack channel with members from the Julius team"},{text:"Priority access at high traffic times"}]}];ee.find(e=>"Lite"===e.name)?.description,ee.find(e=>"Lite"===e.name)?.price.US,ee.find(e=>"Lite"===e.name)?.firstLine,ee.find(e=>"Lite"===e.name)?.features,ee.find(e=>"Standard"===e.name)?.description,ee.find(e=>"Standard"===e.name)?.price.US,ee.find(e=>"Standard"===e.name)?.firstLine,ee.find(e=>"Standard"===e.name)?.features,ee.find(e=>"Pro"===e.name)?.description,ee.find(e=>"Pro"===e.name)?.price.US,ee.find(e=>"Pro"===e.name)?.firstLine,ee.find(e=>"Pro"===e.name)?.features;let et=({steps:e,currentStep:t})=>(0,s.jsx)("div",{className:"w-full px-4",children:(0,s.jsx)("div",{className:"hidden sm:flex items-center justify-center",children:(0,s.jsx)("div",{className:"flex items-start relative",children:e.map((a,n)=>{let r=a.number<=t+1,l=a.number<t+1,o=n===e.length-1;return(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center w-32 lg:w-40 gap-1",children:[(0,s.jsxs)("div",{className:"relative flex items-center",children:[!o&&(0,s.jsx)("div",{className:`absolute h-[2px] w-24 lg:w-32 left-7 lg:left-9 top-[calc(50%-4px)] ${l?"bg-primary":"bg-border"}`}),(0,s.jsx)("div",{className:`flex items-center justify-center w-8 h-8 lg:w-9 lg:h-9 rounded-full mb-2 z-10 ${l?"bg-background text-primary border-2 border-primary":r?"bg-primary text-primary-foreground":"bg-message text-muted-foreground border-2 border-border"}`,children:l?(0,s.jsx)(X.Check,{className:"w-4 h-4 lg:w-5 lg:h-5"}):(0,s.jsx)("span",{className:"text-sm lg:text-base",children:a.number})})]}),(0,s.jsx)("span",{className:"text-xs lg:text-sm text-center px-1 text-muted-foreground leading-tight",children:a.label})]})},a.number)})})})});var es=e.i(38068);let ea=null;async function en(){if(ea)return ea;let{default:t}=await e.A(644985);return ea=t,t}async function er(e,t){try{let s=await en();s?.capture(e,t)}catch(e){console.error("PostHog capture failed",e)}}var el=e.i(157633),eo=e.i(167881),ei=e.i(174080);let ec=({children:e})=>{let[t,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>(s(!0),()=>s(!1)),[]),t?(0,ei.createPortal)(e,document.querySelector("body")):null};var ed=e.i(161498),eu=e.i(38037);let em=(0,l.default)(()=>e.A(504066).then(e=>e.DataframeDisplay),{loadableGenerated:{modules:[536046]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(D.Loader2,{className:"h-4 w-4 animate-spin"})})}),eh=(0,l.default)(()=>e.A(506879),{loadableGenerated:{modules:[109585]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(D.Loader2,{className:"h-4 w-4 animate-spin"})})}),ef=(0,l.default)(()=>e.A(789453).then(e=>({default:({handleClose:t})=>(0,s.jsx)(e.default,{useAlertDialog:!1,handleClose:t})})),{loadableGenerated:{modules:[427162]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"flex justify-center p-4",children:(0,s.jsx)(D.Loader2,{className:"h-4 w-4 animate-spin"})})}),ep="onboarding-file-upload-modal-dismissed";function ex({onClose:e,onFileUpload:t}){let{conversations:r,activeConversationId:l,dataLocationSelection:o}=(0,g.useChatContext)(),{getDataframeProps:i,deleteSourceFromConvo:u}=(0,d.useChatAPI)(),[m,f]=(0,a.useState)(!1),p=(0,a.useRef)(null),[x,b]=(0,a.useState)(0),v=(0,a.useRef)(!1),[j,N]=(0,a.useState)(null),[S,E]=(0,a.useState)(null),[A,P]=(0,a.useState)([]),[T,L]=(0,a.useState)(null),[I,F]=(0,a.useState)(void 0),U=(0,R.useUploadFiles)(),{generateBotResponse:$}=(0,y.useMessageContext)(),{fetchSuggestedQuestions:B}=(0,G.useAuthenticatedAPIs)(),{data:z,setUserOnboarding:W}=(0,k.useUserOnboarding)(),{data:q}=(0,_.useUserInformation)(),{data:V,isLoading:X}=(0,_.useUserSubscription)(),J=Array.isArray(o)?o:o?[o]:[],Q={Postgres:"https://r2.julius.ai/postgres-logo.png",BigQuery:"https://r2.julius.ai/bigquery-logo.png",Snowflake:"https://r2.julius.ai/snowflake-logo.png","Google Drive":"https://r2.julius.ai/googledrive-logo.png",OneDrive:"https://r2.julius.ai/onedrive.png",SharePoint:"/sharepoint-for-business.png",Intercom:"https://r2.julius.ai/intercom.png",Zapier:"https://r2.julius.ai/logos/zapier-logo_black.png",Notion:"https://r2.julius.ai/logos/notion-logo.png","Other MCP":"https://r2.julius.ai/connector_logos/mcp.png","Google Ads":"https://r2.julius.ai/connector_logos/ads-logo.png","Meta Ads":"https://r2.julius.ai/meta.png",MySQL:"https://r2.julius.ai/connector_logos/mysql_logo.png",Vertica:"https://r2.julius.ai/connector_logos/vertica_logo.png","SQL Server":"https://r2.julius.ai/sqlserver.png"},Z=J.filter(e=>"Google Drive"===e?w.FEATURE_FLAGS.GOOGLE_DRIVE_INTEGRATION:Q[e]).slice(0,3),Y=Z.length>0,{getAccessTokenSilently:ee}=(0,n.useAuth0)(),[es,ea]=(0,a.useState)(!1),[en,el]=(0,a.useState)(null),[eo,ei]=(0,a.useState)(!1),[ed,em]=(0,a.useState)("monthly"),[ef,ex]=(0,a.useState)("US");(0,a.useEffect)(()=>{V?.country_code&&(K.euCountries.includes(V.country_code)?ex("EURO"):K.supportedCountries.includes(V.country_code)&&ex(V.country_code))},[V]),(0,a.useEffect)(()=>{(async()=>{try{if(es||eo||"true"!==localStorage.getItem("openGoogleDrivePicker"))return;let e=await ee(),t=await (0,M.getGoogleDriveOauthToken)(e);t&&t.scopes?.includes(h.GOOGLE_OAUTH_SCOPES.DRIVE_FILE)&&(el(t.access_token),ea(!0),localStorage.removeItem("openGoogleDrivePicker"))}catch(e){console.error("Failed to auto-open Google Drive picker",e)}})()},[es,eo,ee]);let[ej,ew]=(0,a.useState)(""),eN=(0,a.useCallback)(()=>{try{localStorage.setItem(ep,"true")}catch(e){console.error("Error setting localStorage item",e)}e()},[e]),ek=!!V?.status,e_=[{number:1,label:"Tell us about yourself"}];(0,a.useEffect)(()=>{ek&&W("payment")},[ek,W]),(0,a.useEffect)(()=>{0===x&&q?.survey_completed_at&&(er("onboarding_modal:survey_only_completed"),W("upload_file"),W("ask_julius"),W("share"),W("payment"),eN())},[q,x,b,ek,!0,W,eN]),(0,a.useEffect)(()=>{1===x&&(!v.current&&(ek||z?.onboarding_status?.payment)?(b(2),z?.onboarding_status?.payment&&er("onboarding_modal:payment_completed_proceed_to_upload")):v.current=!0)},[ek,z,x,b]),(0,a.useEffect)(()=>{let e=async e=>{try{let t=H.some(t=>t.path===e)?e.slice(6):e,s=t.split(".")?.pop()?.toUpperCase();if(E(s||null),"CSV"===s||"XLS"===s||"XLSX"===s){let e=await i(t,s);if(e){L(e);let t=Object.keys(e?.sheets||{});F(t.length>0?t[0]:void 0)}}}catch(e){console.error("Error getting dataframe props",e)}},t=r?.[l]?.sources;t&&Array.isArray(t)&&t.length>0&&t[t.length-1]?.name&&e(t[t.length-1].name)},[r,l]),(0,a.useEffect)(()=>{(async()=>{if(T&&j&&I)try{let e=await B({dataframeJSON:{rows:T?.sheets?.[I]?.data,columns:T?.sheets?.[I]?.columns}});e.suggestions&&P(e.suggestions)}catch(e){console.error("Error fetching suggested questions",e)}})()},[T,j]);let eS=async e=>{(function(e,t){let a;return!!t&&(a=e.name.toLowerCase(),!!("image/png"===e.type||"image/jpeg"===e.type||a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg"))&&(c.toast.warning((0,s.jsxs)("div",{className:"break-words",children:[w.FEATURE_FLAGS.IS_WEBVIEW?(0,s.jsx)(O.default,{href:"/settings",className:"underline text-primary",children:"Upgrade"}):(0,s.jsx)("a",{className:"underline text-primary",href:"/settings",target:"_blank",rel:"noopener noreferrer",children:"Upgrade"})," ","to upload image files"]})),er("upgrade_cta_shown",{type:"toast",name:"image_file_upload",location:"onboarding_modal"}),!0))})(e,!V?.status)||(N(H.some(t=>t.path===e.name)?e.name.slice(6):e.name),H.some(t=>t.path===e.name)||U.mutate({files:[{file:e,filename:e.name,originatingFunction:"file-drop"}]}),await t(e.name),er("onboarding_modal:file_upload"),W("upload_file"),b(3))},eC=async e=>{let s=e?.docs.map(e=>({id:e.id,name:e.name}));if(!s?.length)return void ea(!1);try{let e=await ee(),a=await (0,M.transferGoogleDriveFilesToHub)(e,s);if(a?.transferred_files?.length){let e=a.transferred_files[0],s=e.clean_name??e.name;N(s),await t(s),er("onboarding_modal:file_upload",{method:"google_drive"}),W("upload_file"),b(3),c.toast.success("File imported from Google Drive")}else a?.errors?.length&&c.toast.error(`${a.errors.length} file(s) failed to import from Google Drive`)}catch(e){console.error(e),c.toast.error(e?.message??"Failed to import files from Google Drive")}finally{ea(!1)}},eE=async()=>{er("google_drive_modal_opened",{location:"onboarding_modal"}),ei(!0);try{let e=await ee(),t=await (0,M.getGoogleDriveOauthToken)(e);if(!t){let t=await (0,M.getGoogleDriveAuthUrl)({accessToken:e});if(t){try{localStorage.setItem("openGoogleDrivePicker","true")}catch(e){console.error("Failed to set localStorage flag",e)}window.location.href=t}else c.toast.info("Google account already connected. Try again in a moment.");return}if(!t?.scopes?.includes(h.GOOGLE_OAUTH_SCOPES.DRIVE_FILE)){c.toast.info("We need to enable Google Drive access. Redirecting you to Google...");let t=await (0,M.getGoogleDriveAuthUrl)({accessToken:e,scopes:[h.GOOGLE_OAUTH_SCOPES.DRIVE_FILE]});if(t){try{localStorage.setItem("openGoogleDrivePicker","true")}catch(e){console.error("Failed to set localStorage flag",e)}window.location.href=t}else c.toast.info("Google Drive is already connected. Try again in a moment.");return}el(t.access_token),ea(!0)}catch(e){console.error(e),c.toast.error(e?.message??"Failed to connect to Google Drive")}finally{ei(!1)}},eA=async e=>{let t=r?.[l]?.sources,s=(0,eu.getTextWithUploadsMessage)(t,e);await $({content:s,role:"user"}),W("ask_julius"),localStorage.setItem(ep,"true")};(0,a.useEffect)(()=>{z?.onboarding_status?.upload_file&&z?.onboarding_status?.ask_julius&&z?.onboarding_status?.share&&eN()},[z,eN]),(0,a.useEffect)(()=>{"true"===localStorage.getItem(ep)&&e()},[e]);let eP=T&&S&&["CSV","XLS","XLSX"].includes(S)&&(T?.sheets?.[I]?.data?.length||T?.sheets?.[I]?.data?.length)>1,eT=()=>{if(ek){if(0===x)return 0;if(2===x)return 1;if(3===x)return 2}return x},eL=null;switch(x){case 0:eL=(0,s.jsx)(eg,{steps:e_,currentStep:eT(),onClose:eN,hideStepIndicator:!0});break;case 1:eL=X?(0,s.jsx)("div",{className:"flex flex-col min-h-[400px] min-w-[400px] w-full h-full",children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-full max-w-3xl mx-auto px-4 min-h-0",children:[(0,s.jsx)("div",{className:"py-6 flex justify-center",children:(0,s.jsx)(et,{steps:e_,currentStep:eT()})}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsx)(D.Loader2,{className:"h-8 w-8 animate-spin text-primary"})})]})}):(0,s.jsx)(eb,{steps:e_,currentStep:eT(),selectedFrequency:ed,onSelectFrequency:em,onStartFree:()=>b(2),onContinueWithSubscription:()=>b(2),getAccessTokenSilently:ee,subscriptionStatus:V,countryCode:ef});break;case 2:eL=(0,s.jsx)(ey,{steps:e_,currentStep:eT(),dragActive:m,onDrag:e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?f(!0):"dragleave"===e.type&&f(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),f(!1);try{e.dataTransfer.files&&e.dataTransfer.files[0]&&eS(e.dataTransfer.files[0])}catch(e){console.error("Error handling file drop",e),c.toast.error("Error uploading file, please try again."),er("onboarding_modal:file_upload_error",{error:e.message})}},onFileChange:e=>{e.stopPropagation();try{e.target.files&&e.target.files[0]&&eS(e.target.files[0])}catch(e){console.error("Error handling file change",e),c.toast.error("Error uploading file, please try again."),er("onboarding_modal:file_upload_error",{error:e.message})}},fileInputRef:p,hasSelectedConnectors:Y,selectedConnectorsToDisplay:Z,onGoogleDriveClick:eE,connectorLogos:Q,onFileSelected:eS,onClose:eN});break;case 3:eL=(0,s.jsx)(ev,{steps:e_,currentStep:eT(),renderDataFrame:!!eP,fileType:S,filename:j,localDataframeProps:T,firstSheetName:I,conversations:r,activeConversationId:l,onDeleteFile:()=>{er("onboarding_modal:delete_file"),r?.[l]?.sources?.[0]?.name&&u(l,r[l].sources[0].name),N(null),b(2),L(null)},onGenerateResponse:eA,suggestedQuestions:A,onDismiss:eN,onClose:e,currentPromptInput:ej,onPromptInputChange:ew});break;default:eL=null}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ec,{children:[(0,s.jsx)("div",{className:(0,C.cn)("fixed inset-0 z-[999]","bg-gray-500/30 backdrop-blur-sm"),onClick:eN}),(0,s.jsx)("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center",onClick:e=>e.stopPropagation(),children:(0,s.jsx)("div",{className:(0,C.cn)("flex items-center justify-center w-full h-full shadow-none border-none p-0 max-w-none max-h-none rounded-none","bg-transparent",es&&"pointer-events-none"),children:eL})}),eo&&(0,s.jsx)("div",{className:"fixed inset-0 z-[1001] flex items-center justify-center bg-background/40 backdrop-blur-sm",children:(0,s.jsx)(D.Loader2,{className:"h-8 w-8 animate-spin text-primary"})})]}),es&&(0,s.jsx)(ec,{children:(0,s.jsx)(eh,{developerKey:"AIzaSyC3uq-iXRX2i-qIqcQfSBPkXNUZRdQNGO8",oauthToken:en,clientId:"437778814546-al32suqr999riv4ti61ht11ofgmu30ui.apps.googleusercontent.com",appId:"437778814546",onClose:()=>ea(!1),onPicked:eC,onCanceled:()=>ea(!1)})})]})}function eg({steps:e,currentStep:t,onClose:a,hideStepIndicator:n}){return(0,s.jsx)("div",{className:"flex flex-col min-h-[400px] min-w-[400px] w-full h-full",children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-full max-w-3xl mx-auto px-4 min-h-0",children:[!n&&(0,s.jsx)("div",{className:"py-6 flex justify-center max-sm:py-3",children:(0,s.jsx)(et,{steps:e,currentStep:t})}),(0,s.jsx)("div",{className:"flex-1 flex justify-center items-start overflow-y-auto scrollbar-on-hover min-h-0 max-sm:pt-0 pt-2",children:(0,s.jsx)(ef,{handleClose:a})})]})})}function eb({steps:e,currentStep:t,selectedFrequency:a,onSelectFrequency:n,onStartFree:r,onContinueWithSubscription:l,getAccessTokenSilently:o,subscriptionStatus:i,countryCode:c}){let d=!!i?.status,u=((e="US")=>{let t=K.currencySymbols[e]||"$",s={US:"USD",CA:"CAD",AU:"AUD",NZ:"NZD",GB:"GBP",IN:"INR",PE:"PEN",EURO:"EUR"}[e]||"USD";return[{title:"Free",subtitle:"For individuals to complete small projects and basic analysis.",monthlyPrice:`${t}0`,yearlyPrice:`${t}0`,ctaHref:"/chat",monthlySuffix:`${s}/month`,features:[{text:"15 messages/month"},{text:"AI custom settings"},{text:"8GB of RAM"}],yearlySuffix:`${s}/month`,featuresEyebrow:"Key features:",ctaText:"Get started for free",annualTotal:0},{title:"Plus",subtitle:ee.find(e=>"Lite"===e.name)?.description||"For professionals looking to make data-driven decisions quickly without specialized staff.",monthlyPrice:`${t}${Math.floor(ee.find(e=>"Lite"===e.name)?.price[e]||35)}`,yearlyPrice:`${t}${Math.floor((Y.find(e=>"Lite"===e.name)?.price[e]||350)/12)}`,monthlySuffix:`${s}/month`,yearlySuffix:`${s}/month`,yearlyDiscount:!0,featuresEyebrow:ee.find(e=>"Lite"===e.name)?.firstLine||"Everything in Free, and:",ctaHref:"/settings/subscription",ctaText:"Get started",features:ee.find(e=>"Lite"===e.name)?.features||[],annualTotal:Y.find(e=>"Lite"===e.name)?.price[e]||350},{title:"Pro",subtitle:ee.find(e=>"Standard"===e.name)?.description||"For companies that need to collaborate across departments and automate manual workflows.",monthlyPrice:`${t}${Math.floor(ee.find(e=>"Standard"===e.name)?.price[e]||45)}`,yearlyPrice:`${t}${Math.floor((Y.find(e=>"Standard"===e.name)?.price[e]||450)/12)}`,monthlySuffix:`${s}/month`,yearlySuffix:`${s}/month`,yearlyDiscount:!0,featuresEyebrow:ee.find(e=>"Standard"===e.name)?.firstLine||"Everything in Plus, and:",ctaHref:"/settings/subscription",ctaText:"Get started",featured:!0,features:ee.find(e=>"Standard"===e.name)?.features||[],annualTotal:Y.find(e=>"Standard"===e.name)?.price[e]||450},{title:"Max",subtitle:ee.find(e=>"Pro"===e.name)?.description||"For AI power users who need the latest and most powerful models, and maximum context.",monthlyPrice:`${t}${Math.floor(ee.find(e=>"Pro"===e.name)?.price[e]||200)}`,yearlyPrice:`${t}${Math.floor((Y.find(e=>"Pro"===e.name)?.price[e]||2e3)/12)}`,monthlySuffix:`${s}/month`,yearlySuffix:`${s}/month`,yearlyDiscount:!0,featuresEyebrow:ee.find(e=>"Pro"===e.name)?.firstLine||"Everything in Pro, and:",ctaHref:"/settings/subscription",ctaText:"Get started",features:ee.find(e=>"Pro"===e.name)?.features||[],annualTotal:Y.find(e=>"Pro"===e.name)?.price[e]||2e3}]})(c),m=K.currencySymbols[c]||"$",h=u.map(e=>({title:e.title,subtitle:e.subtitle,monthlyPrice:e.monthlyPrice,yearlyPrice:e.yearlyPrice,monthlySuffix:e.monthlySuffix,yearlySuffix:e.yearlySuffix,featuresEyebrow:e.featuresEyebrow,features:e.features,ctaText:d?e.title?.toLowerCase()==="enterprise"?"Contact Sales":"Continue":"Plus"===e.title||"Pro"===e.title||"Max"===e.title?"Subscribe":e.ctaText,ctaHref:"Plus"===e.title||"Pro"===e.title||"Max"===e.title?`/settings/subscription?billing=${"yearly"===a?"annually":"monthly"}`:e.ctaHref,annualTotal:e.annualTotal,currencySymbol:m})),f=async e=>{try{if(d){if(e?.toLowerCase()==="enterprise"){let t=h.find(e=>e.title?.toLowerCase()==="enterprise"),s=`${t?.ctaHref||"/contact"}?tier=${e}`;window.location.href=s;return}l();return}let t="Plus"===e?"lite":"Pro"===e?"standard":"Max"===e?"pro":void 0;if(!t)return;let s="yearly"===a?"annually":"monthly",n=await o();if(!n){window.location.href=`/settings/subscription?billing=${s}&tier=${e}`;return}let{url:r}=await (0,es.getCheckoutSessionId)({product:t,billing:s,code:void 0,version:"20240130",accessToken:n,source:es.CheckoutSource.Onboarding})||{};if(r)window.location.assign(r);else throw Error("Missing checkout URL")}catch(s){console.warn("Error starting checkout:",s);let t="yearly"===a?"annually":"monthly";window.location.href=`/settings/subscription?billing=${t}&tier=${e}`}};return(0,s.jsx)("div",{className:"flex flex-col min-h-[400px] min-w-[400px] w-full h-full",children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 w-full max-w-5xl mx-auto px-4 min-h-0",children:[(0,s.jsx)("div",{className:"py-6 flex justify-center",children:(0,s.jsx)(et,{steps:e,currentStep:t})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("h1",{className:"text-3xl md:text-3xl font-semibold tracking-tight",children:"Choose capabilities for AI powered data analysis"})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-on-hover min-h-0 flex flex-col items-center",children:(0,s.jsx)(J.TooltipProvider,{children:(0,s.jsx)(Z,{frequencies:[{value:"yearly",label:"Pay yearly"},{value:"monthly",label:"Pay monthly"}],pricingCards:h,selectedFrequency:a,onFrequencyChange:e=>n("yearly"===e?"yearly":"monthly"),onStartFree:r,compact:!0,onPurchase:f})})})]})})}function ey({steps:e,currentStep:t,dragActive:n,onDrag:r,onDrop:l,onFileChange:o,fileInputRef:i,hasSelectedConnectors:d,selectedConnectorsToDisplay:u,onGoogleDriveClick:m,connectorLogos:h,onFileSelected:f,onClose:p}){let[x,g]=(0,a.useState)(!1),{setUserOnboarding:b}=(0,k.useUserOnboarding)(),y=["Snowflake","BigQuery","Postgres","Google Ads"],v=Object.keys(h).filter(e=>!y.includes(e)&&"Google Drive"!==e);return(0,s.jsxs)("div",{className:`flex flex-col items-center justify-center w-full h-full min-h-[400px] min-w-[400px] overflow-y-auto relative ${n?"ring-2 ring-blue-500":""}`,onDragEnter:r,onDragOver:r,onDragLeave:r,onDrop:l,children:[(0,s.jsx)("input",{ref:i,type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/pdf",className:"hidden",onChange:o}),(0,s.jsxs)("div",{className:"flex flex-col w-full h-full max-w-3xl py-8 px-6",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(et,{steps:e,currentStep:t})}),(0,s.jsxs)("div",{className:"text-center mb-2",children:[(0,s.jsx)("h2",{className:"text-3xl font-semibold tracking-tight mb-2",children:"Connect Your Data"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Choose your data source to get started"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto scrollbar-on-hover py-6",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground mb-4",children:"Quick Start"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>i.current?.click(),className:"flex flex-col items-center justify-center p-6 rounded-lg border border-border bg-card hover:bg-accent hover:border-accent-foreground/20 transition-colors text-center gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 flex items-center justify-center",children:(0,s.jsx)(el.HomeDatasheetIllustration,{})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-base mb-1",children:"Upload a file"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"CSV, Excel, JSON"})]})]}),w.FEATURE_FLAGS.GOOGLE_DRIVE_INTEGRATION&&(0,s.jsxs)("button",{onClick:m,className:"flex flex-col items-center justify-center p-6 rounded-lg border border-border bg-card hover:bg-accent hover:border-accent-foreground/20 transition-colors text-center gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 flex items-center justify-center",children:(0,s.jsx)(U.default,{src:"https://r2.julius.ai/googledrive-logo.png",alt:"Google Drive",width:48,height:48,className:"w-12 h-12"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-base mb-1",children:"Google Drive"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Import from Drive"})]})]}),(0,s.jsxs)("button",{onClick:()=>{try{let e=new File(["demos/marketing_campaign.csv"],"demos/marketing_campaign.csv",{type:"text/csv"});f(e),er("onboarding_modal:sample_file_selected",{file_name:"Marketing Campaign"})}catch(e){console.error("Error loading sample file",e),c.toast.error("Error loading sample file, please try again.")}},className:"flex flex-col items-center justify-center p-6 rounded-lg border border-border bg-card hover:bg-accent hover:border-accent-foreground/20 transition-colors text-center gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 flex items-center justify-center",children:(0,s.jsx)(L.default,{className:"w-12 h-12 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-base mb-1",children:"Sample Data"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Try with demo file"})]})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground mb-4",children:"Popular Connections"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:y.map(e=>(0,s.jsxs)(O.default,{href:`/data-connectors#${e.toLowerCase().replace(/\s+/g,"-")}`,onClick:()=>{er("onboarding_modal:data_connector_link_clicked",{connector:e}),b("upload_file"),p()},className:"flex items-center gap-3 p-4 rounded-lg border border-border bg-card hover:bg-accent hover:border-accent-foreground/20 transition-colors",children:[(0,s.jsx)("div",{className:"w-8 h-8 flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(U.default,{src:h[e],alt:e,width:32,height:32,className:"w-8 h-8 object-contain"})}),(0,s.jsx)("span",{className:"font-medium",children:e})]},e))}),!x&&v.length>0&&(0,s.jsx)("button",{onClick:()=>g(!0),className:"w-full p-4 rounded-lg border border-dashed border-border hover:border-accent-foreground/40 hover:bg-accent transition-colors text-center",children:(0,s.jsxs)("span",{className:"text-sm font-medium text-primary",children:["▸ Show all connections (",Object.keys(h).length,"+)"]})}),x&&(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:v.map(e=>(0,s.jsxs)(O.default,{href:`/data-connectors#${e.toLowerCase().replace(/\s+/g,"-")}`,onClick:()=>{er("onboarding_modal:data_connector_link_clicked",{connector:e}),b("upload_file"),p()},className:"flex items-center gap-3 p-4 rounded-lg border border-border bg-card hover:bg-accent hover:border-accent-foreground/20 transition-colors",children:[(0,s.jsx)("div",{className:"w-8 h-8 flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(U.default,{src:h[e],alt:e,width:32,height:32,className:"w-8 h-8 object-contain"})}),(0,s.jsx)("span",{className:"font-medium",children:e})]},e))})]})]}),(0,s.jsx)("div",{className:"text-center pt-4 border-t border-border",children:(0,s.jsx)(eo.Button,{variant:"ghost",className:"text-sm text-muted-foreground flex items-center mx-auto",onClick:()=>{er("onboarding_modal:skip_to_explore",{step:"file_upload"}),b("upload_file"),p()},children:"I'll connect later"})})]})]})}function ev({steps:e,currentStep:t,renderDataFrame:n,fileType:l,filename:o,localDataframeProps:i,firstSheetName:c,conversations:d,activeConversationId:u,onDeleteFile:m,onGenerateResponse:h,suggestedQuestions:f,onDismiss:p,onClose:x,currentPromptInput:g,onPromptInputChange:b}){return(0,a.useEffect)(()=>{i&&l&&["CSV","XLS","XLSX"].includes(l)&&(er("onboarding_modal:auto_analyze_automatic_start",{isSuggestedQuestion:!0}),h("Can you take a quick look at this and visualize some key insights?"),p())},[g,i,l,h,p]),(0,s.jsx)("div",{className:"flex flex-col items-center justify-center w-full h-full min-h-[400px] min-w-[400px] relative",children:(0,s.jsxs)("div",{className:"flex flex-col w-full h-full justify-between max-w-4xl bg-white dark:bg-neutral-900 py-12",children:[(0,s.jsx)(et,{steps:e,currentStep:t}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 w-full",children:[!i&&l&&["CSV","XLS","XLSX"].includes(l)&&(0,s.jsx)("div",{className:"w-full p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-center flex-col gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading file..."})]})}),n&&(0,s.jsxs)("div",{className:"w-full p-4",children:[o&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 pr-6",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(I.Table,{className:"w-4 h-4 mr-2 text-muted-secondary"}),(0,s.jsx)("span",{className:"text-sm font-medium mr-2",children:o})]}),(0,s.jsxs)("button",{onClick:m,className:"flex flex-row items-center gap-1 text-sm text-muted-secondary hover:text-gray-700 dark:hover:text-gray-300",children:[(0,s.jsx)(F.X,{className:"w-4 h-4"}),"Delete and choose other"]})]}),(0,s.jsx)("div",{className:"w-full max-h-[300px] overflow-auto scrollbar-on-hover rounded-lg",children:c&&(0,s.jsx)(em,{index:i?.sheets?.[c]?.index||[],columns:i?.sheets?.[c]?.columns||[],rows:i?.sheets?.[c]?.data||[]})})]}),(0,s.jsxs)("div",{className:"w-full px-28",children:[(0,s.jsx)(A.AnimatePresence,{children:d?.[u]?.sources&&Object.keys(d[u].sources).length>0&&!n&&(0,s.jsxs)(P.m.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0,y:"200%"},className:"w-full h-fit rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"inline-flex gap-1 p-1 px-2 items-center bg-background rounded-xl mb-1 ml-2 text-muted-foreground",children:[(0,s.jsx)(T.CheckCircle2,{className:(0,C.cn)("w-3 h-3","text-green-600")}),(0,s.jsx)("span",{className:(0,C.cn)("text-xs text-muted-foreground font-light","text-green-600"),children:"1 of 1 ready."})]}),(0,s.jsx)("div",{className:"flex overflow-visible items-end w-full px-2",children:(0,s.jsx)(A.AnimatePresence,{children:d?.[u]?.sources?.[0]?.name&&(0,s.jsx)(P.m.div,{initial:{y:"200%"},animate:{y:0},exit:{y:"200%",width:0},transition:{staggerChildren:1},children:(0,s.jsx)(V.default,{className:(0,C.cn)("bg-background shadow-lg mb-1","ml-2"),file:d[u].sources[0],onDelete:m})},d[u].sources[0].name)})})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)(ed.WelcomePromptForm,{numMessages:0,chatType:"analysis",onSubmit:({text:e})=>{h(e),x()},addingSource:!1,handleAddFileToChat:null,isOnboarding:!0,onInputChange:b}),""===g&&(0,s.jsx)("div",{className:"flex justify-center w-full",children:(0,s.jsxs)(eo.Button,{variant:"outline",className:"mt-3 flex items-center justify-center rounded-md shadow-none border bg-message",type:"button",style:{width:185,height:40,borderColor:"#D3DFEA",fontSize:14,fontWeight:400,boxShadow:"none",padding:0},onClick:()=>{er("onboarding_modal:auto_analyze_clicked",{isSuggestedQuestion:!0}),h("Can you take a quick look at this and visualize some key insights?"),p()},children:[(0,s.jsx)(r.Play,{className:"w-4 h-4 mr-1",stroke:"#5A6A7A",fill:"none"}),"Auto analyze my data"]})}),f.length>0&&(0,s.jsx)("div",{className:"w-full mb-4 px-3",children:(0,s.jsx)("div",{className:"flex flex-col items-start justify-between overflow-x-auto",children:f.slice(0,4).map((e,t)=>{let a="string"!=typeof e,n=a?e.question:e,r=a?e.brief:e;return(0,s.jsx)(J.TooltipProvider,{children:(0,s.jsxs)(J.Tooltip,{children:[(0,s.jsx)(J.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{className:(0,C.cn)("flex flex-1 items-center gap-2 h-full cursor-pointer px-2 py-3.5 text-sm font-regular text-foreground w-full",t>0&&"border-t border-border"),onClick:()=>{er("onboarding_modal:analysis_started",{isSuggestedQuestion:!0}),h(n),p()},children:(0,s.jsx)("span",{className:"line-clamp-2 text-start",children:r})})}),(0,s.jsx)(J.TooltipContent,{children:(0,s.jsx)("p",{children:n})})]})},t)})})})]})]})]}),(0,s.jsx)("div",{className:"text-center mt-4",children:(0,s.jsxs)("button",{type:"button",className:"text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 flex items-center mx-auto",onClick:()=>{er("onboarding_modal:skip_to_explore",{step:"analysis_started"}),p()},children:["Explore first",(0,s.jsx)("svg",{className:"ml-1 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})})}var ej=e.i(826975);e.i(373375);var ew=e.i(463059),eN=e.i(108653),ek=e.i(789145),e_=e.i(425063),eS=e.i(975558),eC=e.i(82735),eE=e.i(752044),eA=e.i(358977),eP=e.i(435488),eT=e.i(384347),eL=e.i(483202),eD=e.i(522441),eI=e.i(330973),eF=e.i(123869),eU=e.i(4678),eO=e.i(671428),eG=e.i(127341),eR=e.i(184762),eM=e.i(915492),e$=e.i(997413),eB=e.i(873343),ez=e.i(896043),eW=e.i(669498),eq=e.i(593610),eH=e.i(8860),eV=e.i(226349),eX=e.i(873211),eJ=e.i(314982);function eQ({children:e,onClose:t}){return(0,s.jsxs)(P.m.div,{className:"relative group/chatbar-popup font-regular text-sm text-muted-foreground",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:[e,t&&(0,s.jsx)(eo.Button,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 translate-x-1/3 -translate-y-1/3 group-hover/chatbar-popup:opacity-100 flex opacity-0 transition-opacity duration-200 rounded-full text-muted-foreground w-5 h-5 p-0.5 bg-message fill-message hover:cursor-pointer hover:bg-accent hover:text-red-600 border border-border",children:(0,s.jsx)(F.X,{className:"w-3 h-3",strokeWidth:1.5,onClick:t})})]})}var eZ=e.i(625959),eK=e.i(10708),eY=e.i(221345);let e0=({conversationId:e,setShowFeedback:t,setShowTryAdvancedReasoning:n,showTryAdvancedReasoning:r,subscriptionPlan:l})=>{let[o,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(!0),[f,x]=(0,a.useState)(!1),[b,v]=(0,a.useState)(!1),{reportMessage:j}=(0,d.useChatAPI)(),{generateBotResponse:w}=(0,y.useMessageContext)(),{isFreeUser:k,toolPreferences:S,modelProvider:C}=(0,g.useChatContext)(),{data:E}=(0,_.useUserInformation)(),A=(0,_.useUpdateUserPreferences)(),P=async()=>{let s=new Promise(async(s,a)=>{try{x(!0);let t=S?.advanced_reasoning||!1,a=S?.extended_memory||!1;await j(e,"N/A",o,!1,"chat_feedback",0,C,t,a,l),m&&w({content:o,role:"user"}),s()}catch(e){console.error(e),a(e)}finally{u(""),t(!1),x(!1),v(!1)}});c.toast.promise(s,{loading:"Sending feedback",success:"Feedback sent",error:"Error sending feedback"})};return(0,s.jsxs)("div",{className:"relative px-3 py-2.5 flex flex-col md:flex-row justify-between items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:"What went wrong?"}),(0,s.jsxs)(p.Dialog,{open:b,onOpenChange:v,children:[(0,s.jsx)(p.DialogTrigger,{asChild:!0,children:(0,s.jsx)("span",{className:"text-sm text-primary font-medium underline hover:cursor-pointer underline-offset-2",children:"Share feedback"})}),(0,s.jsxs)(p.DialogContent,{className:"sm:max-w-[425px]",children:[(0,s.jsx)(p.DialogHeader,{children:(0,s.jsx)(p.DialogTitle,{children:"What went wrong?"})}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Try telling the AI as well. It may be able to fix its output if you explain to it what the problem is."}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eZ.Checkbox,{id:"tell-ai",checked:m,onCheckedChange:h}),(0,s.jsx)(eK.Label,{htmlFor:"tell-ai",children:"Send this message to the AI"})]}),(0,s.jsx)("div",{className:"grid gap-2",children:(0,s.jsx)(eR.Textarea,{rows:3,value:o,onChange:e=>u(e.target.value),placeholder:"Your feedback is much appreciated and helps improve the AI!",onKeyDown:e=>{"Enter"===e.key&&o.length>0&&P()},disabled:f})})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(eo.Button,{disabled:0===o.length||f,onClick:P,"data-event":"chat_low_rating_feedback",className:"gap-2",children:f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Loader2,{className:"h-5 w-5 animate-spin"}),(0,s.jsx)("span",{children:"Sending"})]}):"Submit"})})]})]})]}),r&&!E?.preferences?.advanced_reasoning&&(0,s.jsxs)("div",{className:"h-6 flex items-center gap-2",children:[(0,s.jsx)("p",{children:"Tip: Try Advanced Reasoning mode for better results:"}),(0,s.jsx)(eo.Button,{variant:"default",size:"xs",onClick:()=>{i.default.capture("advanced_reasoning_tip_clicked_try_it",{isFreeUser:k}),n(!1),k?(c.toast.warning((0,s.jsxs)("div",{className:"break-words",children:[FEATURE_FLAGS.IS_WEBVIEW?(0,s.jsx)(eY.Link,{href:"/settings",className:"underline text-primary",children:"Upgrade"}):(0,s.jsx)("a",{className:"underline text-primary",href:"/settings",target:"_blank",rel:"noopener noreferrer",children:"Upgrade"})," ","to use Advanced Reasoning mode"]})),i.default.capture("upgrade_cta_shown",{type:"toast",name:"advanced_reasoning"}),"function"==typeof window.gtag&&(window.gtag("event","advanced_reasoning_upgrade_cta_shown"),(0,N.trackLinkedInConversion)(N.UPGRADE_MODAL_SHOWN))):(A.mutate({advanced_reasoning:!0}),c.toast.info("Advanced reasoning enabled"))},children:"Enable"})]})]})};var e1=e.i(503116),e2=e.i(471512);function e3({userMessageCount:e}){let{activeConversationId:t}=(0,g.useChatContext)(),{mutate:n,isPending:r}=(0,e2.useConvertConversationToNotebookWithSchedule)(),l=(0,o.useRouter)();return(0,a.useEffect)(()=>{i.default.capture("chat:schedule-cta:seen",{userMessageCount:e})},[e]),(0,s.jsxs)("div",{className:"relative px-3.5 py-2.5 flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)(e1.Clock,{className:"flex-shrink-0 w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Want to run your analysis on a regular basis? Schedule it now"})]}),(0,s.jsx)(eo.Button,{size:"sm",onClick:s=>{s.preventDefault(),s.stopPropagation(),i.default.capture("chat:schedule-cta:clicked",{userMessageCount:e}),n(t,{onSuccess:e=>{e?l.push(`/notebooks/${e}?schedule=true`):c.toast.error("Failed to set up schedule. Please try again.")},onError:e=>{console.error("Failed to set up schedule:",e),c.toast.error("Failed to set up schedule. Please try again.")}})},disabled:r,variant:"ghost",className:"flex-shrink-0 h-7 bg-background border border-secondary font-medium",children:"Set up schedule"})]})}var e4=e.i(668252);function e5({setShowSlackCTA:e,userMessageCount:t}){let n=(0,o.useRouter)(),{data:r}=(0,e4.useSlackIntegration)();return((0,a.useEffect)(()=>{i.default.capture("chat:slack-cta:seen",{userMessageCount:t})},[t]),(0,a.useEffect)(()=>{r&&e(!1)},[r,e]),r)?null:(0,s.jsxs)("div",{className:"relative px-3.5 py-2.5 flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)(U.default,{src:"/slack.svg",alt:"Slack",width:16,height:16,className:"flex-shrink-0"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Want to ask for analysis without leaving Slack? Set up now to message Julius directly"})]}),(0,s.jsx)(eo.Button,{size:"sm",variant:"ghost",onClick:e=>{e.preventDefault(),e.stopPropagation(),i.default.capture("chat:slack-cta:connect-clicked",{userMessageCount:t}),n.push("/data-connectors")},className:"flex-shrink-0 h-7 bg-background border border-secondary font-medium",children:"Connect"})]})}var e6=e.i(870273);function e7({conversationId:e,userMessageCount:t,setShowRating:n,setShowFeedback:r,setShowTryAdvancedReasoning:l,modelProvider:o,toolPreferences:i,subscriptionPlan:c}){let[u,m]=(0,a.useState)(0),[h,f]=(0,a.useState)(0),{chatStarVote:p}=(0,d.useChatAPI)(),x=async s=>{try{s>0&&(p({conversationId:e,vote:s,userMessageCount:t,modelProvider:o,advancedReasoning:i?.advanced_reasoning||!1,extendedMemory:i?.extended_memory||!1,subscriptionPlan:c}),w.FEATURE_FLAGS.IS_WEBVIEW,n(!1),s<3&&(r(!0),l(!0)))}catch(e){console.error("error in getpreferences",e)}};return(0,s.jsxs)("div",{className:"relative px-3.5 py-2.5 flex items-center gap-3",children:[(0,s.jsx)("span",{children:"How is Julius doing so far?"}),(0,s.jsx)("div",{className:"h-6 flex flex-row gap-1 justify-center items-center cursor-pointer",onMouseLeave:()=>f(0),children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>{let a=t+1;return(0,s.jsxs)("label",{children:[(0,s.jsx)("input",{type:"radio",name:"rating",value:a,onClick:()=>{m(a),x(a),w.FEATURE_FLAGS.IS_WEBVIEW},className:"hidden"}),(0,s.jsx)(e6.Star,{className:`h-4 w-4 ${a<=(h||u)?"text-primary fill-current":"text-muted-foreground"} cursor-pointer hover:text-primary hover:fill-current`,onMouseEnter:()=>f(a)})]},t)})})]})}let e8=(0,$.default)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var e9=e.i(323012),te=e.i(376630);let tt=({searchQuery:e,onSelect:t,selectedIndex:n,setSelectedIndex:r,inputRef:l,dataConnections:o})=>{let i=(0,a.useRef)(null),c=(0,a.useRef)(null),[d,u]=(0,a.useState)([]),m=(0,a.useCallback)(e=>{if(!e)return[];let t=e.toLowerCase(),s=[];return(0,te.buildConnectionNodes)(Object.values(o)).forEach(e=>{e.children&&(e.children.forEach(e=>{e.children&&e.children.forEach(e=>{e.name.toLowerCase().includes(t)&&s.push({type:"table",tableName:e.name,displayName:e.name,description:`Table with ${e.data.columns.length} columns`})})}),e.children.forEach(e=>{e.children&&e.children.forEach(e=>{e.data?.columns&&e.data.columns.forEach(a=>{a.name.toLowerCase().includes(t)&&s.push({type:"column",tableName:e.name,columnName:a.name,displayName:`${e.name}.${a.name}`,description:`${a.name} column in ${e.name} table`})})})}))}),s},[o]);return((0,a.useEffect)(()=>{u(m(e)),r(0)},[e,m,r]),(0,a.useEffect)(()=>{if(c.current&&i.current){let e=i.current,t=c.current,s=e.getBoundingClientRect(),a=t.getBoundingClientRect();a.top<s.top?t.scrollIntoView({block:"start",behavior:"instant"}):a.bottom>s.bottom&&t.scrollIntoView({block:"end",behavior:"instant"})}},[n]),(0,a.useEffect)(()=>{let e=e=>{i.current&&!i.current.contains(e.target)&&l.current&&!l.current.contains(e.target)&&t(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[t,l]),0===d.length)?0===Object.keys(o).length?(0,s.jsx)("div",{ref:i,className:"absolute bottom-full mb-2 left-0 right-0 bg-background border rounded-lg shadow-lg p-2 z-50",children:(0,s.jsxs)("div",{className:"text-xs text-muted-foreground px-2 py-1 flex flex-row",children:["Schema mentions are only availale for Data Connectors. Enable a data connector by clicking the ",(0,s.jsx)(e8,{className:"mx-1 w-4 h-4 text-muted-foreground"})," button in the sidebar"]})}):0===e.length?(0,s.jsx)("div",{ref:i,className:"absolute bottom-full mb-2 left-0 right-0 bg-background border rounded-lg shadow-lg p-2 z-50",children:(0,s.jsx)("div",{className:"text-sm text-muted-foreground px-2 py-1",children:"Start typing table or column names to search for them"})}):(0,s.jsx)("div",{ref:i,className:"absolute bottom-full mb-2 left-0 right-0 bg-background border rounded-lg shadow-lg p-2 z-50",children:(0,s.jsxs)("div",{className:"text-sm text-muted-foreground px-2 py-1",children:['No results matching "',e,'"']})}):(0,s.jsx)("div",{ref:i,className:"absolute bottom-full mb-2 left-0 right-0 max-h-60 overflow-y-auto bg-background border rounded-lg shadow-lg z-50",children:d.map((e,a)=>(0,s.jsxs)("div",{ref:n===a?c:null,className:(0,C.cn)("px-3 py-2 cursor-pointer hover:bg-accent transition-colors",n===a&&"bg-accent"),onMouseEnter:()=>r(a),onClick:()=>t(e),children:[(0,s.jsxs)("div",{className:"flex flex-row gap-1",children:["table"===e.type&&(0,s.jsx)(I.Table,{className:"w-3 h-3 mt-1"}),"column"===e.type&&(0,s.jsx)(e9.PanelLeft,{className:"w-3 h-3 mt-1"}),(0,s.jsx)("div",{className:"font-medium text-sm",children:e.displayName})]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},`${e.type}-${e.displayName}`))})};e.i(481908),e.i(176078),e.i(296343);let ts=(0,a.memo)((0,l.default)(()=>e.A(620966),{loadableGenerated:{modules:[336797]},loading:()=>(0,s.jsx)(eo.Button,{size:"icon",className:"rounded-full w-6 h-6 bg-transparent group",disabled:!0,children:(0,s.jsx)(eC.Paperclip,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors duration-200"})}),ssr:!1})),ta=(0,a.memo)((0,l.default)(()=>e.A(734408),{loadableGenerated:{modules:[478735]},loading:()=>(0,s.jsx)(eo.Button,{size:"icon",className:"rounded-full w-6 h-6 bg-transparent group",disabled:!0,children:(0,s.jsx)(eA.Unplug,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors duration-200"})}),ssr:!1}));function tn({chatType:e,onSubmit:t,addingSource:n,handleAddFileToChat:r}){let{formRef:l,onKeyDown:o}=(0,eB.useEnterSubmit)(),{setModal:d,setModalProps:u}=(0,v.useModal)(),{triggerLoopsEvent:m}=(0,eL.useUserAPI)(),h=(0,a.useRef)(null),[f,p]=(0,a.useState)(!1),[b,y]=(0,a.useState)(""),[j,k]=(0,a.useState)(-1),[S,E]=(0,a.useState)(0),[T,L]=(0,a.useState)("prompt"),[I,F]=(0,a.useState)(""),[U]=(0,a.useState)(()=>Math.random()>.5),[G,M]=(0,a.useState)(0),{data:$}=(0,_.useUserSubscription)(),{data:B,isLoading:z}=(0,_.useUserInformation)(),W=2400;$?.plan==="Lite"&&(W=4e3),["Pro","Plus","Team","Standard","team","Team"].includes($?.plan)&&(W=6e3);let{chatMode:q,attachments:H,setAttachments:V,updateAttachmentUploadProgress:X,setAttachmentUploadingToDone:J,isWorking:Q,isAutoPlay:Z,showRating:K,isOwner:Y,showFeedback:ee,showSlackCTA:et,isGenerating:es,setIsGenerating:ea,modelProvider:en,userMessageCount:er,setShowRating:el,setShowFeedback:ei,setShowSlackCTA:ec,setDataframeProps:ed,setShowTryAdvancedReasoning:em,showTryAdvancedReasoning:eh,fixingDataframe:ef,editingDataframe:ep,activeConversationId:ex,freeAndHasAttachmentsOrSources:eg,setCurrentSheet:eb,setFileValidationInfo:ey,toolPreferences:ev,startConversation:ej,creatingChat:ew,setCreatingChat:eN,setIsAutoPlay:ek,dataConnections:e_,dataConnectionMentions:eC,isFreeUser:eA,conversations:eZ,handleRemoveAttachment:eK}=(0,g.useChatContext)(),eY=(0,a.useMemo)(()=>{if(!e_)return[];let e=Object.keys(e_);return 0===e.length?[]:[e[0]]},[e_]),{handleEditorLoad:e1}=(0,eU.useSqlAceAutocomplete)({connectionIds:eY.length>0?eY:null,enabled:"sql"===T}),e2=ex||"new-chat",e4=B?.id||"",{draft:e6,setDraft:e8,clearDraft:e9}=(0,e$.useConversationDrafts)(e2,e4),{setIsSidebarOpen:te,handleToggleFullScreen:tn}=(0,eM.useSidebarsContext)(),tr=async()=>{ex&&(tn(),i.default.capture("chat_input:sql_tab_clicked",{source:"chat"}))};($?.plan==="Diamond"||$?.plan==="Premium")&&"anthropic"===en&&(W=2e4);let tl=(0,a.useCallback)(e=>{if(!e)return void p(!1);let t=e6.substring(0,j),s=e6.substring(h.current.selectionStart);e8(t+e.displayName+" "+s),p(!1),setTimeout(()=>{let t=j+e.displayName.length+1;h.current.setSelectionRange(t,t),h.current.focus()},0)},[e6,j,e8]),to=(0,a.useCallback)(e=>{if(!e)return[];let t=e.toLowerCase(),s=[];return Object.entries(e_).forEach(([e,a])=>{let n=a.schemas||[];n.forEach(e=>{e.name.toLowerCase().includes(t)&&s.push({type:"table",tableName:e.name,displayName:e.name,description:`Table with ${e.columnHeaders.length} columns`})}),n.forEach(e=>{e.columnHeaders.forEach(a=>{a.toLowerCase().includes(t)&&s.push({type:"column",tableName:e.name,columnName:a,displayName:`${e.name}.${a}`,description:`${a} column in ${e.name} table`})})})}),s},[e_]),ti=Object.keys(H).length>0,{showFreemiumBanner:tc}=(0,x.useBanners)();(0,a.useEffect)(()=>{e6.length===W&&(d("character_limit"),u({maxChars:W}))},[e6]),(0,a.useEffect)(()=>{h.current?.focus()},[ex]);let td=(0,R.useUploadFiles)(),{data:tu}=(0,R.useFiles)();(0,a.useEffect)(()=>{let e=e=>{if(es||tu&&tu.length>0&&tu.some(e=>e.isUploading))return void e.preventDefault()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[es,tu]);let tm=async e=>{let t=[],a=e.clipboardData.getData("text/plain");if(a.length&&i.default.capture("pasted_text",{conversationId:ex,pastedText:a,length:a.length}),a.length>W&&!ev?.disable_all){c.toast.info("We put large chunks of text into a file to improve readability for the AI."),e.preventDefault();let t=!1;try{JSON.parse(a),t=!0}catch(e){t=!1}if(t){let e=new Blob([a],{type:"application/json"}),t=1,s="paste.json";for(;H&&H[s];)s=`paste${t}.json`,t++;let n=new File([e],s,{type:"application/json"});await td.mutateAsync({files:[{file:n,filename:s,onProgress:X,onComplete:J,pastedText:a,originatingFunction:"chat-window-existing-paste"}]})}else{let e=1,t="paste.txt";for(;H&&H[t];)t=`paste${e}.txt`,e++;let s=new File([new Blob([a],{type:"text/plain"})],t,{type:"text/plain"});await td.mutateAsync({files:[{file:s,filename:s.name,pastedText:a,onProgress:X,onComplete:J}]})}}let n=e.clipboardData.items;if(n){for(let e of n)if(e.kind.includes("file")){if(eg){try{m("multiple_files_upgrade_cta_shown")}catch{console.error("Failed to trigger Loops event")}c.toast.warning((0,s.jsxs)("div",{className:"break-words",children:[w.FEATURE_FLAGS.IS_WEBVIEW?(0,s.jsx)(O.default,{href:"/settings",className:"underline text-primary",children:"Upgrade"}):(0,s.jsx)("a",{className:"underline text-primary",href:"/settings",target:"_blank",rel:"noopener noreferrer",onClick:e=>{i.default.capture("upgrade_button_clicked",{location:"multiple_files_toast"}),e.stopPropagation()},children:"Upgrade"})," ","to use multiple files in a chat"]})),i.default.capture("upgrade_cta_shown",{type:"toast",name:"multiple_files"}),"function"==typeof window.gtag&&(window.gtag("event","multiple_files_upgrade_cta_shown"),(0,N.trackLinkedInConversion)(0x15ba6b1));return}let a=e.getAsFile();if(a)if(H[a.name]){let e=a.name,s=1;for(;H[e];)e=`${a.name.slice(0,a.name.lastIndexOf("."))} (${s})${a.name.slice(a.name.lastIndexOf("."))}`,s++;let n=new File([a],e,{type:a.type});t.push(n)}else t.push(a)}let e=t.map(e=>({file:e,filename:e.name,onProgress:X,onComplete:J,originatingFunction:"temporary-files-list"}));await td.mutateAsync({files:e})}};(0,a.useEffect)(()=>{let e=document.getElementById("chat-input-box"),t=e=>{e8(e.detail)};return e.addEventListener("promptSelected",t),()=>{e.removeEventListener("promptSelected",t)}},[]);let th=()=>"sql"===T?I:e6,tf=eZ[ex]?.messages?.at(-1)?.userInputType===eT.WorkflowInputType.file;return(0,s.jsx)("form",{"data-cy":"chat-input-form",className:"flex relative z-50 flex-col justify-end w-full max-w-full transition-all duration-75 box-border ease-in-out pointer-events-auto group/prompt-form rounded-t-2xl",onSubmit:async e=>{if(e.preventDefault(),"prompt"===T&&h.current?.focus(),ew)return;if(Object.values(H).some(e=>e.isUploading))return Object.values(H).some(e=>e.isUploading&&"connection"===e.type)?void c.toast.warning("Wait for the connection to finish connecting"):void c.toast.warning("Wait for the file to finish uploading");let s=w.FEATURE_FLAGS.MENTION_CONNECTOR_SCHEMA&&"prompt"===T,a=th();if(""===a&&!ti)return void c.toast.error("Enter a message to send");if(ef||ep)return void c.toast.warning("Wait for the spreadsheet to finish editing");if(Q||es)return;s?(e8(""),M(e=>e+1)):"sql"===T?(F(""),L("prompt")):(e9(),h.current?.style&&(h.current.style.height="auto"));let n=a;if(C.eventEmitter.emit("submit-chat-form"),ed(null),eb(null),ey(null),!ex){let e=Object.values(H).filter(e=>e?.type!=="connection"),t=Object.values(H).find(e=>e?.type==="connection"),s=t?.name,a=s?Object.values(e_).find(e=>e.name===s||`${e.db_type} Connection`===s):void 0;eN(!0),ej({text:n.trim(),files:e,connection:a}).finally(()=>{eN(!1),te(!1)});return}if(ti){let e=Object.entries(H),t=[];for(let[s,a]of e)await r({sourceId:s,currentConversationId:ex}),s.endsWith(".png")||s.endsWith(".jpg")||!(s.length>3)||a?.type==="connection"||t.push({name:s});t.length&&(n=(0,eu.getTextWithUploadsMessage)(t,n)),V({})}await t({text:n.trim(),inputMode:T})},ref:l,"data-event":"quantitative"===q?"chat_data_message_submission":"chat_text_message_submission",children:(0,s.jsxs)("div",{className:"relative bg-background pb-2 rounded-t-2xl",children:[(0,s.jsxs)("div",{className:"bg-message rounded-xl",children:[(0,s.jsx)(A.AnimatePresence,{children:ex&&!Z&&!es&&K&&Y||ee||ex&&!Z&&!es&&et&&Y?(0,s.jsxs)(eQ,{onClose:()=>{K&&el(!1),ee&&(i.default.capture("advanced_reasoning_tip_clicked_not_now",{isFreeUser:eA}),em(!1),ei(!1)),et&&(i.default.capture(U?"chat:schedule-cta:dismissed":"chat:slack-cta:dismissed",{userMessageCount:er}),ec(!1))},children:[ex&&!Z&&!es&&K&&Y&&(0,s.jsx)(e7,{modelProvider:en,toolPreferences:ev,subscriptionPlan:$?.plan||"free",setShowRating:el,setShowFeedback:ei,setShowTryAdvancedReasoning:em,conversationId:ex,userMessageCount:er}),ee&&(0,s.jsx)(e0,{setShowTryAdvancedReasoning:em,showTryAdvancedReasoning:eh,conversationId:ex,setShowFeedback:ei,subscriptionPlan:$?.plan||"free"}),ex&&!Z&&!es&&et&&Y&&!K&&!ee&&(U?(0,s.jsx)(e3,{userMessageCount:er}):(0,s.jsx)(e5,{setShowSlackCTA:ec,userMessageCount:er}))]}):null}),(0,s.jsxs)("div",{className:"flex flex-col relative items-end max-w-full mx-auto bg-surface-1 overflow-hidden rounded-xl shadow-ring-md p-2.5",children:[f&&"prompt"===T&&(0,s.jsx)(tt,{searchQuery:b,onSelect:tl,selectedIndex:S,setSelectedIndex:E,inputRef:h,dataConnections:e_}),(0,s.jsxs)("div",{className:"relative w-full",children:[w.FEATURE_FLAGS.SEPARATE_DASHBOARDS&&(0,s.jsx)("div",{className:`h-full z-40 absolute top-0 right-0 w-[200px] ${0===Object.keys(H).length?"":"bg-gradient-to-l from-[#FFFFFF] from-50% dark:from-[#1A1A1A] to-transparent"}`,children:(0,s.jsx)(A.AnimatePresence,{children:e_&&Object.keys(e_).length>0?(0,s.jsx)(P.m.div,{initial:{y:"200%",opacity:0},animate:{y:0,opacity:1},exit:{y:"200%",opacity:0},transition:{delay:.2,duration:.5,type:"spring"},children:(0,s.jsx)(eG.Tabs,{defaultValue:"chat",value:"chat",className:"flex justify-end",children:(0,s.jsxs)(eG.TabsList,{className:"h-6 p-0.5 rounded-md",children:[(0,s.jsx)(eG.TabsTrigger,{value:"chat",className:"text-xs h-5 px-2.5",children:"Chat"},"chat"),(0,s.jsx)(eG.TabsTrigger,{value:"sql",className:"text-xs h-5 px-2.5",onClick:tr,children:"SQL"},"sql")]})})}):null})}),!tf&&(0,s.jsx)(eD.default,{attachments:H,onDeleteAttachment:e=>{eK(e.name)}})]}),(0,s.jsxs)("div",{className:"flex flex-1 w-full items-start",children:["prompt"===T?w.FEATURE_FLAGS.MENTION_CONNECTOR_SCHEMA?(0,s.jsx)(eF.default,{initialValue:e6??"Send a message...",onChange:e=>{e8(e)},onPaste:tm,mentionItems:eC},`pm-${G}`):(0,s.jsx)(eR.Textarea,{"data-cy":"chat-input-box",id:"chat-input-box","data-intercom-target":"chat-input-box",className:"subtle-scroll mb-1.5 z-30 w-full resize-none placeholder:text-tracking-tight overflow-y-auto p-1 border-none outline-none shadow-none border-color-transparent active:border-color-transparent focus:border-color-transparent active:outline-none focus:outline-none active:border-none focus:border-none focus:ring-0",ref:h,tabIndex:0,onKeyDown:e=>{if(f)if("ArrowDown"===e.key)e.preventDefault(),E(e=>e+1);else if("ArrowUp"===e.key)e.preventDefault(),E(e=>Math.max(0,e-1));else if("Enter"===e.key){e.preventDefault();let t=to(b);t[S]&&tl(t[S])}else"Escape"===e.key?(e.preventDefault(),p(!1)):o(e);else o(e)},value:e6,onChange:e=>{let t=e.target,s=t.value,a=t.selectionStart;e8(s);let n=s.substring(0,a),r=n.lastIndexOf("@");if(-1!==r){let e=n.substring(r+1);e.includes(" ")||e.includes("\n")?p(!1):(p(!0),y(e),k(r))}else p(!1);t.style.height="auto",t.scrollHeight<=160?t.style.height=`${t.scrollHeight}px`:t.style.height="160px"},onPaste:tm,placeholder:"Send a message...",spellCheck:!1,maxLength:W,autoFocus:!0}):(0,s.jsx)("div",{className:"w-full my-2 mx-6",children:(0,s.jsx)(eP.default,{className:"w-full rounded-sm",mode:"sql",theme:"one_dark",name:"sql-editor",value:I,onLoad:e1,fontSize:14,lineHeight:20,showPrintMargin:!1,showGutter:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,highlightActiveLine:!0,onChange:e=>{F(e)},onFocus:()=>{},minLines:3,maxLines:15,setOptions:{tabSize:2,useWorker:!1},style:{width:"100%",fontFamily:"monospace"},editorProps:{$blockScrolling:!0}})}),0===Object.keys(H).length&&e_&&Object.keys(e_).length>0?(0,s.jsx)("div",{className:"w-[120px] h-full"}):null]}),(0,s.jsxs)("div",{className:"h-7 flex flex-1 gap-1.5 w-full justify-between items-center",children:[(0,s.jsx)(ts,{chatType:e,className:"w-[250px]"}),(0,s.jsxs)("div",{className:"h-7 flex flex-1 min-w-0 flex-row flex-wrap items-center justify-between w-full",children:[!B||z?(0,s.jsxs)("div",{className:"flex gap-1.5 items-center rounded-md ",children:[(0,s.jsx)(eO.Skeleton,{className:"w-16 h-6"}),(0,s.jsx)(eO.Skeleton,{className:"w-18 h-6"}),w.FEATURE_FLAGS.PLANNING_MODE&&(0,s.jsx)(eO.Skeleton,{className:"hidden sm:block w-32 h-6"})]}):(0,s.jsxs)("div",{className:"flex flex-1 h-full gap-1.5 items-center rounded-md fade-in-animation [container-type:inline-size]",children:[(0,s.jsx)(ta,{triggerButton:(0,s.jsx)(ez.default,{}),className:"w-[250px]"}),(0,s.jsx)(eJ.default,{}),w.FEATURE_FLAGS.CUSTOM_AGENTS&&(0,s.jsx)(eV.default,{}),w.FEATURE_FLAGS.PLANNING_MODE&&!w.FEATURE_FLAGS.IS_HBS&&(0,s.jsx)(eq.default,{}),w.FEATURE_FLAGS.EXTENDED_MEMORY&&(0,s.jsx)(eX.default,{})]}),e6?.length>.8*W&&(0,s.jsxs)("div",{className:"flex flex-row items-center bg-background",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground/60",children:e6.length}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground/60",children:["/",W]})]})]}),(0,s.jsxs)("div",{className:"z-50 flex flex-row gap-1.5 items-center",children:[(0,s.jsx)(eH.default,{}),es?(0,s.jsx)(eo.Button,{type:"button","data-event":"chat_stop",size:"icon",className:"rounded-full w-7 h-7 p-1 bg-primary border-none shadow-none",onClick:e=>{e.preventDefault(),(0,eI.handleCloseConnection)(),ek(!1),ea(!1)},children:(0,s.jsx)(eE.Square,{className:"shrink-0 w-4 h-4"})}):ew?(0,s.jsx)(eo.Button,{type:"submit",size:"icon",className:"rounded-full w-7 h-7 p-1 bg-primary border-none shadow-none",disabled:!0,children:(0,s.jsx)(D.Loader2,{className:"shrink-0 w-4 h-4 animate-spin"})}):(0,s.jsx)("div",{onClick:()=>{""!==th()||ti?(ef||ep)&&c.toast.warning("Wait for the spreadsheet to finish editing"):c.toast.error("Enter a message to send")},children:(0,s.jsx)(eo.Button,{type:"submit",size:"icon",className:"rounded-full w-7 h-7 p-1 bg-primary border-none shadow-none",disabled:ef||ep||Q||es||""===th()||n,children:(0,s.jsx)(eS.ArrowUp,{className:"shrink-0 w-5 h-5 "})})})]})]})]})]}),tc&&(0,s.jsx)("div",{className:"mt-1 flex justify-center",children:(0,s.jsx)(eW.default,{})})]})})}let tr=()=>{let{setShowUpgradeBanner:e}=(0,g.useChatContext)(),{setModal:t}=(0,a.useContext)(v.ModalContext),n=(0,o.useRouter)(),r=t=>{t.stopPropagation(),e(!1)};return(0,s.jsxs)("div",{className:"relative flex flex-col justify-center items-start py-2 px-5 lg:px-4 rounded-t-2xl bg-accent border-x border-t border-border w-full shadow-lg group",style:{zIndex:40},id:"upgrade-card",children:[(0,s.jsx)("div",{className:"absolute inset-0 translate-y-full border-x border-border bg-accent -mx-[1px]",style:{zIndex:30}}),(0,s.jsx)(eo.Button,{variant:"ghost",size:"icon",className:"absolute -right-2 lg:-right-2 -right-1 -top-2 lg:-top-2 -top-1 rounded-full h-6 w-6 p-1 bg-accent border border-border opacity-0 group-hover:opacity-100 transition-opacity duration-100",onClick:r,children:(0,s.jsx)(F.X,{className:"w-5 h-5 text-muted-secondary",strokeWidth:2})}),(0,s.jsxs)("div",{className:"flex flex-row gap-3 w-full items-center",children:[(0,s.jsx)("span",{className:"text-sm font-normal cursor-pointer sm:cursor-default",onClick:e=>{window.innerWidth<640&&r(e)},children:"Want deeper analysis? Get unlimited messages and advanced reasoning"}),(0,s.jsxs)("div",{className:"flex ml-auto gap-1 text-muted-foreground",children:[(0,s.jsx)(eo.Button,{variant:"ghost",size:"xs",className:"hidden sm:block",onClick:()=>n.push("/settings/subscription"),children:"See Plans"}),(0,s.jsx)(eo.Button,{size:"xs",className:"bg-primary hover:bg-blue-700 text-white shadow-md",onClick:()=>t("subscribe"),children:"Upgrade"})]})]})]})},tl=(0,a.memo)(({addingSource:e,handleAddFileToChat:t,chatType:a,messageListIsAtBottom:n})=>{let{generateBotResponse:r}=(0,y.useMessageContext)(),{isAutoPlay:l,showTryAdvancedReasoning:o,showUpgradeBanner:i,activeConversationId:c,isOwner:d,conversations:u,messageListHandle:m,dataConnections:h}=(0,g.useChatContext)(),f=async(e,t)=>{if("sql"===t&&Object.keys(h).length>0){let t=Object.keys(h)[0],s=h?.[t],a=(0,C.getCodeLanguageForConnection)(s);await r({content:e,role:"user",code_language:a,code_connection_id:t,code_df_name:"sql_output_df_"+String.fromCharCode(97+Math.floor(26*Math.random()))+Date.now().toString().slice(-3),mode:"code",julius_app:"chat"})}else await r({content:e,role:"user",julius_app:"chat"})},p=u[c]?.messages||[];return l?null:(0,s.jsxs)("div",{className:"absolute bottom-0 z-50 flex-shrink-0 transition-none max-w-full self-center w-full min-w-0 md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent md:w-full items-center flex flex-col gap-0 md:gap-2 rounded-t-3xl transition-width duration-300 ease-in-out pr-3 overflow-visible pointer-events-none",children:[(0,s.jsx)(A.AnimatePresence,{initial:!1,children:p.length>0&&!n&&(0,s.jsx)(P.m.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},className:"relative flex justify-center z-[50] rounded-lg bg-transparent pointer-events-none",children:(0,s.jsxs)(J.Tooltip,{children:[(0,s.jsx)(J.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{type:"button",className:`${o?"mb-0":"mb-3"} min-w-8 min-h-8 flex items-center py-1 rounded-full justify-center bg-background border border-input hover:bg-sidebackground pointer-events-auto`,onClick:()=>{m.current.scrollToIndex({index:"LAST",align:"end",behavior:"smooth"})},children:(0,s.jsx)(e_.ArrowDown,{size:18})})}),(0,s.jsx)(J.TooltipContent,{children:"Jump to bottom"})]})})}),(0,s.jsxs)("div",{className:"relative resizable-chat-width pointer-events-none",children:[!l&&i&&d&&(0,s.jsx)("div",{className:"pointer-events-auto",children:(0,s.jsx)(tr,{})}),(0,s.jsx)("div",{className:"pointer-events-auto",children:(0,s.jsx)(tn,{chatType:a,onSubmit:({text:e,inputMode:t})=>void f(e,t),addingSource:e,handleAddFileToChat:t})})]})]})});tl.displayName="ChatPanel";var to=e.i(413801);function ti({className:e,size:t=60,duration:n=5,style:r}){let l=(0,a.useRef)(`border-trail-${Math.random().toString(36).substring(2,11)}`);return(0,a.useEffect)(()=>{let e=`${l.current}-style`;if(!document.getElementById(e)){let t=document.createElement("style");return t.id=e,t.textContent=`
        @keyframes ${l.current} {
          0% { offset-distance: 0%; }
          100% { offset-distance: 100%; }
        }
      `,document.head.appendChild(t),()=>{let t=document.getElementById(e);t&&t.remove()}}},[]),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-[inherit] border border-transparent [mask-clip:padding-box,border-box] [mask-composite:intersect] [mask-image:linear-gradient(transparent,transparent),linear-gradient(#000,#000)]",children:(0,s.jsx)("div",{className:(0,C.cn)("absolute aspect-square bg-zinc-500",e),style:{width:t,offsetPath:`rect(0 auto auto 0 round ${t}px)`,animation:`${l.current} ${n}s linear infinite`,...r}})})}var tc=e.i(300549);function td(){let[e,t]=(0,a.useState)(!1),[n,r]=(0,a.useState)(!1),{data:l,isLoading:o}=(0,u.useConnectors)(),{data:c,isLoading:d}=(0,u.useUserConnections)();(0,a.useEffect)(()=>{try{let e=localStorage.getItem("postgres-banner-dismissed");"true"===e&&r(!0)}catch(e){}},[]);let m=l?.find(e=>"Postgres"===e.name),h=!c||0===c.length;return o||d||!m||n||!h?null:(0,s.jsx)(to.default,{connector:m,isOpen:e,onOpenChange:t,mode:"create",children:(0,s.jsx)("div",{className:"w-full max-w-2xl mx-auto px-4 py-3",children:(0,s.jsxs)("div",{className:"group flex items-center gap-3 w-full max-w-4xl mx-auto px-4 py-3 rounded-lg relative overflow-visible cursor-pointer",onClick:()=>{i.default.capture("chat:banner:postgres-connect-clicked",{}),t(!0)},children:[(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),i.default.capture("chat:banner:postgres-dismissed",{}),r(!0);try{localStorage.setItem("postgres-banner-dismissed","true")}catch(e){}},className:"absolute -top-2 -right-2 z-20 flex items-center justify-center w-6 h-6 rounded-full bg-background/80 hover:bg-background border border-input transition-all opacity-0 group-hover:opacity-100 pointer-events-auto","aria-label":"Dismiss banner",children:(0,s.jsx)(F.X,{size:14,className:"text-muted-foreground"})}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-primary/10 rounded-lg"}),(0,s.jsx)(ti,{className:"bg-gradient-to-l from-blue-200 via-blue-500 to-blue-200 dark:from-blue-400 dark:via-blue-500 dark:to-blue-700",size:120}),(0,s.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center w-10 h-10 rounded-full relative z-10",children:(0,s.jsx)(U.default,{src:"https://r2.julius.ai/connector_logos/Postgres_logo.png",alt:"Postgres",width:32,height:32,className:"w-8 h-8"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 relative z-10",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-foreground leading-tight",children:"Connect Your Database Now"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5 leading-tight",children:"5x better analysis. Create Dashboards and Scheduled Reports."})]}),(0,s.jsx)("div",{className:"flex-shrink-0 relative z-10",children:(0,s.jsx)("button",{className:"px-4 py-2 bg-primary text-white text-sm font-medium rounded-md hover:bg-primary/90 transition-colors whitespace-nowrap",children:(0,s.jsx)(tc.TextShimmer,{duration:2,repeatDelay:1,className:"text-sm text-white font-medium [--base-color:#ffffff] [--base-gradient-color:#93c5fd] dark:[--base-color:#ffffff] dark:[--base-gradient-color:#93c5fd]",as:"span",children:"Connect"})})})]})})})}var tu=e.i(277604);let tm=()=>{let{handleValidateSpreadsheet:e,editRemoteDataFrame:t}=(0,G.useAuthenticatedAPIs)(),{attachments:n,activeConversationId:r,editingDataframe:l,setEditingDataframe:o,validatingDataframe:c,setValidatingDataframe:d,fixingDataframe:u,setFixingDataframe:m,setSheets:h,currentSheet:f,setCurrentSheet:p,dataframeProps:x,fileValidationInfo:b,setFileValidationInfo:y,setDataframePreviewChanged:v,setDataframeProps:j}=(0,g.useChatContext)(),{setFilename:w,filename:N,setHoveredIssueIndex:k,setIsRightSidebarOpen:_}=(0,eM.useSidebarsContext)(),S=c||u||l,E=()=>!["csv"].includes(x?.filename?.split(".").pop().toLowerCase());(0,a.useEffect)(()=>{if(x){_(!0);try{i.default.capture("dataframe_preview_on_attach",{filename:x.filename})}catch(e){console.error("PostHog error: ",e)}w(x?.filename),E()&&(h(()=>{let e={...x.sheets};for(let t of Object.values(e))"validated"in t||(t.validated=!1);return e}),p(Object.keys(x?.sheets||{})[0]))}},[x]),(0,a.useEffect)(()=>{let e=Object.keys(b||{}).find(e=>{let t=b[e]?.issues,s=t?.column_headers_on_row>-1&&t?.column_headers_on_row!==null,a=t?.empty_rows_indices?.length>0;return s||a});e?p(e):x?.sheets&&p(Object.keys(x?.sheets||{})[0])},[b,x]),(0,a.useEffect)(()=>{let e=C.eventEmitter.addListener("navigateToBadSheet",()=>{let e=Object.keys(b||{}).find(e=>{let t=b[e]?.issues,s=t?.column_headers_on_row>-1&&t?.column_headers_on_row!==null,a=t?.empty_rows_indices?.length>0;return s||a});e&&p(e)});return()=>{e.remove()}},[b,p]);let A=async({sheet_name:e,...s})=>{if(S)return;y(t=>({...t,[e]:null})),o(!0);let a=await t({...s,filename:N,sheet_name:e});if(a?.dataframeProps){let{data:t,columns:s}=a.dataframeProps;["csv"].includes(a?.filename.split(".").pop().toLowerCase())?j({filename:a?.filename,columns:a?.dataframeProps?.columns,data:a?.dataframeProps?.data}):j({filename:a?.filename,sheets:a?.dataframeProps?.sheets}),h(a=>({...a,[e]:{data:t,columns:s}}))}o(!1)},P=async(t,s)=>{let a=[];for(let e=0;e<s.data?.length;e++){let t={};for(let a=0;a<s.columns?.length;a++)t[s.columns[a]]=s.data[e][a];a.push(t)}d(!0);let n=await e({dataframe_json:a});if(r){y(null),d(!1);return}y(e=>({...e,[t]:n})),d(!1)},T=async(e=!0,s="main")=>{if(k(null),S)return;if(!e){i.default.capture("dfp_ignore_blank_rows");let e={...b};delete e[s].issues.empty_rows_indices,y(e);return}m(!0),i.default.capture("dfp_fix_blank_rows");let a=b?.[s]?.issues?.empty_rows_indices;y(e=>({...e,[s]:null}));let r=await t({filename:N,type:"removeBlankRows",blank_rows:a,sheet_name:s});if(r?.dataframeProps&&Object.hasOwn(n,N)){let{data:e,columns:t}=r.dataframeProps;j(a=>({...a,sheets:{...a?.sheets,[s]:{data:e,columns:t}}})),h(a=>({...a,[s]:{data:e,columns:t}})),P(s,{data:e,columns:t})}m(!1)},L=async(e=!0,s="main")=>{if(!S){if(!e){i.default.capture("dfp_ignore_header_issues");let e={...b};delete e[s].issues.column_headers_on_row,y(e);return}if(m(!0),b?.[s]?.issues?.column_headers_on_row>-1&&b?.[s]?.issues?.column_headers_on_row!==null){i.default.capture("dfp_fix_header_issues");let e=b?.[s]?.issues?.column_headers_on_row;y(e=>({...e,[s]:null}));let a=await t({filename:N,type:"setHeader",rowIndex:e,sheet_name:s});if(v(!0),a?.dataframeProps&&Object.hasOwn(n,N)){let{data:e,columns:t}=a.dataframeProps;j(a=>({...a,sheets:{...a?.sheets,[s]:{data:e,columns:t}}})),h(a=>({...a,[s]:{data:e,columns:t}})),P(s,{data:e,columns:t})}}k(null),m(!1)}},D=b?.[f]?.issues?.column_headers_on_row>-1&&b?.[f]?.issues?.column_headers_on_row!==null,I=!l&&D?{column:b?.[f].issues.column_headers_on_row,onClick:L}:null;return E()?(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-1 max-w-full w-full h-full pb-[195px] overflow-auto",children:[(0,s.jsx)(tu.DataframeDisplay,{filename:N,columns:x?.sheets[f]?.columns,rows:x?.sheets[f]?.data,sheetName:f,editDataframe:A,headerFix:I,enableRightClick:!0,fixBlankRows:T,hasHeaderIssues:D,showInteractivePlot:!0}),(0,s.jsx)("div",{className:"h-24"})]}):(0,s.jsx)("div",{className:"flex flex-col items-center space-y-1 max-w-full w-full h-full pb-[195px] overflow-auto",children:(0,s.jsx)(tu.DataframeDisplay,{filename:x.filename,columns:x?.sheets?.main?.columns??x?.columns,rows:x?.sheets?.main?.data??x?.data,editDataframe:A,enableRightClick:!0,fixBlankRows:T,showInteractivePlot:!0})})};function th({icon:e,title:t,description:a,onClick:n,className:r="",variant:l="default"}){return"compact"===l?(0,s.jsxs)("button",{onClick:n,className:`flex items-center gap-1.5 p-2 border border-border rounded-md hover:bg-message transition-colors text-left shrink-0 ${r}`,children:[(0,s.jsx)("div",{className:"shrink-0 text-muted-foreground",children:e}),(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground leading-[14px] whitespace-nowrap",children:t})]}):(0,s.jsxs)("button",{onClick:n,className:`flex items-start gap-1.5 p-3 border border-border rounded-lg hover:bg-message transition-colors text-left w-full ${r}`,children:[(0,s.jsx)("div",{className:"shrink-0 mt-[1px] text-foreground",children:e}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 min-w-0 flex-1",children:[(0,s.jsx)("h3",{className:"text-xs font-medium text-foreground leading-[14px] truncate",children:t}),a&&(0,s.jsx)("p",{className:"text-xs font-normal text-muted-foreground leading-4",children:a})]})]})}e.i(686311),e.i(840433);var tf=e.i(187378),tp=e.i(63727),tx=e.i(285041),tg=e.i(658041),tb=e.i(931091),ty=e.i(107233),tv=e.i(560730),tj=e.i(796610),tw=e.i(637847);let tN=[{id:"marketing",label:"Marketing",icon:tb.Megaphone},{id:"finance",label:"Finance",icon:tf.Banknote},{id:"product",label:"Product",icon:tx.ChartLine},{id:"data",label:"Data",icon:tg.Database},{id:"revops",label:"RevOps",icon:tp.Briefcase}];function tk({category:e,isActive:t,onClick:a}){let n=e.icon;return(0,s.jsxs)(eo.Button,{onClick:a,variant:"ghost",size:"sm",className:(0,C.cn)("flex gap-1.5 items-center h-7 px-2 py-1 text-muted-foreground rounded-sm",t&&"bg-muted text-foreground"),children:[(0,s.jsx)(n,{className:"size-3.5"}),(0,s.jsx)("span",{className:"text-sm font-medium leading-[14px] tracking-[-0.14px]",children:e.label})]})}function t_(){let e=(0,o.useRouter)(),[t,n]=(0,a.useState)("marketing"),[r,l]=(0,a.useState)(!1),{data:c}=(0,tj.useCurrentTeam)(),{data:d,isLoading:u}=(0,tv.useGetTemplateCustomAgents)(),m=(0,tv.useCreateCustomAgent)(),h=!c?.details?.feature_flags?.includes("ENTERPRISE_CUSTOM_AGENTS"),f=(d?.agents||[]).filter(e=>e.category===t),p="New Agent - "+new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),x=async()=>{if(h){i.default.capture("custom_agents:upgrade_clicked",{source:"new_chat_template_section"}),e.push("/settings/subscription");return}l(!0);try{let t=await m.mutateAsync({name:p,config:{description:""}});t.success&&t.agent&&(i.default.capture("custom_agents:agent_created",{source:"new_chat_template_section",agent_type:"custom"}),e.push(`/custom-agents/${t.agent.id}`))}catch(e){console.error("Error creating agent:",e)}finally{l(!1)}};return(0,s.jsxs)("div",{className:"hidden md:flex flex-col gap-3 w-full",children:[(0,s.jsxs)("div",{className:"relative flex items-center w-full",children:[(0,s.jsx)("div",{className:"flex gap-1.5 items-center flex-1 min-w-0 overflow-x-auto pr-[220px] [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:tN.map(e=>(0,s.jsx)(tk,{category:e,isActive:t===e.id,onClick:()=>n(e.id)},e.id))}),(0,s.jsx)("div",{className:"absolute right-0 top-0 bottom-0 flex items-center bg-background z-10",children:h?(0,s.jsxs)(eo.Button,{onClick:x,disabled:r,variant:"primary-light",size:"sm",className:"flex gap-1.5 items-center h-7 px-2 py-1 shrink-0 whitespace-nowrap",children:[(0,s.jsx)(eS.ArrowUp,{className:"size-3.5"}),(0,s.jsx)("span",{className:"text-sm font-medium leading-[14px] tracking-[-0.14px]",children:"Upgrade to customize agents"})]}):(0,s.jsxs)(eo.Button,{onClick:x,disabled:r,variant:"ghost",size:"sm",className:"flex gap-1.5 items-center h-7 px-2 py-1 text-muted-foreground shrink-0 whitespace-nowrap",children:[(0,s.jsx)(ty.Plus,{className:"size-3.5"}),(0,s.jsx)("span",{className:"text-sm font-medium leading-[14px] tracking-[-0.14px]",children:r?"Creating...":"Create custom agent"})]})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 w-full",children:u?Array.from({length:4}).map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-col gap-1 border border-border rounded-lg px-4 py-3 bg-background",children:[(0,s.jsx)(eO.Skeleton,{className:"h-4 w-3/4"}),(0,s.jsx)(eO.Skeleton,{className:"h-3 w-full mt-1"}),(0,s.jsx)(eO.Skeleton,{className:"h-3 w-5/6 mt-0.5"})]},t)):f.length>0?f.map(e=>(0,s.jsx)(tw.TemplateAgentCard,{agent:e},e.id)):(0,s.jsx)("div",{className:"col-span-full border border-border rounded-lg p-3",children:(0,s.jsxs)("p",{className:"text-base text-muted-foreground text-center",children:["No agents available for ",t]})})})]})}var tS=e.i(871689),tC=e.i(988846),tE=e.i(463415),tA=e.i(23750),tP=e.i(694937);function tT({workflows:e,isLoading:t=!1,icon:n,onSelectWorkflow:r,variant:l="default"}){let[o,i]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(null),h=(0,a.useMemo)(()=>{let t={};return Object.keys(tP.TAG_GROUPS).forEach(s=>{let a=tP.TAG_GROUPS[s],n=e.filter(e=>e.plan.tags?.some(e=>a.includes(e)));n.length>0&&(t[s]=n)}),t},[e]),f=Object.keys(h).sort(),p=(0,a.useMemo)(()=>{if(!c)return e;let t=c.toLowerCase();return e.filter(e=>e.plan.name.toLowerCase().includes(t)||e.plan.description?.toLowerCase().includes(t))},[e,c]),x=e=>(0,s.jsx)(tE.DropdownMenuItem,{onClick:()=>{i(!1),d(""),m(null),r(e)},className:"cursor-pointer focus:bg-accent focus:text-accent-foreground h-fit py-1.5",children:(0,s.jsxs)("div",{className:"flex flex-col gap-0.5 w-full h-fit",children:[(0,s.jsx)("span",{className:"text-sm font-medium truncate",children:e.plan.name}),e.plan.description&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground truncate",children:e.plan.description})]})},e.public_id),g=e=>(0,s.jsx)("div",{className:"px-2 py-6 text-center text-sm text-muted-foreground",children:e});return(0,s.jsxs)(tE.DropdownMenu,{open:o,onOpenChange:e=>{i(e),e||(d(""),m(null))},children:[(0,s.jsx)(tE.DropdownMenuTrigger,{asChild:!0,children:"compact"===l?(0,s.jsxs)("button",{className:"flex items-center gap-1.5 p-2 border border-border rounded-md hover:bg-message transition-colors text-left shrink-0",children:[(0,s.jsx)("div",{className:"shrink-0 text-muted-foreground",children:n}),(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground leading-[14px] whitespace-nowrap",children:"Start from a template"}),(0,s.jsx)(z.ChevronDown,{className:"shrink-0 w-3.5 h-3.5 text-muted-foreground"})]}):(0,s.jsxs)("button",{className:"flex items-start gap-1.5 p-3 border border-border rounded-lg hover:bg-message transition-colors text-left w-full",children:[(0,s.jsx)("div",{className:"mt-[1px] text-foreground",children:n}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 min-w-0 flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("h3",{className:"text-xs font-medium text-foreground leading-[14px] truncate",children:"Start from a template"}),(0,s.jsx)(z.ChevronDown,{className:"shrink-0 w-3.5 h-3.5 text-muted-foreground"})]}),(0,s.jsx)("p",{className:"text-xs font-normal text-muted-foreground leading-4",children:"Use analysis workflows from expert analysts"})]})]})}),(0,s.jsxs)(tE.DropdownMenuContent,{align:"start",side:"bottom",className:"w-[320px] h-[302px] bg-background p-0 m-0",avoidCollisions:!1,children:[(0,s.jsx)("div",{className:"sticky top-0 bg-background p-1 z-10",children:(0,s.jsxs)("div",{className:"relative",children:[u||c?(0,s.jsx)("button",{onClick:()=>{m(null),d("")},className:"absolute left-2 top-1/2 -translate-y-1/2 hover:bg-accent rounded p-0.5 transition-colors",children:(0,s.jsx)(tS.ArrowLeft,{className:"w-3.5 h-3.5 text-muted-foreground"})}):(0,s.jsx)(tC.SearchIcon,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground"}),(0,s.jsx)(tA.Input,{type:"search",placeholder:"Search notebooks...",value:c,onChange:e=>d(e.target.value),className:"w-full text-xs pl-7 h-8 bg-message border-none rounded-sm"})]})}),(0,s.jsxs)("div",{className:"h-[256px] px-1 subtle-scroll overflow-y-auto",children:[t&&g("Loading workflows..."),!t&&c&&(0,s.jsxs)(s.Fragment,{children:[0===p.length&&g("No templates found"),p.length>0&&p.map(x)]}),!t&&!c&&u&&(0,s.jsxs)(s.Fragment,{children:[h[u]?.length===0&&g("No templates available"),h[u]?.length>0&&h[u].map(x)]}),!t&&!c&&!u&&(0,s.jsxs)(s.Fragment,{children:[0===f.length&&g("No templates available"),f.length>0&&f.map(e=>(0,s.jsx)(tE.DropdownMenuItem,{onClick:t=>{t.preventDefault(),m(e)},className:"cursor-pointer focus:bg-accent focus:text-accent-foreground h-fit py-1.5",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,s.jsxs)("div",{className:"text-sm flex-1 items-center min-w-0",children:[(0,s.jsx)("span",{className:"truncate",children:e}),(0,s.jsx)("span",{className:"text-xs/tight text-muted-foreground ml-1.5 shrink-0",children:h[e]?.length||0})]}),(0,s.jsx)(ew.ChevronRight,{className:"size-3 shrink-0 text-muted-foreground"})]})},e))]})]})]})]})}let tL=(0,l.default)(()=>e.A(716266).then(e=>e.WelcomePromptForm),{loadableGenerated:{modules:[619094]},loading:()=>(0,s.jsx)(eO.Skeleton,{className:"h-10 w-full rounded-3xl"}),ssr:!1}),tD=(0,a.memo)(({addingSource:e,numMessages:t,handleAddFileToChat:n,chatType:r})=>{let{generateBotResponse:l}=(0,y.useMessageContext)(),{isAutoPlay:o}=(0,g.useChatContext)(),i=(0,a.useCallback)(async({text:e})=>{await l({content:e,role:"user",julius_app:"chat"})},[l]);return o?null:(0,s.jsx)("div",{className:"flex-shrink-0 transition-none max-w-full self-center w-full min-w-0 md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent md:w-full items-center flex flex-col gap-0 md:gap-2 rounded-t-3xl transition-width duration-300 ease-in-out pl-4 pr-4",children:(0,s.jsx)("div",{className:"relative resizable-chat-width",children:(0,s.jsx)(tL,{chatType:r,onSubmit:i,numMessages:t,addingSource:e,handleAddFileToChat:n})})})});tD.displayName="ChatPanel",new Date().setHours(0,0,0,0);let tI=e=>{let t="compact",n=(0,o.useRouter)(),{breakpoint:r}=(0,j.useUserContext)(),l="initial"===r||"xs"===r||"sm"===r,{dataframeProps:c}=(0,g.useChatContext)(),[d,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),{data:f,isLoading:x}=(0,ek.usePublicWorkflows)({searchTerm:"",page:1,pageSize:500,tags:[],selectedTab:"",requireCategory:!0}),b=f?.workflows||[];return c&&!l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mx-auto flex h-full w-full flex-1 flex-col items-center overflow-auto self-center rounded-xl px-2 text-center md:max-w-3xl md:p-5 md:pt-0 lg:max-w-7xl z-10",children:(0,s.jsx)(tm,{})}),(0,s.jsx)(tl,{chatType:e.chatType,addingSource:e.addingSource,numMessages:e.numMessages,handleAddFileToChat:e.handleAddFileToChat,messageListIsAtBottom:!0})]}):(0,s.jsx)("div",{className:"w-full h-full overflow-auto overflow-x-hidden",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto flex flex-col justify-center px-4 sm:px-6 lg:px-8 pb-8 space-y-8 self-start h-full md:h-auto resizable-chat-width",style:{paddingTop:l?"0":"20vh"},children:[(0,s.jsx)("div",{className:"pointer-events-auto h-16 hidden md:block",children:w.FEATURE_FLAGS.BIG_POSTGRES_CTA&&(0,s.jsx)(td,{})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-medium tracking-tight text-center",children:"What do you want to analyze today?"}),(0,s.jsx)("div",{className:"mx-[-1rem]",children:(0,s.jsx)(tD,{chatType:e.chatType,addingSource:e.addingSource,numMessages:e.numMessages,handleAddFileToChat:e.handleAddFileToChat})})]}),!w.FEATURE_FLAGS.IS_HBS&&(0,s.jsxs)("div",{className:"space-y-24 flex flex-col items-center w-full",children:[(0,s.jsxs)("div",{className:"flex gap-1.5 flex-row flex-wrap justify-center",children:[(0,s.jsx)(tT,{workflows:b,isLoading:x,icon:(0,s.jsx)(W.LineChart,{className:"w-3.5 h-3.5"}),onSelectWorkflow:e=>{i.default.capture("workflow_preview_card_clicked",{workflow_id:e.id}),u(e),h(!0)},variant:t}),(0,s.jsx)(th,{icon:(0,s.jsx)(U.default,{src:"/slack.svg",alt:"Slack",width:14,height:14,className:"w-3.5 h-3.5"}),title:"Connect Slack",description:"Get analysis without leaving Slack",onClick:()=>{i.default.capture("suggestion_card_clicked",{card:"slack"}),n.push("/data-connectors")},variant:t}),(0,s.jsx)(th,{icon:(0,s.jsx)(U.default,{src:"https://r2.julius.ai/postgres-logo.png",alt:"Postgres",width:14,height:14,className:"w-3.5 h-3.5 object-contain"}),title:"Connect Postgres",description:"Connect your database to get instant analysis",onClick:()=>{i.default.capture("suggestion_card_clicked",{card:"postgres"}),n.push("/data-connectors#postgres")},variant:t})]}),w.FEATURE_FLAGS.NEW_CHAT_AGENT_SUGGESTIONS&&(0,s.jsx)(t_,{})]}),(0,s.jsx)(p.Dialog,{open:m,onOpenChange:h,children:(0,s.jsxs)(p.DialogContent,{className:"p-0 max-h-[90vh] max-w-[90%] xl:max-w-[1200px] w-full",children:[(0,s.jsx)(p.DialogTitle,{hidden:!0,children:"Workflow Preview"}),d&&(0,s.jsx)(eN.ModalWorkflowPreview,{workflow:d})]})})]})})};var tF=e.i(723402);let tU="true"===t.default.env.NEXT_PUBLIC_CACHE_LOCAL_STORAGE,tO=(0,l.default)(()=>e.A(563169).then(e=>e.ToastComponents),{loadableGenerated:{modules:[120594]},ssr:!1}),tG=(0,l.default)(()=>e.A(700328),{loadableGenerated:{modules:[797389]},ssr:!1});e.s(["default",0,({addingSource:e})=>{let t=(0,o.useSearchParams)(),l=(0,o.useRouter)(),{user:A,isAuthenticated:P}=(0,n.useAuth0)(),[T,L]=(0,a.useState)(!0),[D,I]=(0,a.useState)(!1),F=(0,a.useRef)(null),[U]=(0,a.useState)(!0),[O,G]=(0,a.useState)(!1),{conversations:R,setModelProvider:M,setButtons:$,setConversations:B,isGenerating:z,setIsGenerating:W,handleAddFileToChat:q,startingMessage:H,setStartingMessage:V,setAttachments:X,isOwner:J,handleSelectDataConnection:Q,userMessageCount:Z,isFreeUser:K}=(0,g.useChatContext)(),{data:Y}=(0,m.useGoogleOauthToken)(),{data:ee}=(0,f.useMicrosoftOauthToken)("sharepoint"),{modal:et,setModal:es,setModalProps:ea}=(0,v.useModal)(),{data:en}=(0,_.useSurveyResponse)(null),{data:er}=(0,k.useUserOnboarding)(),{data:el}=(0,_.useUserInformation)(),eo=t.get("id"),{setMessagesSent:ei}=(0,x.useBanners)(),ec=(0,a.useMemo)(()=>{let e=(0,C.checkMobile)();if(!e)return!1;try{i.default.setPersonProperties({},{isMobile:!0})}catch(e){console.error("Error setting person property of user:",e)}return e},[]);(({threshold:e=25e3,interval:t=1e4,conversationId:s})=>{let n=(0,a.useRef)(null),r=(0,a.useRef)(!1),l=w.FEATURE_FLAGS.version;(0,a.useEffect)(()=>{s&&(r.current=!1)},[s]),(0,a.useEffect)(()=>{if(!s)return;n.current=document.getElementsByTagName("*");let a=setInterval(async()=>{let t=n.current.length;t>e&&!r.current&&(await fetch(`${w.BASE_API}/performance_warning/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeCount:t,baseAPI:w.BASE_API,version:l})}),console.warn(`Warning: DOM node count (${t}) exceeds threshold of ${e}`),r.current=!0)},t);return()=>clearInterval(a)},[e,t,s])})({conversationId:eo});let{generateBotResponse:ed}=(0,y.useMessageContext)(),{labelConversation:eu,patchConversation:em,generateOptions:eh,prepServer:ef}=(0,d.useChatAPI)(),ep=async e=>{let t=await eu(e,null);t.label&&(B(s=>({...s,[e]:{...s?.[e]||{},name:t.label}})),em({conversationId:e,name:t.label,tempUserId:null}))},{breakpoint:eg}=(0,j.useUserContext)(),eb="initial"===eg||"xs"===eg||"sm"===eg||"md"===eg;(0,a.useEffect)(()=>{let e=!1,t=Y?.scopes?.includes(h.GOOGLE_OAUTH_SCOPES.ADS),s=en?.responses?.[1]?.answer;try{e=localStorage?.getItem("shownGoogleAds")==="true"}catch(e){console.error(e)}Z<3||eb||e||et?.length>0||(("Marketing"!==s||t)&&("Finance"!==s&&"Operations"!==s&&"Business Analyst"!==s&&"Rev Ops / Finance"!==s&&"Marketing"!==s&&"Executive"!==s||ee)||es("slack_announcement"),localStorage?.setItem("shownGoogleAds","true"))},[et,Z,eb,en]),(0,a.useEffect)(()=>{J&&!z&&R[eo]?.messages?.length>1&&!R[eo]?.name&&setTimeout(()=>{ep(eo)},2e3)},[z]);let ey=R?.[eo]?.model;(0,a.useEffect)(()=>{R?.[eo]&&M(R?.[eo]?.model||null)},[ey]),(0,a.useEffect)(()=>{!H||eo&&R?.[eo]?.messages?.length||(ed({content:H}),V(null),X({}))},[H]),(0,a.useEffect)(()=>{let e;if(A?.email&&window?.Beacon?.("identify",{email:A.email,name:A.name}),A?.email)try{window.localStorage.setItem("userEmail",A.email)}catch(e){}let{query:t}=l;if(t&&(e=t.dataSourceId),A&&P&&ef(),e&&!eo){(async()=>{await ed({content:`load ${e}`})})();let t=window.location.origin+l.pathname;window.history.replaceState({},document.title,t)}},[A,P]);let{data:ev}=(0,u.useUserConnections)();(0,a.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("model_provider");e&&M(e)},[]),(0,a.useEffect)(()=>{let e=t.get("connectionId");if(e&&!eo){let t=ev?.find(t=>t.id===e);if(t){if(K){c.toast.warning((0,s.jsxs)("div",{className:"break-words",children:[(0,s.jsx)("a",{className:"underline text-primary",href:"/settings",target:"_blank",rel:"noopener noreferrer",onClick:e=>{i.default.capture("upgrade_button_clicked",{location:"connectors_tooltip"}),e.stopPropagation()},children:"Upgrade Now"})," ","to connect external data sources"]})),i.default.capture("upgrade_cta_shown",{type:"toast",name:"connectors"}),"function"==typeof window.gtag&&(window.gtag("event","connectors_upgrade_cta_shown"),(0,N.trackLinkedInConversion)(N.UPGRADE_MODAL_SHOWN));try{let e=new URL(window.location.href);e.searchParams.delete("connectionId"),window.history.replaceState({},document.title,e.toString())}catch{}return}Q(t,!1,es,ea,eo)}else console.warn(`Connector with ID ${e} not found.`)}},[ev]);let[ew,eN]=(0,a.useState)(null),[ek,e_]=(0,a.useState)(null),eS=(0,S.useGetCookieOnClient)("onboarding_status"),eC=(0,a.useMemo)(()=>er?.messages_sent||0,[er]);return(0,a.useEffect)(()=>{eC>0&&ei(eC)},[eC]),(0,a.useEffect)(()=>{tU?eN(null):"true"!==eS||er?.onboarding_status?.upload_file&&er?.onboarding_status?.ask_julius&&er?.onboarding_status?.share||eN(eS)},[eS]),(0,a.useEffect)(()=>{if(tU)return void e_(null);if("true"===new URLSearchParams(window.location.search).get("test_onboarding")){e_("true");try{localStorage.removeItem("onboarding-file-upload-modal-dismissed")}catch(e){console.error(e)}return}er&&el&&!er?.onboarding_status?.upload_file&&!er?.onboarding_status?.ask_julius&&!er?.onboarding_status?.share&&el?.created_at&&(Date.now()-new Date(el.created_at).getTime()<6048e5||er?.onboarding_status?.reset)&&e_("true")},[el,er]),(0,s.jsxs)(tF.DroppableWindow,{children:[(0,s.jsx)(p.Dialog,{open:D,onOpenChange:I,children:(0,s.jsx)(p.DialogContent,{className:"p-0 max-w-3xl w-full",children:(0,s.jsxs)("div",{className:"p-[5px] relative",children:[(0,s.jsx)("video",{ref:F,src:"https://r2.julius.ai/julius_onboarding_overlay.mp4",controls:!0,autoPlay:!1,playsInline:!0,onPlay:()=>G(!0),onPause:()=>G(!1),className:"w-full h-auto rounded-lg"}),U&&(0,s.jsx)("div",{className:"mt-3 flex w-full justify-center",children:(0,s.jsx)("button",{type:"button",onClick:()=>{if(O)i.default.capture("help_video_dismissed"),I(!1);else{i.default.capture("play_help_video");try{F.current?.play()}catch{}G(!0)}},className:"px-6 py-3 rounded-lg bg-blue-600 text-white font-medium shadow-lg hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2","aria-label":O?"Dive into Julius!":"Watch to get started",children:O?(0,s.jsx)(s.Fragment,{children:"Dive into Julius!"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.Play,{className:"w-4 h-4 inline mr-2 align-[-2px]","aria-hidden":"true"}),"Watch to get started"]})})})]})})}),"true"===ek&&!ec&&!tU&&(0,s.jsx)(ex,{onClose:()=>e_("false"),onFileUpload:async e=>await q({sourceId:e,currentConversationId:eo})}),(0,s.jsxs)("div",{className:(0,C.cn)("flex z-10 flex-col overflow-hidden !h-full relative transition-width duration-300 ease-in-out focus-visible:outline-0 w-full dark:border-white/20 items-center justify-center max-w-full"),children:[eo?(0,s.jsx)(b.LearningProvider,{conversationId:eo,children:(R[eo]?.messages?.length||0)>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex overflow-x-hidden flex-col flex-1 w-full z-10 items-center self-center rounded-xl",children:(0,s.jsx)(tG,{atBottomStateChange:L})}),J&&(0,s.jsx)(tl,{chatType:R[eo]?.chat_type,addingSource:e,numMessages:R[eo]?.messages?.length||0,messageListIsAtBottom:T,handleAddFileToChat:q})]}):(0,s.jsx)(tI,{chatType:R[eo]?.chat_type,addingSource:e,numMessages:R[eo]?.messages?.length||0,handleAddFileToChat:q})},eo):(0,s.jsx)(tI,{chatType:R[eo]?.chat_type,addingSource:e,numMessages:R[eo]?.messages?.length||0,handleAddFileToChat:q}),!tU&&!eb&&"true"===ew&&(0,s.jsx)(ej.default,{className:"absolute top-2 right-2"}),(0,s.jsx)(a.Suspense,{children:(0,s.jsx)(tO,{setIsGenerating:W})})]}),w.FEATURE_FLAGS.MAINTENANCE_POPUP&&(0,s.jsx)(E,{})]})}],931231)},385477,e=>{e.n(e.i(931231))}]);

//# debugId=f7c0e8bc-51f8-a2d2-4fde-e63dadb302c6
//# sourceMappingURL=ca64ef3b5f20acd5.js.map