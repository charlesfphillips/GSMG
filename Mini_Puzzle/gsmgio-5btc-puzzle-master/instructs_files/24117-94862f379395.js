performance.mark("js-parse-end:24117-94862f379395.js");
"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([[24117],{13523:(e,t,s)=>{s.d(t,{$r:()=>r,M1:()=>l,li:()=>i,pS:()=>c,wE:()=>o});var a=s(56038);let i="X-Fetch-Nonce",n=new Set;function r(e){n.add(e)}function l(){return n.values().next().value||""}function o(e){let t={};return void 0!==e&&(t["X-Fetch-Nonce-To-Validate"]=e),void 0===e?t[i]=l():n.has(e)?t[i]=e:t[i]=Array.from(n).join(","),t}function c(){let e=a.XC?.head?.querySelector('meta[name="fetch-nonce"]')?.content||"";e&&r(e)}},24117:(e,t,s)=>{var a=s(7123),i=s(74848),n=s(96540),r=s(94236),l=s(29e3),o=s(19173),c=s(38621),d=s(96379);let u=async e=>{try{let t=await (0,d.DI)("/notifications/subscribe",{method:"POST",body:e});if(t.ok)return{ok:!0,errorMsg:""};{let e=await t.json(),s=e.error?e.error:"Failed to update";return{ok:!1,errorMsg:s}}}catch(e){return{ok:!1,errorMsg:e instanceof Error?e.message:"Failed to update"}}};var h=s(5524);let p="none",m="watching",b="ignoring",f="custom",g={[p]:"Participating and @mentions",[m]:"All Activity",[b]:"Ignore",[f]:"Custom"},_={...g,[p]:"Participating"},w={[p]:"Watch",[m]:"Unwatch",[b]:"Stop ignoring",[f]:"Unwatch"},y=[{name:g[p],description:"Only receive notifications from this repository when participating or @mentioned.",subscriptionType:p},{name:g[m],description:"Notified of all notifications on this repository.",subscriptionType:m},{name:g[b],description:"Never be notified.",subscriptionType:b},{name:g[f],description:"Select events you want to be notified of in addition to participating and @mentions.",trailingIcon:(0,n.createElement)(c.ArrowRightIcon),subscriptionType:f}],x=e=>e in w?w[e]:"";function S(e){return(0,i.jsx)(h.l,{selectionVariant:"single",children:y.map((t,s)=>(0,i.jsxs)(n.Fragment,{children:[(0,i.jsxs)(h.l.Item,{selected:t.subscriptionType===e.selected,onSelect:()=>e.onSelect(t.subscriptionType),children:[(0,i.jsx)("span",{className:"SubscriptionList-module__subscriptionTypeName__isFzuVc",children:t.name}),(0,i.jsx)(h.l.Description,{variant:"block",children:t.description}),t.trailingIcon?(0,i.jsx)(h.l.TrailingVisual,{children:t.trailingIcon}):null]}),s!==y.length-1?(0,i.jsx)(h.l.Divider,{}):""]},s))})}try{S.displayName||(S.displayName="SubscriptionList")}catch{}var j=s(86877),C=s(46720),v=s(5839),T=s(21373);function L(e){let[t,s]=(0,n.useState)(!1),[a,r]=(0,n.useState)(""),l=e.items.filter(e=>e?.text?.toLowerCase().startsWith(a.toLowerCase()));return(0,i.jsx)(v.X,{title:"Select labels",renderAnchor:({children:t,...s})=>0===e.items.length?(0,i.jsx)(T.Q,{...s,trailingAction:c.TriangleDownIcon,"aria-haspopup":"dialog",children:"No labels available"}):(0,i.jsxs)(T.Q,{...s,trailingAction:c.TriangleDownIcon,"aria-haspopup":"dialog",children:[(0,i.jsx)("span",{className:"color-fg-muted",children:"Labels: "}),(0,i.jsx)("span",{id:"select-labels",children:e.labelsText})]}),placeholder:"Filter labels",open:t,onCancel:e.resetLabels,onOpenChange:(t,a)=>{s(t),"click-outside"===a&&e.applyLabels()},items:l,selected:e.selectedLabels,onSelectedChange:e.onChangeLabels,onFilterChange:r,showItemDividers:!0,overlayProps:{width:"small",height:"medium",maxHeight:"medium"}})}try{L.displayName||(L.displayName="FilterLabels")}catch{}var k=s(69726);function N(e){let[t,s]=(0,n.useState)(!1),a=(0,n.useCallback)(()=>(e.nextFocusRef?.current?.focus(),!0),[e.nextFocusRef]),r=(0,n.useCallback)(()=>{s(!0)},[]),l=(0,n.useCallback)(()=>{e.onApply(),setTimeout(()=>{e?.checkStatus&&e.checkStatus(r)},600)},[e,r]);return(0,i.jsxs)("div",{className:"FooterActions-module__footerContainer__rILtlUQ",children:[e.showError?(0,i.jsx)("span",{className:"FooterActions-module__errorMessageText__d1_qHG1",children:"Error. Please try again."}):null,(0,i.jsxs)("div",{className:"FooterActions-module__buttonsContainer___cNSHBx",style:e.overrideButtonStyles??{padding:"var(--base-size-16)"},children:[!e.showError&&t?(0,i.jsx)(k.A,{size:"small",className:"FooterActions-module__FooterActionsSpinner__EyMJPQD"}):null,(0,i.jsx)(T.Q,{size:"small",onClick:()=>e.onCancel(),onBlur:t=>{e.disabled&&a(t)},children:"Cancel"}),(0,i.jsx)(T.Q,{disabled:e.disabled,variant:"primary",size:"small",onClick:()=>l(),onBlur:a,className:"FooterActions-module__applyButton__UPy7oWm",children:"Apply"})]})]})}try{N.displayName||(N.displayName="FooterActions")}catch{}let A=e=>{let t=I(e,2);if(e.length>=2){if(2===e.length)return F(e);let s=I(e,3);if(s.length>30)return`${t.slice(0,30)}... +${e.length-2} more`;{let t=e.length>3?` +${e.length-3} more`:"";return`${s}${t}`}}if(1!==e.length)return"All";{let t=e[0]?.text||"";return t.length>30?`${t.slice(0,30)}...`:t}},F=e=>{let t=e[0]?.text||"",s=I(e,2);return s.length>30?t.length>25?`${t.slice(0,25)}... +1 more`:`${s.slice(0,30)}...`:s},I=(e,t)=>e.slice(0,t).map(e=>e.text).join(", "),M=e=>{switch(e){case"PullRequest":return"Pull requests";case"SecurityAlert":return"Security alerts";default:return`${e}s`}};function R(e){let[t,s]=(0,n.useState)(e.appliedThreads),[a,r]=(0,n.useState)(e.appliedLabels),[l,o]=(0,n.useState)(e.appliedLabels),[c,d]=(0,n.useState)(()=>A(e.appliedLabels));(0,n.useEffect)(()=>{e.appliedLabels.length>0&&!t.includes("Issue")&&s([...t,"Issue"])},[]);let u=(0,n.useCallback)(e=>{t&&t.includes(e)?s(t.filter(t=>t!==e)):s([...t,e])},[t]),h=(0,n.useCallback)(e=>{o(e),d(A(e))},[]),p=(0,n.useCallback)(()=>{r(l)},[l]),m=(0,n.useCallback)(()=>{o(a),d(A(a))},[a]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"ThreadList-module__threadContent__mxjMVgl",children:e.subscribableThreadTypes.map((s,a)=>(0,i.jsxs)("div",{className:"ThreadList-module__threadRow__VS4MIXj",style:a===e.subscribableThreadTypes.length-1?{}:{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))"},children:[(0,i.jsxs)(j.A,{children:[(0,i.jsx)(C.A,{checked:t.includes(s.name),onChange:()=>u(s.name)}),(0,i.jsx)(j.A.Label,{children:M(s.name)})]}),s.enabled?null:(0,i.jsxs)("p",{className:"ThreadList-module__threadDisabledMessage__G8H9cVq",children:[M(s.name)," are not enabled for this repository"]}),(0,i.jsx)("div",{"aria-live":"polite",children:"Issue"===s.name&&e.showLabelSubscriptions&&t.includes("Issue")?(0,i.jsx)("div",{className:"ThreadList-module__filterContainer__G7CrZCc",children:(0,i.jsx)(L,{items:e.repoLabels,labelsText:c,onChangeLabels:h,selectedLabels:l,applyLabels:p,resetLabels:m})}):null})]},a))}),(0,i.jsx)(N,{onCancel:e.cancelMenuCallback,onApply:()=>e.saveThreads(t,l),showError:e.showError,disabled:0===t.length||e.isSavingThreads})]})}try{R.displayName||(R.displayName="ThreadList")}catch{}function P({repositoryId:e,repositoryName:t,watchersCount:s,subscriptionType:a,subscribableThreadTypes:d,repositoryLabels:h,showLabelSubscriptions:g}){let w=(0,n.useMemo)(()=>h.map(e=>({id:e.id,text:e.name,selected:e.subscribed})),[h]),y=w.filter(e=>e.selected),j=(0,n.useMemo)(()=>d.map(e=>e.subscribed||"Issue"===e.name&&g&&y.length>0?e.name:null).filter(e=>null!==e),[d,g,y]),[C,v]=(0,n.useState)(!1),[T,L]=(0,n.useState)(!1),[k,N]=(0,n.useState)(!1),[A,F]=(0,n.useState)(""),I=(0,n.useCallback)(()=>N(!1),[]),[M,P]=(0,n.useState)(j.length>0?f:a),[$,E]=(0,n.useState)(M),[D,U]=(0,n.useState)(j),[H,O]=(0,n.useState)(y),[B,G]=(0,n.useState)(!1),V=(0,n.useRef)(null),X=(0,n.useCallback)(()=>{L(!1),P($)},[$]),q=(0,n.useCallback)(async(t,s)=>{G(!0),U(t),O(s),E(f);let a=new FormData;a.set("do","custom"),a.set("repository_id",e),t.map(e=>{a.append("thread_types[]",e)}),s.map(e=>{e.id&&a.append("labels[]",e.id.toString())}),(await u(a)).ok?(L(!1),G(!1)):v(!0)},[e]),Q=(0,n.useCallback)(async t=>{let s=new FormData;return t===b?s.set("do","ignore"):t===m?s.set("do","subscribed"):(t===p||t===f&&0===D.length)&&s.set("do","included"),s.append("thread_types[]",""),s.set("repository_id",e),await u(s)},[e,D]),W=(0,n.useCallback)(async e=>{if(e===f)L(!0),P(f);else{let t=await Q(e);t.ok?(P(e),E(e),U([])):z(t.errorMsg)}},[P]),z=e=>{switch(e){case"limit_exceeded":N(!0),F("limit_exceeded");break;case"forbidden":N(!0),F("forbidden")}},J=(0,n.useCallback)(e=>{U(e)},[U]),Y=(0,n.useMemo)(()=>{let e,s;return e=x(M),s=_[M],M===b?`${e} in ${t}`:`${e}: ${s} in ${t}`},[M,t]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.W,{children:[(0,i.jsxs)(r.W.Button,{"data-testid":"notifications-subscriptions-menu-button",size:"small",leadingVisual:M===b?c.BellSlashIcon:c.EyeIcon,className:"NotificationsSubscriptionsMenu-module__ActionMenuButton__UsTrHRk","aria-label":Y,children:[x(M),(0,i.jsx)("span",{className:"ml-2 Counter rounded-3 NotificationsSubscriptionsMenu-module__watchCounter__wM7O0kI",children:s})]}),(0,i.jsx)(r.W.Overlay,{width:"medium",children:(0,i.jsx)(S,{selected:M,onSelect:W})})]}),(0,i.jsx)(l.A,{className:"NotificationsSubscriptionsMenu-module__subscriptionDialog__l0RAFPS",returnFocusRef:V,isOpen:T,onDismiss:()=>X(),"aria-labelledby":"header",children:(0,i.jsxs)("div",{"data-testid":"inner",children:[(0,i.jsxs)(l.A.Header,{id:"header",children:["Subscribe to events for ",t]}),(0,i.jsx)(R,{subscribableThreadTypes:d,showLabelSubscriptions:g,cancelMenuCallback:X,appliedThreads:D,repoLabels:w,subscribedThreads:j,applyThreads:J,appliedLabels:H,saveThreads:q,showError:C,isSavingThreads:B})]})}),k&&(0,i.jsx)(o.l,{title:"You are unable to watch this repository",onClose:I,children:(0,i.jsxs)(o.l.Body,{children:["forbidden"===A&&"This action is not available for this repository.","limit_exceeded"===A&&(0,i.jsxs)(i.Fragment,{children:["You have reached the limit of 10,000 watched repositories. Update your"," ",(0,i.jsx)("a",{href:"/watching",children:"watch settings"})," to continue."]})]})})]})}try{P.displayName||(P.displayName="NotificationsSubscriptionsMenu")}catch{}(0,a.k)("notifications-subscriptions-menu",{Component:P})},37285:(e,t,s)=>{s.d(t,{Av:()=>l,BM:()=>a,HX:()=>u,M_:()=>h,RD:()=>d,rb:()=>i});let a="GraphQLTraces",i="GraphQLTracingRefresh",n=r()?decodeURIComponent(new URLSearchParams(window.location.search).get("disable_clusters")||"").split(",").filter(e=>""!==e):[];function r(){return"u">typeof window}function l(e){if(!r()||!o()||!e)return;let t=window;t&&!t[a]&&(t[a]=[]),t&&e.__trace&&(t[a].push(e.__trace),"function"==typeof t[i]&&t[i]())}function o(){if(!r())return!1;let e=window;return"true"===new URLSearchParams(window.location.search).get("_tracing")||e&&void 0!==e[a]}function c(){return n.length>0}function d(e){if(!r()||!o()&&!c())return e;let t=new URL(e,window.location.origin);return o()&&t.searchParams.set("_tracing","true"),c()&&t.searchParams.set("disable_clusters",n.join(",")),t.pathname+t.search}function u(e){return n.indexOf(e)>-1}function h(e){if(!r())return;let t=n.indexOf(e);t>-1?n.splice(t,1):n.push(e);let s=new URLSearchParams(window.location.search);s.set("disable_clusters",n.join(",")),window.location.search=s.toString()}},51987:(e,t,s)=>{s.d(t,{jC:()=>l,kt:()=>n,tV:()=>r});var a=s(87057),i=s(13523);function n(e){let t={"X-Requested-With":"XMLHttpRequest",...(0,i.wE)(e)};return{...t,[a.S]:(0,a.O)()}}function r(e,t){for(let[s,a]of Object.entries(n(t)))e.set(s,a)}function l(e){return{"X-GitHub-App-Type":e}}},87057:(e,t,s)=>{s.d(t,{O:()=>r,S:()=>n});var a=s(56038);let i=a.cg?.document?.head?.querySelector('meta[name="release"]')?.content||"",n="X-GitHub-Client-Version";function r(){return i}},96379:(e,t,s)=>{s.d(t,{DI:()=>r,QJ:()=>o,Sr:()=>c,lS:()=>l});var a=s(51987),i=s(88057),n=s(37285);async function r(e,t={}){let s,l,o,c;var d,u=e;if(new URL(u,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch");let{tracingEnabled:h,fetchPath:p}=(s=new URL(d=e,window.location.href),(o=(l=new URL(window.location.href,window.location.origin)).searchParams.get("_features"))&&!s.searchParams.has("_features")&&s.searchParams.set("_features",o),(c=l.searchParams.get("_tracing"))&&!s.searchParams.has("_tracing")&&s.searchParams.set("_tracing",c),{tracingEnabled:!!c,fetchPath:d.startsWith(window.location.origin)?s.href:`${s.pathname}${s.search}`}),m={...t.headers,"GitHub-Verified-Fetch":"true",...(0,a.kt)()},b=await fetch(p,{...t,headers:m}),f=b?.headers?.get("X-Github-Request-Id");if(f&&(0,i.Ex)(f),h&&b){let e=b.clone();try{let t=await e.text(),s=t&&JSON.parse(t);(0,n.Av)(s)}catch{}}return b}function l(e,t){let s={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},a=t?.body?JSON.stringify(t.body):void 0;return r(e,{...t,body:a,headers:s})}function o(e,t={}){let s={...t.headers,"GitHub-Is-React":"true"};return r(e,{...t,headers:s})}function c(e,t){let s={...t?.headers??{},"GitHub-Is-React":"true"};return l(e,{...t,headers:s})}}}]);
//# sourceMappingURL=24117-1252fd931757.js.map